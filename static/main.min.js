(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict'

const GOVUKFrontend = require('govuk-frontend')
GOVUKFrontend.initAll()

},{"govuk-frontend":2}],2:[function(require,module,exports){
(function (global, factory) {
  typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
  typeof define === 'function' && define.amd ? define(['exports'], factory) :
  (global = typeof globalThis !== 'undefined' ? globalThis : global || self, factory(global.GOVUKFrontend = {}));
})(this, (function (exports) { 'use strict';

  const version = '5.7.1';

  function normaliseString(value, property) {
    const trimmedValue = value ? value.trim() : '';
    let output;
    let outputType = property == null ? void 0 : property.type;
    if (!outputType) {
      if (['true', 'false'].includes(trimmedValue)) {
        outputType = 'boolean';
      }
      if (trimmedValue.length > 0 && isFinite(Number(trimmedValue))) {
        outputType = 'number';
      }
    }
    switch (outputType) {
      case 'boolean':
        output = trimmedValue === 'true';
        break;
      case 'number':
        output = Number(trimmedValue);
        break;
      default:
        output = value;
    }
    return output;
  }

  /**
   * @typedef {import('./index.mjs').SchemaProperty} SchemaProperty
   */

  function mergeConfigs(...configObjects) {
    const formattedConfigObject = {};
    for (const configObject of configObjects) {
      for (const key of Object.keys(configObject)) {
        const option = formattedConfigObject[key];
        const override = configObject[key];
        if (isObject(option) && isObject(override)) {
          formattedConfigObject[key] = mergeConfigs(option, override);
        } else {
          formattedConfigObject[key] = override;
        }
      }
    }
    return formattedConfigObject;
  }
  function extractConfigByNamespace(Component, dataset, namespace) {
    const property = Component.schema.properties[namespace];
    if ((property == null ? void 0 : property.type) !== 'object') {
      return;
    }
    const newObject = {
      [namespace]: ({})
    };
    for (const [key, value] of Object.entries(dataset)) {
      let current = newObject;
      const keyParts = key.split('.');
      for (const [index, name] of keyParts.entries()) {
        if (typeof current === 'object') {
          if (index < keyParts.length - 1) {
            if (!isObject(current[name])) {
              current[name] = {};
            }
            current = current[name];
          } else if (key !== namespace) {
            current[name] = normaliseString(value);
          }
        }
      }
    }
    return newObject[namespace];
  }
  function getFragmentFromUrl(url) {
    if (!url.includes('#')) {
      return undefined;
    }
    return url.split('#').pop();
  }
  function getBreakpoint(name) {
    const property = `--govuk-frontend-breakpoint-${name}`;
    const value = window.getComputedStyle(document.documentElement).getPropertyValue(property);
    return {
      property,
      value: value || undefined
    };
  }
  function setFocus($element, options = {}) {
    var _options$onBeforeFocu;
    const isFocusable = $element.getAttribute('tabindex');
    if (!isFocusable) {
      $element.setAttribute('tabindex', '-1');
    }
    function onFocus() {
      $element.addEventListener('blur', onBlur, {
        once: true
      });
    }
    function onBlur() {
      var _options$onBlur;
      (_options$onBlur = options.onBlur) == null || _options$onBlur.call($element);
      if (!isFocusable) {
        $element.removeAttribute('tabindex');
      }
    }
    $element.addEventListener('focus', onFocus, {
      once: true
    });
    (_options$onBeforeFocu = options.onBeforeFocus) == null || _options$onBeforeFocu.call($element);
    $element.focus();
  }
  function isInitialised($root, moduleName) {
    return $root instanceof HTMLElement && $root.hasAttribute(`data-${moduleName}-init`);
  }

  /**
   * Checks if GOV.UK Frontend is supported on this page
   *
   * Some browsers will load and run our JavaScript but GOV.UK Frontend
   * won't be supported.
   *
   * @param {HTMLElement | null} [$scope] - (internal) `<body>` HTML element checked for browser support
   * @returns {boolean} Whether GOV.UK Frontend is supported on this page
   */
  function isSupported($scope = document.body) {
    if (!$scope) {
      return false;
    }
    return $scope.classList.contains('govuk-frontend-supported');
  }
  function validateConfig(schema, config) {
    const validationErrors = [];
    for (const [name, conditions] of Object.entries(schema)) {
      const errors = [];
      if (Array.isArray(conditions)) {
        for (const {
          required,
          errorMessage
        } of conditions) {
          if (!required.every(key => !!config[key])) {
            errors.push(errorMessage);
          }
        }
        if (name === 'anyOf' && !(conditions.length - errors.length >= 1)) {
          validationErrors.push(...errors);
        }
      }
    }
    return validationErrors;
  }
  function isArray(option) {
    return Array.isArray(option);
  }
  function isObject(option) {
    return !!option && typeof option === 'object' && !isArray(option);
  }
  function formatErrorMessage(Component, message) {
    return `${Component.moduleName}: ${message}`;
  }

  /**
   * Schema for component config
   *
   * @typedef {object} Schema
   * @property {{ [field: string]: SchemaProperty | undefined }} properties - Schema properties
   * @property {SchemaCondition[]} [anyOf] - List of schema conditions
   */

  /**
   * Schema property for component config
   *
   * @typedef {object} SchemaProperty
   * @property {'string' | 'boolean' | 'number' | 'object'} type - Property type
   */

  /**
   * Schema condition for component config
   *
   * @typedef {object} SchemaCondition
   * @property {string[]} required - List of required config fields
   * @property {string} errorMessage - Error message when required config fields not provided
   */
  /**
   * @typedef ComponentWithModuleName
   * @property {string} moduleName - Name of the component
   */

  function normaliseDataset(Component, dataset) {
    const out = {};
    for (const [field, property] of Object.entries(Component.schema.properties)) {
      if (field in dataset) {
        out[field] = normaliseString(dataset[field], property);
      }
      if ((property == null ? void 0 : property.type) === 'object') {
        out[field] = extractConfigByNamespace(Component, dataset, field);
      }
    }
    return out;
  }

  class GOVUKFrontendError extends Error {
    constructor(...args) {
      super(...args);
      this.name = 'GOVUKFrontendError';
    }
  }
  class SupportError extends GOVUKFrontendError {
    /**
     * Checks if GOV.UK Frontend is supported on this page
     *
     * @param {HTMLElement | null} [$scope] - HTML element `<body>` checked for browser support
     */
    constructor($scope = document.body) {
      const supportMessage = 'noModule' in HTMLScriptElement.prototype ? 'GOV.UK Frontend initialised without `<body class="govuk-frontend-supported">` from template `<script>` snippet' : 'GOV.UK Frontend is not supported in this browser';
      super($scope ? supportMessage : 'GOV.UK Frontend initialised without `<script type="module">`');
      this.name = 'SupportError';
    }
  }
  class ConfigError extends GOVUKFrontendError {
    constructor(...args) {
      super(...args);
      this.name = 'ConfigError';
    }
  }
  class ElementError extends GOVUKFrontendError {
    constructor(messageOrOptions) {
      let message = typeof messageOrOptions === 'string' ? messageOrOptions : '';
      if (typeof messageOrOptions === 'object') {
        const {
          component,
          identifier,
          element,
          expectedType
        } = messageOrOptions;
        message = identifier;
        message += element ? ` is not of type ${expectedType != null ? expectedType : 'HTMLElement'}` : ' not found';
        message = formatErrorMessage(component, message);
      }
      super(message);
      this.name = 'ElementError';
    }
  }
  class InitError extends GOVUKFrontendError {
    constructor(componentOrMessage) {
      const message = typeof componentOrMessage === 'string' ? componentOrMessage : formatErrorMessage(componentOrMessage, `Root element (\`$root\`) already initialised`);
      super(message);
      this.name = 'InitError';
    }
  }
  /**
   * @typedef {import('../common/index.mjs').ComponentWithModuleName} ComponentWithModuleName
   */

  class GOVUKFrontendComponent {
    /**
     * Returns the root element of the component
     *
     * @protected
     * @returns {RootElementType} - the root element of component
     */
    get $root() {
      return this._$root;
    }
    constructor($root) {
      this._$root = void 0;
      const childConstructor = this.constructor;
      if (typeof childConstructor.moduleName !== 'string') {
        throw new InitError(`\`moduleName\` not defined in component`);
      }
      if (!($root instanceof childConstructor.elementType)) {
        throw new ElementError({
          element: $root,
          component: childConstructor,
          identifier: 'Root element (`$root`)',
          expectedType: childConstructor.elementType.name
        });
      } else {
        this._$root = $root;
      }
      childConstructor.checkSupport();
      this.checkInitialised();
      const moduleName = childConstructor.moduleName;
      this.$root.setAttribute(`data-${moduleName}-init`, '');
    }
    checkInitialised() {
      const constructor = this.constructor;
      const moduleName = constructor.moduleName;
      if (moduleName && isInitialised(this.$root, moduleName)) {
        throw new InitError(constructor);
      }
    }
    static checkSupport() {
      if (!isSupported()) {
        throw new SupportError();
      }
    }
  }

  /**
   * @typedef ChildClass
   * @property {string} moduleName - The module name that'll be looked for in the DOM when initialising the component
   */

  /**
   * @typedef {typeof GOVUKFrontendComponent & ChildClass} ChildClassConstructor
   */
  GOVUKFrontendComponent.elementType = HTMLElement;

  class I18n {
    constructor(translations = {}, config = {}) {
      var _config$locale;
      this.translations = void 0;
      this.locale = void 0;
      this.translations = translations;
      this.locale = (_config$locale = config.locale) != null ? _config$locale : document.documentElement.lang || 'en';
    }
    t(lookupKey, options) {
      if (!lookupKey) {
        throw new Error('i18n: lookup key missing');
      }
      let translation = this.translations[lookupKey];
      if (typeof (options == null ? void 0 : options.count) === 'number' && typeof translation === 'object') {
        const translationPluralForm = translation[this.getPluralSuffix(lookupKey, options.count)];
        if (translationPluralForm) {
          translation = translationPluralForm;
        }
      }
      if (typeof translation === 'string') {
        if (translation.match(/%{(.\S+)}/)) {
          if (!options) {
            throw new Error('i18n: cannot replace placeholders in string if no option data provided');
          }
          return this.replacePlaceholders(translation, options);
        }
        return translation;
      }
      return lookupKey;
    }
    replacePlaceholders(translationString, options) {
      const formatter = Intl.NumberFormat.supportedLocalesOf(this.locale).length ? new Intl.NumberFormat(this.locale) : undefined;
      return translationString.replace(/%{(.\S+)}/g, function (placeholderWithBraces, placeholderKey) {
        if (Object.prototype.hasOwnProperty.call(options, placeholderKey)) {
          const placeholderValue = options[placeholderKey];
          if (placeholderValue === false || typeof placeholderValue !== 'number' && typeof placeholderValue !== 'string') {
            return '';
          }
          if (typeof placeholderValue === 'number') {
            return formatter ? formatter.format(placeholderValue) : `${placeholderValue}`;
          }
          return placeholderValue;
        }
        throw new Error(`i18n: no data found to replace ${placeholderWithBraces} placeholder in string`);
      });
    }
    hasIntlPluralRulesSupport() {
      return Boolean('PluralRules' in window.Intl && Intl.PluralRules.supportedLocalesOf(this.locale).length);
    }
    getPluralSuffix(lookupKey, count) {
      count = Number(count);
      if (!isFinite(count)) {
        return 'other';
      }
      const translation = this.translations[lookupKey];
      const preferredForm = this.hasIntlPluralRulesSupport() ? new Intl.PluralRules(this.locale).select(count) : this.selectPluralFormUsingFallbackRules(count);
      if (typeof translation === 'object') {
        if (preferredForm in translation) {
          return preferredForm;
        } else if ('other' in translation) {
          console.warn(`i18n: Missing plural form ".${preferredForm}" for "${this.locale}" locale. Falling back to ".other".`);
          return 'other';
        }
      }
      throw new Error(`i18n: Plural form ".other" is required for "${this.locale}" locale`);
    }
    selectPluralFormUsingFallbackRules(count) {
      count = Math.abs(Math.floor(count));
      const ruleset = this.getPluralRulesForLocale();
      if (ruleset) {
        return I18n.pluralRules[ruleset](count);
      }
      return 'other';
    }
    getPluralRulesForLocale() {
      const localeShort = this.locale.split('-')[0];
      for (const pluralRule in I18n.pluralRulesMap) {
        const languages = I18n.pluralRulesMap[pluralRule];
        if (languages.includes(this.locale) || languages.includes(localeShort)) {
          return pluralRule;
        }
      }
    }
  }
  I18n.pluralRulesMap = {
    arabic: ['ar'],
    chinese: ['my', 'zh', 'id', 'ja', 'jv', 'ko', 'ms', 'th', 'vi'],
    french: ['hy', 'bn', 'fr', 'gu', 'hi', 'fa', 'pa', 'zu'],
    german: ['af', 'sq', 'az', 'eu', 'bg', 'ca', 'da', 'nl', 'en', 'et', 'fi', 'ka', 'de', 'el', 'hu', 'lb', 'no', 'so', 'sw', 'sv', 'ta', 'te', 'tr', 'ur'],
    irish: ['ga'],
    russian: ['ru', 'uk'],
    scottish: ['gd'],
    spanish: ['pt-PT', 'it', 'es'],
    welsh: ['cy']
  };
  I18n.pluralRules = {
    arabic(n) {
      if (n === 0) {
        return 'zero';
      }
      if (n === 1) {
        return 'one';
      }
      if (n === 2) {
        return 'two';
      }
      if (n % 100 >= 3 && n % 100 <= 10) {
        return 'few';
      }
      if (n % 100 >= 11 && n % 100 <= 99) {
        return 'many';
      }
      return 'other';
    },
    chinese() {
      return 'other';
    },
    french(n) {
      return n === 0 || n === 1 ? 'one' : 'other';
    },
    german(n) {
      return n === 1 ? 'one' : 'other';
    },
    irish(n) {
      if (n === 1) {
        return 'one';
      }
      if (n === 2) {
        return 'two';
      }
      if (n >= 3 && n <= 6) {
        return 'few';
      }
      if (n >= 7 && n <= 10) {
        return 'many';
      }
      return 'other';
    },
    russian(n) {
      const lastTwo = n % 100;
      const last = lastTwo % 10;
      if (last === 1 && lastTwo !== 11) {
        return 'one';
      }
      if (last >= 2 && last <= 4 && !(lastTwo >= 12 && lastTwo <= 14)) {
        return 'few';
      }
      if (last === 0 || last >= 5 && last <= 9 || lastTwo >= 11 && lastTwo <= 14) {
        return 'many';
      }
      return 'other';
    },
    scottish(n) {
      if (n === 1 || n === 11) {
        return 'one';
      }
      if (n === 2 || n === 12) {
        return 'two';
      }
      if (n >= 3 && n <= 10 || n >= 13 && n <= 19) {
        return 'few';
      }
      return 'other';
    },
    spanish(n) {
      if (n === 1) {
        return 'one';
      }
      if (n % 1000000 === 0 && n !== 0) {
        return 'many';
      }
      return 'other';
    },
    welsh(n) {
      if (n === 0) {
        return 'zero';
      }
      if (n === 1) {
        return 'one';
      }
      if (n === 2) {
        return 'two';
      }
      if (n === 3) {
        return 'few';
      }
      if (n === 6) {
        return 'many';
      }
      return 'other';
    }
  };

  /**
   * Accordion component
   *
   * This allows a collection of sections to be collapsed by default, showing only
   * their headers. Sections can be expanded or collapsed individually by clicking
   * their headers. A "Show all sections" button is also added to the top of the
   * accordion, which switches to "Hide all sections" when all the sections are
   * expanded.
   *
   * The state of each section is saved to the DOM via the `aria-expanded`
   * attribute, which also provides accessibility.
   *
   * @preserve
   */
  class Accordion extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for accordion
     * @param {AccordionConfig} [config] - Accordion config
     */
    constructor($root, config = {}) {
      super($root);
      this.config = void 0;
      this.i18n = void 0;
      this.controlsClass = 'govuk-accordion__controls';
      this.showAllClass = 'govuk-accordion__show-all';
      this.showAllTextClass = 'govuk-accordion__show-all-text';
      this.sectionClass = 'govuk-accordion__section';
      this.sectionExpandedClass = 'govuk-accordion__section--expanded';
      this.sectionButtonClass = 'govuk-accordion__section-button';
      this.sectionHeaderClass = 'govuk-accordion__section-header';
      this.sectionHeadingClass = 'govuk-accordion__section-heading';
      this.sectionHeadingDividerClass = 'govuk-accordion__section-heading-divider';
      this.sectionHeadingTextClass = 'govuk-accordion__section-heading-text';
      this.sectionHeadingTextFocusClass = 'govuk-accordion__section-heading-text-focus';
      this.sectionShowHideToggleClass = 'govuk-accordion__section-toggle';
      this.sectionShowHideToggleFocusClass = 'govuk-accordion__section-toggle-focus';
      this.sectionShowHideTextClass = 'govuk-accordion__section-toggle-text';
      this.upChevronIconClass = 'govuk-accordion-nav__chevron';
      this.downChevronIconClass = 'govuk-accordion-nav__chevron--down';
      this.sectionSummaryClass = 'govuk-accordion__section-summary';
      this.sectionSummaryFocusClass = 'govuk-accordion__section-summary-focus';
      this.sectionContentClass = 'govuk-accordion__section-content';
      this.$sections = void 0;
      this.$showAllButton = null;
      this.$showAllIcon = null;
      this.$showAllText = null;
      this.config = mergeConfigs(Accordion.defaults, config, normaliseDataset(Accordion, this.$root.dataset));
      this.i18n = new I18n(this.config.i18n);
      const $sections = this.$root.querySelectorAll(`.${this.sectionClass}`);
      if (!$sections.length) {
        throw new ElementError({
          component: Accordion,
          identifier: `Sections (\`<div class="${this.sectionClass}">\`)`
        });
      }
      this.$sections = $sections;
      this.initControls();
      this.initSectionHeaders();
      this.updateShowAllButton(this.areAllSectionsOpen());
    }
    initControls() {
      this.$showAllButton = document.createElement('button');
      this.$showAllButton.setAttribute('type', 'button');
      this.$showAllButton.setAttribute('class', this.showAllClass);
      this.$showAllButton.setAttribute('aria-expanded', 'false');
      this.$showAllIcon = document.createElement('span');
      this.$showAllIcon.classList.add(this.upChevronIconClass);
      this.$showAllButton.appendChild(this.$showAllIcon);
      const $accordionControls = document.createElement('div');
      $accordionControls.setAttribute('class', this.controlsClass);
      $accordionControls.appendChild(this.$showAllButton);
      this.$root.insertBefore($accordionControls, this.$root.firstChild);
      this.$showAllText = document.createElement('span');
      this.$showAllText.classList.add(this.showAllTextClass);
      this.$showAllButton.appendChild(this.$showAllText);
      this.$showAllButton.addEventListener('click', () => this.onShowOrHideAllToggle());
      if ('onbeforematch' in document) {
        document.addEventListener('beforematch', event => this.onBeforeMatch(event));
      }
    }
    initSectionHeaders() {
      this.$sections.forEach(($section, i) => {
        const $header = $section.querySelector(`.${this.sectionHeaderClass}`);
        if (!$header) {
          throw new ElementError({
            component: Accordion,
            identifier: `Section headers (\`<div class="${this.sectionHeaderClass}">\`)`
          });
        }
        this.constructHeaderMarkup($header, i);
        this.setExpanded(this.isExpanded($section), $section);
        $header.addEventListener('click', () => this.onSectionToggle($section));
        this.setInitialState($section);
      });
    }
    constructHeaderMarkup($header, index) {
      const $span = $header.querySelector(`.${this.sectionButtonClass}`);
      const $heading = $header.querySelector(`.${this.sectionHeadingClass}`);
      const $summary = $header.querySelector(`.${this.sectionSummaryClass}`);
      if (!$heading) {
        throw new ElementError({
          component: Accordion,
          identifier: `Section heading (\`.${this.sectionHeadingClass}\`)`
        });
      }
      if (!$span) {
        throw new ElementError({
          component: Accordion,
          identifier: `Section button placeholder (\`<span class="${this.sectionButtonClass}">\`)`
        });
      }
      const $button = document.createElement('button');
      $button.setAttribute('type', 'button');
      $button.setAttribute('aria-controls', `${this.$root.id}-content-${index + 1}`);
      for (const attr of Array.from($span.attributes)) {
        if (attr.name !== 'id') {
          $button.setAttribute(attr.name, attr.value);
        }
      }
      const $headingText = document.createElement('span');
      $headingText.classList.add(this.sectionHeadingTextClass);
      $headingText.id = $span.id;
      const $headingTextFocus = document.createElement('span');
      $headingTextFocus.classList.add(this.sectionHeadingTextFocusClass);
      $headingText.appendChild($headingTextFocus);
      Array.from($span.childNodes).forEach($child => $headingTextFocus.appendChild($child));
      const $showHideToggle = document.createElement('span');
      $showHideToggle.classList.add(this.sectionShowHideToggleClass);
      $showHideToggle.setAttribute('data-nosnippet', '');
      const $showHideToggleFocus = document.createElement('span');
      $showHideToggleFocus.classList.add(this.sectionShowHideToggleFocusClass);
      $showHideToggle.appendChild($showHideToggleFocus);
      const $showHideText = document.createElement('span');
      const $showHideIcon = document.createElement('span');
      $showHideIcon.classList.add(this.upChevronIconClass);
      $showHideToggleFocus.appendChild($showHideIcon);
      $showHideText.classList.add(this.sectionShowHideTextClass);
      $showHideToggleFocus.appendChild($showHideText);
      $button.appendChild($headingText);
      $button.appendChild(this.getButtonPunctuationEl());
      if ($summary) {
        const $summarySpan = document.createElement('span');
        const $summarySpanFocus = document.createElement('span');
        $summarySpanFocus.classList.add(this.sectionSummaryFocusClass);
        $summarySpan.appendChild($summarySpanFocus);
        for (const attr of Array.from($summary.attributes)) {
          $summarySpan.setAttribute(attr.name, attr.value);
        }
        Array.from($summary.childNodes).forEach($child => $summarySpanFocus.appendChild($child));
        $summary.remove();
        $button.appendChild($summarySpan);
        $button.appendChild(this.getButtonPunctuationEl());
      }
      $button.appendChild($showHideToggle);
      $heading.removeChild($span);
      $heading.appendChild($button);
    }
    onBeforeMatch(event) {
      const $fragment = event.target;
      if (!($fragment instanceof Element)) {
        return;
      }
      const $section = $fragment.closest(`.${this.sectionClass}`);
      if ($section) {
        this.setExpanded(true, $section);
      }
    }
    onSectionToggle($section) {
      const nowExpanded = !this.isExpanded($section);
      this.setExpanded(nowExpanded, $section);
      this.storeState($section, nowExpanded);
    }
    onShowOrHideAllToggle() {
      const nowExpanded = !this.areAllSectionsOpen();
      this.$sections.forEach($section => {
        this.setExpanded(nowExpanded, $section);
        this.storeState($section, nowExpanded);
      });
      this.updateShowAllButton(nowExpanded);
    }
    setExpanded(expanded, $section) {
      const $showHideIcon = $section.querySelector(`.${this.upChevronIconClass}`);
      const $showHideText = $section.querySelector(`.${this.sectionShowHideTextClass}`);
      const $button = $section.querySelector(`.${this.sectionButtonClass}`);
      const $content = $section.querySelector(`.${this.sectionContentClass}`);
      if (!$content) {
        throw new ElementError({
          component: Accordion,
          identifier: `Section content (\`<div class="${this.sectionContentClass}">\`)`
        });
      }
      if (!$showHideIcon || !$showHideText || !$button) {
        return;
      }
      const newButtonText = expanded ? this.i18n.t('hideSection') : this.i18n.t('showSection');
      $showHideText.textContent = newButtonText;
      $button.setAttribute('aria-expanded', `${expanded}`);
      const ariaLabelParts = [];
      const $headingText = $section.querySelector(`.${this.sectionHeadingTextClass}`);
      if ($headingText) {
        ariaLabelParts.push(`${$headingText.textContent}`.trim());
      }
      const $summary = $section.querySelector(`.${this.sectionSummaryClass}`);
      if ($summary) {
        ariaLabelParts.push(`${$summary.textContent}`.trim());
      }
      const ariaLabelMessage = expanded ? this.i18n.t('hideSectionAriaLabel') : this.i18n.t('showSectionAriaLabel');
      ariaLabelParts.push(ariaLabelMessage);
      $button.setAttribute('aria-label', ariaLabelParts.join(' , '));
      if (expanded) {
        $content.removeAttribute('hidden');
        $section.classList.add(this.sectionExpandedClass);
        $showHideIcon.classList.remove(this.downChevronIconClass);
      } else {
        $content.setAttribute('hidden', 'until-found');
        $section.classList.remove(this.sectionExpandedClass);
        $showHideIcon.classList.add(this.downChevronIconClass);
      }
      this.updateShowAllButton(this.areAllSectionsOpen());
    }
    isExpanded($section) {
      return $section.classList.contains(this.sectionExpandedClass);
    }
    areAllSectionsOpen() {
      return Array.from(this.$sections).every($section => this.isExpanded($section));
    }
    updateShowAllButton(expanded) {
      if (!this.$showAllButton || !this.$showAllText || !this.$showAllIcon) {
        return;
      }
      this.$showAllButton.setAttribute('aria-expanded', expanded.toString());
      this.$showAllText.textContent = expanded ? this.i18n.t('hideAllSections') : this.i18n.t('showAllSections');
      this.$showAllIcon.classList.toggle(this.downChevronIconClass, !expanded);
    }

    /**
     * Get the identifier for a section
     *
     * We need a unique way of identifying each content in the Accordion.
     * Since an `#id` should be unique and an `id` is required for `aria-`
     * attributes `id` can be safely used.
     *
     * @param {Element} $section - Section element
     * @returns {string | undefined | null} Identifier for section
     */
    getIdentifier($section) {
      const $button = $section.querySelector(`.${this.sectionButtonClass}`);
      return $button == null ? void 0 : $button.getAttribute('aria-controls');
    }
    storeState($section, isExpanded) {
      if (!this.config.rememberExpanded) {
        return;
      }
      const id = this.getIdentifier($section);
      if (id) {
        try {
          window.sessionStorage.setItem(id, isExpanded.toString());
        } catch (exception) {}
      }
    }
    setInitialState($section) {
      if (!this.config.rememberExpanded) {
        return;
      }
      const id = this.getIdentifier($section);
      if (id) {
        try {
          const state = window.sessionStorage.getItem(id);
          if (state !== null) {
            this.setExpanded(state === 'true', $section);
          }
        } catch (exception) {}
      }
    }
    getButtonPunctuationEl() {
      const $punctuationEl = document.createElement('span');
      $punctuationEl.classList.add('govuk-visually-hidden', this.sectionHeadingDividerClass);
      $punctuationEl.textContent = ', ';
      return $punctuationEl;
    }
  }

  /**
   * Accordion config
   *
   * @see {@link Accordion.defaults}
   * @typedef {object} AccordionConfig
   * @property {AccordionTranslations} [i18n=Accordion.defaults.i18n] - Accordion translations
   * @property {boolean} [rememberExpanded] - Whether the expanded and collapsed
   *   state of each section is remembered and restored when navigating.
   */

  /**
   * Accordion translations
   *
   * @see {@link Accordion.defaults.i18n}
   * @typedef {object} AccordionTranslations
   *
   * Messages used by the component for the labels of its buttons. This includes
   * the visible text shown on screen, and text to help assistive technology users
   * for the buttons toggling each section.
   * @property {string} [hideAllSections] - The text content for the 'Hide all
   *   sections' button, used when at least one section is expanded.
   * @property {string} [hideSection] - The text content for the 'Hide'
   *   button, used when a section is expanded.
   * @property {string} [hideSectionAriaLabel] - The text content appended to the
   *   'Hide' button's accessible name when a section is expanded.
   * @property {string} [showAllSections] - The text content for the 'Show all
   *   sections' button, used when all sections are collapsed.
   * @property {string} [showSection] - The text content for the 'Show'
   *   button, used when a section is collapsed.
   * @property {string} [showSectionAriaLabel] - The text content appended to the
   *   'Show' button's accessible name when a section is expanded.
   */

  /**
   * @typedef {import('../../common/index.mjs').Schema} Schema
   */
  Accordion.moduleName = 'govuk-accordion';
  Accordion.defaults = Object.freeze({
    i18n: {
      hideAllSections: 'Hide all sections',
      hideSection: 'Hide',
      hideSectionAriaLabel: 'Hide this section',
      showAllSections: 'Show all sections',
      showSection: 'Show',
      showSectionAriaLabel: 'Show this section'
    },
    rememberExpanded: true
  });
  Accordion.schema = Object.freeze({
    properties: {
      i18n: {
        type: 'object'
      },
      rememberExpanded: {
        type: 'boolean'
      }
    }
  });

  const DEBOUNCE_TIMEOUT_IN_SECONDS = 1;

  /**
   * JavaScript enhancements for the Button component
   *
   * @preserve
   */
  class Button extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for button
     * @param {ButtonConfig} [config] - Button config
     */
    constructor($root, config = {}) {
      super($root);
      this.config = void 0;
      this.debounceFormSubmitTimer = null;
      this.config = mergeConfigs(Button.defaults, config, normaliseDataset(Button, this.$root.dataset));
      this.$root.addEventListener('keydown', event => this.handleKeyDown(event));
      this.$root.addEventListener('click', event => this.debounce(event));
    }
    handleKeyDown(event) {
      const $target = event.target;
      if (event.key !== ' ') {
        return;
      }
      if ($target instanceof HTMLElement && $target.getAttribute('role') === 'button') {
        event.preventDefault();
        $target.click();
      }
    }
    debounce(event) {
      if (!this.config.preventDoubleClick) {
        return;
      }
      if (this.debounceFormSubmitTimer) {
        event.preventDefault();
        return false;
      }
      this.debounceFormSubmitTimer = window.setTimeout(() => {
        this.debounceFormSubmitTimer = null;
      }, DEBOUNCE_TIMEOUT_IN_SECONDS * 1000);
    }
  }

  /**
   * Button config
   *
   * @typedef {object} ButtonConfig
   * @property {boolean} [preventDoubleClick=false] - Prevent accidental double
   *   clicks on submit buttons from submitting forms multiple times.
   */

  /**
   * @typedef {import('../../common/index.mjs').Schema} Schema
   */
  Button.moduleName = 'govuk-button';
  Button.defaults = Object.freeze({
    preventDoubleClick: false
  });
  Button.schema = Object.freeze({
    properties: {
      preventDoubleClick: {
        type: 'boolean'
      }
    }
  });

  function closestAttributeValue($element, attributeName) {
    const $closestElementWithAttribute = $element.closest(`[${attributeName}]`);
    return $closestElementWithAttribute ? $closestElementWithAttribute.getAttribute(attributeName) : null;
  }

  /**
   * Character count component
   *
   * Tracks the number of characters or words in the `.govuk-js-character-count`
   * `<textarea>` inside the element. Displays a message with the remaining number
   * of characters/words available, or the number of characters/words in excess.
   *
   * You can configure the message to only appear after a certain percentage
   * of the available characters/words has been entered.
   *
   * @preserve
   */
  class CharacterCount extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for character count
     * @param {CharacterCountConfig} [config] - Character count config
     */
    constructor($root, config = {}) {
      var _ref, _this$config$maxwords;
      super($root);
      this.$textarea = void 0;
      this.$visibleCountMessage = void 0;
      this.$screenReaderCountMessage = void 0;
      this.lastInputTimestamp = null;
      this.lastInputValue = '';
      this.valueChecker = null;
      this.config = void 0;
      this.i18n = void 0;
      this.maxLength = void 0;
      const $textarea = this.$root.querySelector('.govuk-js-character-count');
      if (!($textarea instanceof HTMLTextAreaElement || $textarea instanceof HTMLInputElement)) {
        throw new ElementError({
          component: CharacterCount,
          element: $textarea,
          expectedType: 'HTMLTextareaElement or HTMLInputElement',
          identifier: 'Form field (`.govuk-js-character-count`)'
        });
      }
      const datasetConfig = normaliseDataset(CharacterCount, this.$root.dataset);
      let configOverrides = {};
      if ('maxwords' in datasetConfig || 'maxlength' in datasetConfig) {
        configOverrides = {
          maxlength: undefined,
          maxwords: undefined
        };
      }
      this.config = mergeConfigs(CharacterCount.defaults, config, configOverrides, datasetConfig);
      const errors = validateConfig(CharacterCount.schema, this.config);
      if (errors[0]) {
        throw new ConfigError(formatErrorMessage(CharacterCount, errors[0]));
      }
      this.i18n = new I18n(this.config.i18n, {
        locale: closestAttributeValue(this.$root, 'lang')
      });
      this.maxLength = (_ref = (_this$config$maxwords = this.config.maxwords) != null ? _this$config$maxwords : this.config.maxlength) != null ? _ref : Infinity;
      this.$textarea = $textarea;
      const textareaDescriptionId = `${this.$textarea.id}-info`;
      const $textareaDescription = document.getElementById(textareaDescriptionId);
      if (!$textareaDescription) {
        throw new ElementError({
          component: CharacterCount,
          element: $textareaDescription,
          identifier: `Count message (\`id="${textareaDescriptionId}"\`)`
        });
      }
      if (`${$textareaDescription.textContent}`.match(/^\s*$/)) {
        $textareaDescription.textContent = this.i18n.t('textareaDescription', {
          count: this.maxLength
        });
      }
      this.$textarea.insertAdjacentElement('afterend', $textareaDescription);
      const $screenReaderCountMessage = document.createElement('div');
      $screenReaderCountMessage.className = 'govuk-character-count__sr-status govuk-visually-hidden';
      $screenReaderCountMessage.setAttribute('aria-live', 'polite');
      this.$screenReaderCountMessage = $screenReaderCountMessage;
      $textareaDescription.insertAdjacentElement('afterend', $screenReaderCountMessage);
      const $visibleCountMessage = document.createElement('div');
      $visibleCountMessage.className = $textareaDescription.className;
      $visibleCountMessage.classList.add('govuk-character-count__status');
      $visibleCountMessage.setAttribute('aria-hidden', 'true');
      this.$visibleCountMessage = $visibleCountMessage;
      $textareaDescription.insertAdjacentElement('afterend', $visibleCountMessage);
      $textareaDescription.classList.add('govuk-visually-hidden');
      this.$textarea.removeAttribute('maxlength');
      this.bindChangeEvents();
      window.addEventListener('pageshow', () => this.updateCountMessage());
      this.updateCountMessage();
    }
    bindChangeEvents() {
      this.$textarea.addEventListener('keyup', () => this.handleKeyUp());
      this.$textarea.addEventListener('focus', () => this.handleFocus());
      this.$textarea.addEventListener('blur', () => this.handleBlur());
    }
    handleKeyUp() {
      this.updateVisibleCountMessage();
      this.lastInputTimestamp = Date.now();
    }
    handleFocus() {
      this.valueChecker = window.setInterval(() => {
        if (!this.lastInputTimestamp || Date.now() - 500 >= this.lastInputTimestamp) {
          this.updateIfValueChanged();
        }
      }, 1000);
    }
    handleBlur() {
      if (this.valueChecker) {
        window.clearInterval(this.valueChecker);
      }
    }
    updateIfValueChanged() {
      if (this.$textarea.value !== this.lastInputValue) {
        this.lastInputValue = this.$textarea.value;
        this.updateCountMessage();
      }
    }
    updateCountMessage() {
      this.updateVisibleCountMessage();
      this.updateScreenReaderCountMessage();
    }
    updateVisibleCountMessage() {
      const remainingNumber = this.maxLength - this.count(this.$textarea.value);
      const isError = remainingNumber < 0;
      this.$visibleCountMessage.classList.toggle('govuk-character-count__message--disabled', !this.isOverThreshold());
      this.$textarea.classList.toggle('govuk-textarea--error', isError);
      this.$visibleCountMessage.classList.toggle('govuk-error-message', isError);
      this.$visibleCountMessage.classList.toggle('govuk-hint', !isError);
      this.$visibleCountMessage.textContent = this.getCountMessage();
    }
    updateScreenReaderCountMessage() {
      if (this.isOverThreshold()) {
        this.$screenReaderCountMessage.removeAttribute('aria-hidden');
      } else {
        this.$screenReaderCountMessage.setAttribute('aria-hidden', 'true');
      }
      this.$screenReaderCountMessage.textContent = this.getCountMessage();
    }
    count(text) {
      if (this.config.maxwords) {
        var _text$match;
        const tokens = (_text$match = text.match(/\S+/g)) != null ? _text$match : [];
        return tokens.length;
      }
      return text.length;
    }
    getCountMessage() {
      const remainingNumber = this.maxLength - this.count(this.$textarea.value);
      const countType = this.config.maxwords ? 'words' : 'characters';
      return this.formatCountMessage(remainingNumber, countType);
    }
    formatCountMessage(remainingNumber, countType) {
      if (remainingNumber === 0) {
        return this.i18n.t(`${countType}AtLimit`);
      }
      const translationKeySuffix = remainingNumber < 0 ? 'OverLimit' : 'UnderLimit';
      return this.i18n.t(`${countType}${translationKeySuffix}`, {
        count: Math.abs(remainingNumber)
      });
    }
    isOverThreshold() {
      if (!this.config.threshold) {
        return true;
      }
      const currentLength = this.count(this.$textarea.value);
      const maxLength = this.maxLength;
      const thresholdValue = maxLength * this.config.threshold / 100;
      return thresholdValue <= currentLength;
    }
  }

  /**
   * Character count config
   *
   * @see {@link CharacterCount.defaults}
   * @typedef {object} CharacterCountConfig
   * @property {number} [maxlength] - The maximum number of characters.
   *   If maxwords is provided, the maxlength option will be ignored.
   * @property {number} [maxwords] - The maximum number of words. If maxwords is
   *   provided, the maxlength option will be ignored.
   * @property {number} [threshold=0] - The percentage value of the limit at
   *   which point the count message is displayed. If this attribute is set, the
   *   count message will be hidden by default.
   * @property {CharacterCountTranslations} [i18n=CharacterCount.defaults.i18n] - Character count translations
   */

  /**
   * Character count translations
   *
   * @see {@link CharacterCount.defaults.i18n}
   * @typedef {object} CharacterCountTranslations
   *
   * Messages shown to users as they type. It provides feedback on how many words
   * or characters they have remaining or if they are over the limit. This also
   * includes a message used as an accessible description for the textarea.
   * @property {TranslationPluralForms} [charactersUnderLimit] - Message displayed
   *   when the number of characters is under the configured maximum, `maxlength`.
   *   This message is displayed visually and through assistive technologies. The
   *   component will replace the `%{count}` placeholder with the number of
   *   remaining characters. This is a [pluralised list of
   *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).
   * @property {string} [charactersAtLimit] - Message displayed when the number of
   *   characters reaches the configured maximum, `maxlength`. This message is
   *   displayed visually and through assistive technologies.
   * @property {TranslationPluralForms} [charactersOverLimit] - Message displayed
   *   when the number of characters is over the configured maximum, `maxlength`.
   *   This message is displayed visually and through assistive technologies. The
   *   component will replace the `%{count}` placeholder with the number of
   *   remaining characters. This is a [pluralised list of
   *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).
   * @property {TranslationPluralForms} [wordsUnderLimit] - Message displayed when
   *   the number of words is under the configured maximum, `maxlength`. This
   *   message is displayed visually and through assistive technologies. The
   *   component will replace the `%{count}` placeholder with the number of
   *   remaining words. This is a [pluralised list of
   *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).
   * @property {string} [wordsAtLimit] - Message displayed when the number of
   *   words reaches the configured maximum, `maxlength`. This message is
   *   displayed visually and through assistive technologies.
   * @property {TranslationPluralForms} [wordsOverLimit] - Message displayed when
   *   the number of words is over the configured maximum, `maxlength`. This
   *   message is displayed visually and through assistive technologies. The
   *   component will replace the `%{count}` placeholder with the number of
   *   remaining words. This is a [pluralised list of
   *   messages](https://frontend.design-system.service.gov.uk/localise-govuk-frontend).
   * @property {TranslationPluralForms} [textareaDescription] - Message made
   *   available to assistive technologies, if none is already present in the
   *   HTML, to describe that the component accepts only a limited amount of
   *   content. It is visible on the page when JavaScript is unavailable. The
   *   component will replace the `%{count}` placeholder with the value of the
   *   `maxlength` or `maxwords` parameter.
   */

  /**
   * @typedef {import('../../common/index.mjs').Schema} Schema
   * @typedef {import('../../i18n.mjs').TranslationPluralForms} TranslationPluralForms
   */
  CharacterCount.moduleName = 'govuk-character-count';
  CharacterCount.defaults = Object.freeze({
    threshold: 0,
    i18n: {
      charactersUnderLimit: {
        one: 'You have %{count} character remaining',
        other: 'You have %{count} characters remaining'
      },
      charactersAtLimit: 'You have 0 characters remaining',
      charactersOverLimit: {
        one: 'You have %{count} character too many',
        other: 'You have %{count} characters too many'
      },
      wordsUnderLimit: {
        one: 'You have %{count} word remaining',
        other: 'You have %{count} words remaining'
      },
      wordsAtLimit: 'You have 0 words remaining',
      wordsOverLimit: {
        one: 'You have %{count} word too many',
        other: 'You have %{count} words too many'
      },
      textareaDescription: {
        other: ''
      }
    }
  });
  CharacterCount.schema = Object.freeze({
    properties: {
      i18n: {
        type: 'object'
      },
      maxwords: {
        type: 'number'
      },
      maxlength: {
        type: 'number'
      },
      threshold: {
        type: 'number'
      }
    },
    anyOf: [{
      required: ['maxwords'],
      errorMessage: 'Either "maxlength" or "maxwords" must be provided'
    }, {
      required: ['maxlength'],
      errorMessage: 'Either "maxlength" or "maxwords" must be provided'
    }]
  });

  /**
   * Checkboxes component
   *
   * @preserve
   */
  class Checkboxes extends GOVUKFrontendComponent {
    /**
     * Checkboxes can be associated with a 'conditionally revealed' content block
     * – for example, a checkbox for 'Phone' could reveal an additional form field
     * for the user to enter their phone number.
     *
     * These associations are made using a `data-aria-controls` attribute, which
     * is promoted to an aria-controls attribute during initialisation.
     *
     * We also need to restore the state of any conditional reveals on the page
     * (for example if the user has navigated back), and set up event handlers to
     * keep the reveal in sync with the checkbox state.
     *
     * @param {Element | null} $root - HTML element to use for checkboxes
     */
    constructor($root) {
      super($root);
      this.$inputs = void 0;
      const $inputs = this.$root.querySelectorAll('input[type="checkbox"]');
      if (!$inputs.length) {
        throw new ElementError({
          component: Checkboxes,
          identifier: 'Form inputs (`<input type="checkbox">`)'
        });
      }
      this.$inputs = $inputs;
      this.$inputs.forEach($input => {
        const targetId = $input.getAttribute('data-aria-controls');
        if (!targetId) {
          return;
        }
        if (!document.getElementById(targetId)) {
          throw new ElementError({
            component: Checkboxes,
            identifier: `Conditional reveal (\`id="${targetId}"\`)`
          });
        }
        $input.setAttribute('aria-controls', targetId);
        $input.removeAttribute('data-aria-controls');
      });
      window.addEventListener('pageshow', () => this.syncAllConditionalReveals());
      this.syncAllConditionalReveals();
      this.$root.addEventListener('click', event => this.handleClick(event));
    }
    syncAllConditionalReveals() {
      this.$inputs.forEach($input => this.syncConditionalRevealWithInputState($input));
    }
    syncConditionalRevealWithInputState($input) {
      const targetId = $input.getAttribute('aria-controls');
      if (!targetId) {
        return;
      }
      const $target = document.getElementById(targetId);
      if ($target != null && $target.classList.contains('govuk-checkboxes__conditional')) {
        const inputIsChecked = $input.checked;
        $input.setAttribute('aria-expanded', inputIsChecked.toString());
        $target.classList.toggle('govuk-checkboxes__conditional--hidden', !inputIsChecked);
      }
    }
    unCheckAllInputsExcept($input) {
      const allInputsWithSameName = document.querySelectorAll(`input[type="checkbox"][name="${$input.name}"]`);
      allInputsWithSameName.forEach($inputWithSameName => {
        const hasSameFormOwner = $input.form === $inputWithSameName.form;
        if (hasSameFormOwner && $inputWithSameName !== $input) {
          $inputWithSameName.checked = false;
          this.syncConditionalRevealWithInputState($inputWithSameName);
        }
      });
    }
    unCheckExclusiveInputs($input) {
      const allInputsWithSameNameAndExclusiveBehaviour = document.querySelectorAll(`input[data-behaviour="exclusive"][type="checkbox"][name="${$input.name}"]`);
      allInputsWithSameNameAndExclusiveBehaviour.forEach($exclusiveInput => {
        const hasSameFormOwner = $input.form === $exclusiveInput.form;
        if (hasSameFormOwner) {
          $exclusiveInput.checked = false;
          this.syncConditionalRevealWithInputState($exclusiveInput);
        }
      });
    }
    handleClick(event) {
      const $clickedInput = event.target;
      if (!($clickedInput instanceof HTMLInputElement) || $clickedInput.type !== 'checkbox') {
        return;
      }
      const hasAriaControls = $clickedInput.getAttribute('aria-controls');
      if (hasAriaControls) {
        this.syncConditionalRevealWithInputState($clickedInput);
      }
      if (!$clickedInput.checked) {
        return;
      }
      const hasBehaviourExclusive = $clickedInput.getAttribute('data-behaviour') === 'exclusive';
      if (hasBehaviourExclusive) {
        this.unCheckAllInputsExcept($clickedInput);
      } else {
        this.unCheckExclusiveInputs($clickedInput);
      }
    }
  }
  Checkboxes.moduleName = 'govuk-checkboxes';

  /**
   * Error summary component
   *
   * Takes focus on initialisation for accessible announcement, unless disabled in
   * configuration.
   *
   * @preserve
   */
  class ErrorSummary extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for error summary
     * @param {ErrorSummaryConfig} [config] - Error summary config
     */
    constructor($root, config = {}) {
      super($root);
      this.config = void 0;
      this.config = mergeConfigs(ErrorSummary.defaults, config, normaliseDataset(ErrorSummary, this.$root.dataset));
      if (!this.config.disableAutoFocus) {
        setFocus(this.$root);
      }
      this.$root.addEventListener('click', event => this.handleClick(event));
    }
    handleClick(event) {
      const $target = event.target;
      if ($target && this.focusTarget($target)) {
        event.preventDefault();
      }
    }
    focusTarget($target) {
      if (!($target instanceof HTMLAnchorElement)) {
        return false;
      }
      const inputId = getFragmentFromUrl($target.href);
      if (!inputId) {
        return false;
      }
      const $input = document.getElementById(inputId);
      if (!$input) {
        return false;
      }
      const $legendOrLabel = this.getAssociatedLegendOrLabel($input);
      if (!$legendOrLabel) {
        return false;
      }
      $legendOrLabel.scrollIntoView();
      $input.focus({
        preventScroll: true
      });
      return true;
    }
    getAssociatedLegendOrLabel($input) {
      var _document$querySelect;
      const $fieldset = $input.closest('fieldset');
      if ($fieldset) {
        const $legends = $fieldset.getElementsByTagName('legend');
        if ($legends.length) {
          const $candidateLegend = $legends[0];
          if ($input instanceof HTMLInputElement && ($input.type === 'checkbox' || $input.type === 'radio')) {
            return $candidateLegend;
          }
          const legendTop = $candidateLegend.getBoundingClientRect().top;
          const inputRect = $input.getBoundingClientRect();
          if (inputRect.height && window.innerHeight) {
            const inputBottom = inputRect.top + inputRect.height;
            if (inputBottom - legendTop < window.innerHeight / 2) {
              return $candidateLegend;
            }
          }
        }
      }
      return (_document$querySelect = document.querySelector(`label[for='${$input.getAttribute('id')}']`)) != null ? _document$querySelect : $input.closest('label');
    }
  }

  /**
   * Error summary config
   *
   * @typedef {object} ErrorSummaryConfig
   * @property {boolean} [disableAutoFocus=false] - If set to `true` the error
   *   summary will not be focussed when the page loads.
   */

  /**
   * @typedef {import('../../common/index.mjs').Schema} Schema
   */
  ErrorSummary.moduleName = 'govuk-error-summary';
  ErrorSummary.defaults = Object.freeze({
    disableAutoFocus: false
  });
  ErrorSummary.schema = Object.freeze({
    properties: {
      disableAutoFocus: {
        type: 'boolean'
      }
    }
  });

  /**
   * Exit this page component
   *
   * @preserve
   */
  class ExitThisPage extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element that wraps the Exit This Page button
     * @param {ExitThisPageConfig} [config] - Exit This Page config
     */
    constructor($root, config = {}) {
      super($root);
      this.config = void 0;
      this.i18n = void 0;
      this.$button = void 0;
      this.$skiplinkButton = null;
      this.$updateSpan = null;
      this.$indicatorContainer = null;
      this.$overlay = null;
      this.keypressCounter = 0;
      this.lastKeyWasModified = false;
      this.timeoutTime = 5000;
      this.keypressTimeoutId = null;
      this.timeoutMessageId = null;
      const $button = this.$root.querySelector('.govuk-exit-this-page__button');
      if (!($button instanceof HTMLAnchorElement)) {
        throw new ElementError({
          component: ExitThisPage,
          element: $button,
          expectedType: 'HTMLAnchorElement',
          identifier: 'Button (`.govuk-exit-this-page__button`)'
        });
      }
      this.config = mergeConfigs(ExitThisPage.defaults, config, normaliseDataset(ExitThisPage, this.$root.dataset));
      this.i18n = new I18n(this.config.i18n);
      this.$button = $button;
      const $skiplinkButton = document.querySelector('.govuk-js-exit-this-page-skiplink');
      if ($skiplinkButton instanceof HTMLAnchorElement) {
        this.$skiplinkButton = $skiplinkButton;
      }
      this.buildIndicator();
      this.initUpdateSpan();
      this.initButtonClickHandler();
      if (!('govukFrontendExitThisPageKeypress' in document.body.dataset)) {
        document.addEventListener('keyup', this.handleKeypress.bind(this), true);
        document.body.dataset.govukFrontendExitThisPageKeypress = 'true';
      }
      window.addEventListener('pageshow', this.resetPage.bind(this));
    }
    initUpdateSpan() {
      this.$updateSpan = document.createElement('span');
      this.$updateSpan.setAttribute('role', 'status');
      this.$updateSpan.className = 'govuk-visually-hidden';
      this.$root.appendChild(this.$updateSpan);
    }
    initButtonClickHandler() {
      this.$button.addEventListener('click', this.handleClick.bind(this));
      if (this.$skiplinkButton) {
        this.$skiplinkButton.addEventListener('click', this.handleClick.bind(this));
      }
    }
    buildIndicator() {
      this.$indicatorContainer = document.createElement('div');
      this.$indicatorContainer.className = 'govuk-exit-this-page__indicator';
      this.$indicatorContainer.setAttribute('aria-hidden', 'true');
      for (let i = 0; i < 3; i++) {
        const $indicator = document.createElement('div');
        $indicator.className = 'govuk-exit-this-page__indicator-light';
        this.$indicatorContainer.appendChild($indicator);
      }
      this.$button.appendChild(this.$indicatorContainer);
    }
    updateIndicator() {
      if (!this.$indicatorContainer) {
        return;
      }
      this.$indicatorContainer.classList.toggle('govuk-exit-this-page__indicator--visible', this.keypressCounter > 0);
      const $indicators = this.$indicatorContainer.querySelectorAll('.govuk-exit-this-page__indicator-light');
      $indicators.forEach(($indicator, index) => {
        $indicator.classList.toggle('govuk-exit-this-page__indicator-light--on', index < this.keypressCounter);
      });
    }
    exitPage() {
      if (!this.$updateSpan) {
        return;
      }
      this.$updateSpan.textContent = '';
      document.body.classList.add('govuk-exit-this-page-hide-content');
      this.$overlay = document.createElement('div');
      this.$overlay.className = 'govuk-exit-this-page-overlay';
      this.$overlay.setAttribute('role', 'alert');
      document.body.appendChild(this.$overlay);
      this.$overlay.textContent = this.i18n.t('activated');
      window.location.href = this.$button.href;
    }
    handleClick(event) {
      event.preventDefault();
      this.exitPage();
    }
    handleKeypress(event) {
      if (!this.$updateSpan) {
        return;
      }
      if (event.key === 'Shift' && !this.lastKeyWasModified) {
        this.keypressCounter += 1;
        this.updateIndicator();
        if (this.timeoutMessageId) {
          window.clearTimeout(this.timeoutMessageId);
          this.timeoutMessageId = null;
        }
        if (this.keypressCounter >= 3) {
          this.keypressCounter = 0;
          if (this.keypressTimeoutId) {
            window.clearTimeout(this.keypressTimeoutId);
            this.keypressTimeoutId = null;
          }
          this.exitPage();
        } else {
          if (this.keypressCounter === 1) {
            this.$updateSpan.textContent = this.i18n.t('pressTwoMoreTimes');
          } else {
            this.$updateSpan.textContent = this.i18n.t('pressOneMoreTime');
          }
        }
        this.setKeypressTimer();
      } else if (this.keypressTimeoutId) {
        this.resetKeypressTimer();
      }
      this.lastKeyWasModified = event.shiftKey;
    }
    setKeypressTimer() {
      if (this.keypressTimeoutId) {
        window.clearTimeout(this.keypressTimeoutId);
      }
      this.keypressTimeoutId = window.setTimeout(this.resetKeypressTimer.bind(this), this.timeoutTime);
    }
    resetKeypressTimer() {
      if (!this.$updateSpan) {
        return;
      }
      if (this.keypressTimeoutId) {
        window.clearTimeout(this.keypressTimeoutId);
        this.keypressTimeoutId = null;
      }
      const $updateSpan = this.$updateSpan;
      this.keypressCounter = 0;
      $updateSpan.textContent = this.i18n.t('timedOut');
      this.timeoutMessageId = window.setTimeout(() => {
        $updateSpan.textContent = '';
      }, this.timeoutTime);
      this.updateIndicator();
    }
    resetPage() {
      document.body.classList.remove('govuk-exit-this-page-hide-content');
      if (this.$overlay) {
        this.$overlay.remove();
        this.$overlay = null;
      }
      if (this.$updateSpan) {
        this.$updateSpan.setAttribute('role', 'status');
        this.$updateSpan.textContent = '';
      }
      this.updateIndicator();
      if (this.keypressTimeoutId) {
        window.clearTimeout(this.keypressTimeoutId);
      }
      if (this.timeoutMessageId) {
        window.clearTimeout(this.timeoutMessageId);
      }
    }
  }

  /**
   * Exit this Page config
   *
   * @see {@link ExitThisPage.defaults}
   * @typedef {object} ExitThisPageConfig
   * @property {ExitThisPageTranslations} [i18n=ExitThisPage.defaults.i18n] - Exit this page translations
   */

  /**
   * Exit this Page translations
   *
   * @see {@link ExitThisPage.defaults.i18n}
   * @typedef {object} ExitThisPageTranslations
   *
   * Messages used by the component programatically inserted text, including
   * overlay text and screen reader announcements.
   * @property {string} [activated] - Screen reader announcement for when EtP
   *   keypress functionality has been successfully activated.
   * @property {string} [timedOut] - Screen reader announcement for when the EtP
   *   keypress functionality has timed out.
   * @property {string} [pressTwoMoreTimes] - Screen reader announcement informing
   *   the user they must press the activation key two more times.
   * @property {string} [pressOneMoreTime] - Screen reader announcement informing
   *   the user they must press the activation key one more time.
   */

  /**
   * @typedef {import('../../common/index.mjs').Schema} Schema
   */
  ExitThisPage.moduleName = 'govuk-exit-this-page';
  ExitThisPage.defaults = Object.freeze({
    i18n: {
      activated: 'Loading.',
      timedOut: 'Exit this page expired.',
      pressTwoMoreTimes: 'Shift, press 2 more times to exit.',
      pressOneMoreTime: 'Shift, press 1 more time to exit.'
    }
  });
  ExitThisPage.schema = Object.freeze({
    properties: {
      i18n: {
        type: 'object'
      }
    }
  });

  /**
   * Header component
   *
   * @preserve
   */
  class Header extends GOVUKFrontendComponent {
    /**
     * Apply a matchMedia for desktop which will trigger a state sync if the
     * browser viewport moves between states.
     *
     * @param {Element | null} $root - HTML element to use for header
     */
    constructor($root) {
      super($root);
      this.$menuButton = void 0;
      this.$menu = void 0;
      this.menuIsOpen = false;
      this.mql = null;
      const $menuButton = this.$root.querySelector('.govuk-js-header-toggle');
      if (!$menuButton) {
        return this;
      }
      const menuId = $menuButton.getAttribute('aria-controls');
      if (!menuId) {
        throw new ElementError({
          component: Header,
          identifier: 'Navigation button (`<button class="govuk-js-header-toggle">`) attribute (`aria-controls`)'
        });
      }
      const $menu = document.getElementById(menuId);
      if (!$menu) {
        throw new ElementError({
          component: Header,
          element: $menu,
          identifier: `Navigation (\`<ul id="${menuId}">\`)`
        });
      }
      this.$menu = $menu;
      this.$menuButton = $menuButton;
      this.setupResponsiveChecks();
      this.$menuButton.addEventListener('click', () => this.handleMenuButtonClick());
    }
    setupResponsiveChecks() {
      const breakpoint = getBreakpoint('desktop');
      if (!breakpoint.value) {
        throw new ElementError({
          component: Header,
          identifier: `CSS custom property (\`${breakpoint.property}\`) on pseudo-class \`:root\``
        });
      }
      this.mql = window.matchMedia(`(min-width: ${breakpoint.value})`);
      if ('addEventListener' in this.mql) {
        this.mql.addEventListener('change', () => this.checkMode());
      } else {
        this.mql.addListener(() => this.checkMode());
      }
      this.checkMode();
    }
    checkMode() {
      if (!this.mql || !this.$menu || !this.$menuButton) {
        return;
      }
      if (this.mql.matches) {
        this.$menu.removeAttribute('hidden');
        this.$menuButton.setAttribute('hidden', '');
      } else {
        this.$menuButton.removeAttribute('hidden');
        this.$menuButton.setAttribute('aria-expanded', this.menuIsOpen.toString());
        if (this.menuIsOpen) {
          this.$menu.removeAttribute('hidden');
        } else {
          this.$menu.setAttribute('hidden', '');
        }
      }
    }
    handleMenuButtonClick() {
      this.menuIsOpen = !this.menuIsOpen;
      this.checkMode();
    }
  }
  Header.moduleName = 'govuk-header';

  /**
   * Notification Banner component
   *
   * @preserve
   */
  class NotificationBanner extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for notification banner
     * @param {NotificationBannerConfig} [config] - Notification banner config
     */
    constructor($root, config = {}) {
      super($root);
      this.config = void 0;
      this.config = mergeConfigs(NotificationBanner.defaults, config, normaliseDataset(NotificationBanner, this.$root.dataset));
      if (this.$root.getAttribute('role') === 'alert' && !this.config.disableAutoFocus) {
        setFocus(this.$root);
      }
    }
  }

  /**
   * Notification banner config
   *
   * @typedef {object} NotificationBannerConfig
   * @property {boolean} [disableAutoFocus=false] - If set to `true` the
   *   notification banner will not be focussed when the page loads. This only
   *   applies if the component has a `role` of `alert` – in other cases the
   *   component will not be focused on page load, regardless of this option.
   */

  /**
   * @typedef {import('../../common/index.mjs').Schema} Schema
   */
  NotificationBanner.moduleName = 'govuk-notification-banner';
  NotificationBanner.defaults = Object.freeze({
    disableAutoFocus: false
  });
  NotificationBanner.schema = Object.freeze({
    properties: {
      disableAutoFocus: {
        type: 'boolean'
      }
    }
  });

  /**
   * Password input component
   *
   * @preserve
   */
  class PasswordInput extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for password input
     * @param {PasswordInputConfig} [config] - Password input config
     */
    constructor($root, config = {}) {
      super($root);
      this.config = void 0;
      this.i18n = void 0;
      this.$input = void 0;
      this.$showHideButton = void 0;
      this.$screenReaderStatusMessage = void 0;
      const $input = this.$root.querySelector('.govuk-js-password-input-input');
      if (!($input instanceof HTMLInputElement)) {
        throw new ElementError({
          component: PasswordInput,
          element: $input,
          expectedType: 'HTMLInputElement',
          identifier: 'Form field (`.govuk-js-password-input-input`)'
        });
      }
      if ($input.type !== 'password') {
        throw new ElementError('Password input: Form field (`.govuk-js-password-input-input`) must be of type `password`.');
      }
      const $showHideButton = this.$root.querySelector('.govuk-js-password-input-toggle');
      if (!($showHideButton instanceof HTMLButtonElement)) {
        throw new ElementError({
          component: PasswordInput,
          element: $showHideButton,
          expectedType: 'HTMLButtonElement',
          identifier: 'Button (`.govuk-js-password-input-toggle`)'
        });
      }
      if ($showHideButton.type !== 'button') {
        throw new ElementError('Password input: Button (`.govuk-js-password-input-toggle`) must be of type `button`.');
      }
      this.$input = $input;
      this.$showHideButton = $showHideButton;
      this.config = mergeConfigs(PasswordInput.defaults, config, normaliseDataset(PasswordInput, this.$root.dataset));
      this.i18n = new I18n(this.config.i18n, {
        locale: closestAttributeValue(this.$root, 'lang')
      });
      this.$showHideButton.removeAttribute('hidden');
      const $screenReaderStatusMessage = document.createElement('div');
      $screenReaderStatusMessage.className = 'govuk-password-input__sr-status govuk-visually-hidden';
      $screenReaderStatusMessage.setAttribute('aria-live', 'polite');
      this.$screenReaderStatusMessage = $screenReaderStatusMessage;
      this.$input.insertAdjacentElement('afterend', $screenReaderStatusMessage);
      this.$showHideButton.addEventListener('click', this.toggle.bind(this));
      if (this.$input.form) {
        this.$input.form.addEventListener('submit', () => this.hide());
      }
      window.addEventListener('pageshow', event => {
        if (event.persisted && this.$input.type !== 'password') {
          this.hide();
        }
      });
      this.hide();
    }
    toggle(event) {
      event.preventDefault();
      if (this.$input.type === 'password') {
        this.show();
        return;
      }
      this.hide();
    }
    show() {
      this.setType('text');
    }
    hide() {
      this.setType('password');
    }
    setType(type) {
      if (type === this.$input.type) {
        return;
      }
      this.$input.setAttribute('type', type);
      const isHidden = type === 'password';
      const prefixButton = isHidden ? 'show' : 'hide';
      const prefixStatus = isHidden ? 'passwordHidden' : 'passwordShown';
      this.$showHideButton.innerText = this.i18n.t(`${prefixButton}Password`);
      this.$showHideButton.setAttribute('aria-label', this.i18n.t(`${prefixButton}PasswordAriaLabel`));
      this.$screenReaderStatusMessage.innerText = this.i18n.t(`${prefixStatus}Announcement`);
    }
  }

  /**
   * Password input config
   *
   * @typedef {object} PasswordInputConfig
   * @property {PasswordInputTranslations} [i18n=PasswordInput.defaults.i18n] - Password input translations
   */

  /**
   * Password input translations
   *
   * @see {@link PasswordInput.defaults.i18n}
   * @typedef {object} PasswordInputTranslations
   *
   * Messages displayed to the user indicating the state of the show/hide toggle.
   * @property {string} [showPassword] - Visible text of the button when the
   *   password is currently hidden. Plain text only.
   * @property {string} [hidePassword] - Visible text of the button when the
   *   password is currently visible. Plain text only.
   * @property {string} [showPasswordAriaLabel] - aria-label of the button when
   *   the password is currently hidden. Plain text only.
   * @property {string} [hidePasswordAriaLabel] - aria-label of the button when
   *   the password is currently visible. Plain text only.
   * @property {string} [passwordShownAnnouncement] - Screen reader
   *   announcement to make when the password has just become visible.
   *   Plain text only.
   * @property {string} [passwordHiddenAnnouncement] - Screen reader
   *   announcement to make when the password has just been hidden.
   *   Plain text only.
   */

  /**
   * @typedef {import('../../common/index.mjs').Schema} Schema
   * @typedef {import('../../i18n.mjs').TranslationPluralForms} TranslationPluralForms
   */
  PasswordInput.moduleName = 'govuk-password-input';
  PasswordInput.defaults = Object.freeze({
    i18n: {
      showPassword: 'Show',
      hidePassword: 'Hide',
      showPasswordAriaLabel: 'Show password',
      hidePasswordAriaLabel: 'Hide password',
      passwordShownAnnouncement: 'Your password is visible',
      passwordHiddenAnnouncement: 'Your password is hidden'
    }
  });
  PasswordInput.schema = Object.freeze({
    properties: {
      i18n: {
        type: 'object'
      }
    }
  });

  /**
   * Radios component
   *
   * @preserve
   */
  class Radios extends GOVUKFrontendComponent {
    /**
     * Radios can be associated with a 'conditionally revealed' content block –
     * for example, a radio for 'Phone' could reveal an additional form field for
     * the user to enter their phone number.
     *
     * These associations are made using a `data-aria-controls` attribute, which
     * is promoted to an aria-controls attribute during initialisation.
     *
     * We also need to restore the state of any conditional reveals on the page
     * (for example if the user has navigated back), and set up event handlers to
     * keep the reveal in sync with the radio state.
     *
     * @param {Element | null} $root - HTML element to use for radios
     */
    constructor($root) {
      super($root);
      this.$inputs = void 0;
      const $inputs = this.$root.querySelectorAll('input[type="radio"]');
      if (!$inputs.length) {
        throw new ElementError({
          component: Radios,
          identifier: 'Form inputs (`<input type="radio">`)'
        });
      }
      this.$inputs = $inputs;
      this.$inputs.forEach($input => {
        const targetId = $input.getAttribute('data-aria-controls');
        if (!targetId) {
          return;
        }
        if (!document.getElementById(targetId)) {
          throw new ElementError({
            component: Radios,
            identifier: `Conditional reveal (\`id="${targetId}"\`)`
          });
        }
        $input.setAttribute('aria-controls', targetId);
        $input.removeAttribute('data-aria-controls');
      });
      window.addEventListener('pageshow', () => this.syncAllConditionalReveals());
      this.syncAllConditionalReveals();
      this.$root.addEventListener('click', event => this.handleClick(event));
    }
    syncAllConditionalReveals() {
      this.$inputs.forEach($input => this.syncConditionalRevealWithInputState($input));
    }
    syncConditionalRevealWithInputState($input) {
      const targetId = $input.getAttribute('aria-controls');
      if (!targetId) {
        return;
      }
      const $target = document.getElementById(targetId);
      if ($target != null && $target.classList.contains('govuk-radios__conditional')) {
        const inputIsChecked = $input.checked;
        $input.setAttribute('aria-expanded', inputIsChecked.toString());
        $target.classList.toggle('govuk-radios__conditional--hidden', !inputIsChecked);
      }
    }
    handleClick(event) {
      const $clickedInput = event.target;
      if (!($clickedInput instanceof HTMLInputElement) || $clickedInput.type !== 'radio') {
        return;
      }
      const $allInputs = document.querySelectorAll('input[type="radio"][aria-controls]');
      const $clickedInputForm = $clickedInput.form;
      const $clickedInputName = $clickedInput.name;
      $allInputs.forEach($input => {
        const hasSameFormOwner = $input.form === $clickedInputForm;
        const hasSameName = $input.name === $clickedInputName;
        if (hasSameName && hasSameFormOwner) {
          this.syncConditionalRevealWithInputState($input);
        }
      });
    }
  }
  Radios.moduleName = 'govuk-radios';

  /**
   * Service Navigation component
   *
   * @preserve
   */
  class ServiceNavigation extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for header
     */
    constructor($root) {
      super($root);
      this.$menuButton = void 0;
      this.$menu = void 0;
      this.menuIsOpen = false;
      this.mql = null;
      const $menuButton = this.$root.querySelector('.govuk-js-service-navigation-toggle');
      if (!$menuButton) {
        return this;
      }
      const menuId = $menuButton.getAttribute('aria-controls');
      if (!menuId) {
        throw new ElementError({
          component: ServiceNavigation,
          identifier: 'Navigation button (`<button class="govuk-js-service-navigation-toggle">`) attribute (`aria-controls`)'
        });
      }
      const $menu = document.getElementById(menuId);
      if (!$menu) {
        throw new ElementError({
          component: ServiceNavigation,
          element: $menu,
          identifier: `Navigation (\`<ul id="${menuId}">\`)`
        });
      }
      this.$menu = $menu;
      this.$menuButton = $menuButton;
      this.setupResponsiveChecks();
      this.$menuButton.addEventListener('click', () => this.handleMenuButtonClick());
    }
    setupResponsiveChecks() {
      const breakpoint = getBreakpoint('tablet');
      if (!breakpoint.value) {
        throw new ElementError({
          component: ServiceNavigation,
          identifier: `CSS custom property (\`${breakpoint.property}\`) on pseudo-class \`:root\``
        });
      }
      this.mql = window.matchMedia(`(min-width: ${breakpoint.value})`);
      if ('addEventListener' in this.mql) {
        this.mql.addEventListener('change', () => this.checkMode());
      } else {
        this.mql.addListener(() => this.checkMode());
      }
      this.checkMode();
    }
    checkMode() {
      if (!this.mql || !this.$menu || !this.$menuButton) {
        return;
      }
      if (this.mql.matches) {
        this.$menu.removeAttribute('hidden');
        this.$menuButton.setAttribute('hidden', '');
      } else {
        this.$menuButton.removeAttribute('hidden');
        this.$menuButton.setAttribute('aria-expanded', this.menuIsOpen.toString());
        if (this.menuIsOpen) {
          this.$menu.removeAttribute('hidden');
        } else {
          this.$menu.setAttribute('hidden', '');
        }
      }
    }
    handleMenuButtonClick() {
      this.menuIsOpen = !this.menuIsOpen;
      this.checkMode();
    }
  }
  ServiceNavigation.moduleName = 'govuk-service-navigation';

  /**
   * Skip link component
   *
   * @preserve
   * @augments GOVUKFrontendComponent<HTMLAnchorElement>
   */
  class SkipLink extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for skip link
     * @throws {ElementError} when $root is not set or the wrong type
     * @throws {ElementError} when $root.hash does not contain a hash
     * @throws {ElementError} when the linked element is missing or the wrong type
     */
    constructor($root) {
      var _this$$root$getAttrib;
      super($root);
      const hash = this.$root.hash;
      const href = (_this$$root$getAttrib = this.$root.getAttribute('href')) != null ? _this$$root$getAttrib : '';
      let url;
      try {
        url = new window.URL(this.$root.href);
      } catch (error) {
        throw new ElementError(`Skip link: Target link (\`href="${href}"\`) is invalid`);
      }
      if (url.origin !== window.location.origin || url.pathname !== window.location.pathname) {
        return;
      }
      const linkedElementId = getFragmentFromUrl(hash);
      if (!linkedElementId) {
        throw new ElementError(`Skip link: Target link (\`href="${href}"\`) has no hash fragment`);
      }
      const $linkedElement = document.getElementById(linkedElementId);
      if (!$linkedElement) {
        throw new ElementError({
          component: SkipLink,
          element: $linkedElement,
          identifier: `Target content (\`id="${linkedElementId}"\`)`
        });
      }
      this.$root.addEventListener('click', () => setFocus($linkedElement, {
        onBeforeFocus() {
          $linkedElement.classList.add('govuk-skip-link-focused-element');
        },
        onBlur() {
          $linkedElement.classList.remove('govuk-skip-link-focused-element');
        }
      }));
    }
  }
  SkipLink.elementType = HTMLAnchorElement;
  SkipLink.moduleName = 'govuk-skip-link';

  /**
   * Tabs component
   *
   * @preserve
   */
  class Tabs extends GOVUKFrontendComponent {
    /**
     * @param {Element | null} $root - HTML element to use for tabs
     */
    constructor($root) {
      super($root);
      this.$tabs = void 0;
      this.$tabList = void 0;
      this.$tabListItems = void 0;
      this.jsHiddenClass = 'govuk-tabs__panel--hidden';
      this.changingHash = false;
      this.boundTabClick = void 0;
      this.boundTabKeydown = void 0;
      this.boundOnHashChange = void 0;
      this.mql = null;
      const $tabs = this.$root.querySelectorAll('a.govuk-tabs__tab');
      if (!$tabs.length) {
        throw new ElementError({
          component: Tabs,
          identifier: 'Links (`<a class="govuk-tabs__tab">`)'
        });
      }
      this.$tabs = $tabs;
      this.boundTabClick = this.onTabClick.bind(this);
      this.boundTabKeydown = this.onTabKeydown.bind(this);
      this.boundOnHashChange = this.onHashChange.bind(this);
      const $tabList = this.$root.querySelector('.govuk-tabs__list');
      const $tabListItems = this.$root.querySelectorAll('li.govuk-tabs__list-item');
      if (!$tabList) {
        throw new ElementError({
          component: Tabs,
          identifier: 'List (`<ul class="govuk-tabs__list">`)'
        });
      }
      if (!$tabListItems.length) {
        throw new ElementError({
          component: Tabs,
          identifier: 'List items (`<li class="govuk-tabs__list-item">`)'
        });
      }
      this.$tabList = $tabList;
      this.$tabListItems = $tabListItems;
      this.setupResponsiveChecks();
    }
    setupResponsiveChecks() {
      const breakpoint = getBreakpoint('tablet');
      if (!breakpoint.value) {
        throw new ElementError({
          component: Tabs,
          identifier: `CSS custom property (\`${breakpoint.property}\`) on pseudo-class \`:root\``
        });
      }
      this.mql = window.matchMedia(`(min-width: ${breakpoint.value})`);
      if ('addEventListener' in this.mql) {
        this.mql.addEventListener('change', () => this.checkMode());
      } else {
        this.mql.addListener(() => this.checkMode());
      }
      this.checkMode();
    }
    checkMode() {
      var _this$mql;
      if ((_this$mql = this.mql) != null && _this$mql.matches) {
        this.setup();
      } else {
        this.teardown();
      }
    }
    setup() {
      var _this$getTab;
      this.$tabList.setAttribute('role', 'tablist');
      this.$tabListItems.forEach($item => {
        $item.setAttribute('role', 'presentation');
      });
      this.$tabs.forEach($tab => {
        this.setAttributes($tab);
        $tab.addEventListener('click', this.boundTabClick, true);
        $tab.addEventListener('keydown', this.boundTabKeydown, true);
        this.hideTab($tab);
      });
      const $activeTab = (_this$getTab = this.getTab(window.location.hash)) != null ? _this$getTab : this.$tabs[0];
      this.showTab($activeTab);
      window.addEventListener('hashchange', this.boundOnHashChange, true);
    }
    teardown() {
      this.$tabList.removeAttribute('role');
      this.$tabListItems.forEach($item => {
        $item.removeAttribute('role');
      });
      this.$tabs.forEach($tab => {
        $tab.removeEventListener('click', this.boundTabClick, true);
        $tab.removeEventListener('keydown', this.boundTabKeydown, true);
        this.unsetAttributes($tab);
      });
      window.removeEventListener('hashchange', this.boundOnHashChange, true);
    }
    onHashChange() {
      const hash = window.location.hash;
      const $tabWithHash = this.getTab(hash);
      if (!$tabWithHash) {
        return;
      }
      if (this.changingHash) {
        this.changingHash = false;
        return;
      }
      const $previousTab = this.getCurrentTab();
      if (!$previousTab) {
        return;
      }
      this.hideTab($previousTab);
      this.showTab($tabWithHash);
      $tabWithHash.focus();
    }
    hideTab($tab) {
      this.unhighlightTab($tab);
      this.hidePanel($tab);
    }
    showTab($tab) {
      this.highlightTab($tab);
      this.showPanel($tab);
    }
    getTab(hash) {
      return this.$root.querySelector(`a.govuk-tabs__tab[href="${hash}"]`);
    }
    setAttributes($tab) {
      const panelId = getFragmentFromUrl($tab.href);
      if (!panelId) {
        return;
      }
      $tab.setAttribute('id', `tab_${panelId}`);
      $tab.setAttribute('role', 'tab');
      $tab.setAttribute('aria-controls', panelId);
      $tab.setAttribute('aria-selected', 'false');
      $tab.setAttribute('tabindex', '-1');
      const $panel = this.getPanel($tab);
      if (!$panel) {
        return;
      }
      $panel.setAttribute('role', 'tabpanel');
      $panel.setAttribute('aria-labelledby', $tab.id);
      $panel.classList.add(this.jsHiddenClass);
    }
    unsetAttributes($tab) {
      $tab.removeAttribute('id');
      $tab.removeAttribute('role');
      $tab.removeAttribute('aria-controls');
      $tab.removeAttribute('aria-selected');
      $tab.removeAttribute('tabindex');
      const $panel = this.getPanel($tab);
      if (!$panel) {
        return;
      }
      $panel.removeAttribute('role');
      $panel.removeAttribute('aria-labelledby');
      $panel.classList.remove(this.jsHiddenClass);
    }
    onTabClick(event) {
      const $currentTab = this.getCurrentTab();
      const $nextTab = event.currentTarget;
      if (!$currentTab || !($nextTab instanceof HTMLAnchorElement)) {
        return;
      }
      event.preventDefault();
      this.hideTab($currentTab);
      this.showTab($nextTab);
      this.createHistoryEntry($nextTab);
    }
    createHistoryEntry($tab) {
      const $panel = this.getPanel($tab);
      if (!$panel) {
        return;
      }
      const panelId = $panel.id;
      $panel.id = '';
      this.changingHash = true;
      window.location.hash = panelId;
      $panel.id = panelId;
    }
    onTabKeydown(event) {
      switch (event.key) {
        case 'ArrowLeft':
        case 'Left':
          this.activatePreviousTab();
          event.preventDefault();
          break;
        case 'ArrowRight':
        case 'Right':
          this.activateNextTab();
          event.preventDefault();
          break;
      }
    }
    activateNextTab() {
      const $currentTab = this.getCurrentTab();
      if (!($currentTab != null && $currentTab.parentElement)) {
        return;
      }
      const $nextTabListItem = $currentTab.parentElement.nextElementSibling;
      if (!$nextTabListItem) {
        return;
      }
      const $nextTab = $nextTabListItem.querySelector('a.govuk-tabs__tab');
      if (!$nextTab) {
        return;
      }
      this.hideTab($currentTab);
      this.showTab($nextTab);
      $nextTab.focus();
      this.createHistoryEntry($nextTab);
    }
    activatePreviousTab() {
      const $currentTab = this.getCurrentTab();
      if (!($currentTab != null && $currentTab.parentElement)) {
        return;
      }
      const $previousTabListItem = $currentTab.parentElement.previousElementSibling;
      if (!$previousTabListItem) {
        return;
      }
      const $previousTab = $previousTabListItem.querySelector('a.govuk-tabs__tab');
      if (!$previousTab) {
        return;
      }
      this.hideTab($currentTab);
      this.showTab($previousTab);
      $previousTab.focus();
      this.createHistoryEntry($previousTab);
    }
    getPanel($tab) {
      const panelId = getFragmentFromUrl($tab.href);
      if (!panelId) {
        return null;
      }
      return this.$root.querySelector(`#${panelId}`);
    }
    showPanel($tab) {
      const $panel = this.getPanel($tab);
      if (!$panel) {
        return;
      }
      $panel.classList.remove(this.jsHiddenClass);
    }
    hidePanel($tab) {
      const $panel = this.getPanel($tab);
      if (!$panel) {
        return;
      }
      $panel.classList.add(this.jsHiddenClass);
    }
    unhighlightTab($tab) {
      if (!$tab.parentElement) {
        return;
      }
      $tab.setAttribute('aria-selected', 'false');
      $tab.parentElement.classList.remove('govuk-tabs__list-item--selected');
      $tab.setAttribute('tabindex', '-1');
    }
    highlightTab($tab) {
      if (!$tab.parentElement) {
        return;
      }
      $tab.setAttribute('aria-selected', 'true');
      $tab.parentElement.classList.add('govuk-tabs__list-item--selected');
      $tab.setAttribute('tabindex', '0');
    }
    getCurrentTab() {
      return this.$root.querySelector('.govuk-tabs__list-item--selected a.govuk-tabs__tab');
    }
  }
  Tabs.moduleName = 'govuk-tabs';

  /**
   * Initialise all components
   *
   * Use the `data-module` attributes to find, instantiate and init all of the
   * components provided as part of GOV.UK Frontend.
   *
   * @param {Config & { scope?: Element, onError?: OnErrorCallback<CompatibleClass> }} [config] - Config for all components (with optional scope)
   */
  function initAll(config) {
    var _config$scope;
    config = typeof config !== 'undefined' ? config : {};
    if (!isSupported()) {
      if (config.onError) {
        config.onError(new SupportError(), {
          config
        });
      } else {
        console.log(new SupportError());
      }
      return;
    }
    const components = [[Accordion, config.accordion], [Button, config.button], [CharacterCount, config.characterCount], [Checkboxes], [ErrorSummary, config.errorSummary], [ExitThisPage, config.exitThisPage], [Header], [NotificationBanner, config.notificationBanner], [PasswordInput, config.passwordInput], [Radios], [ServiceNavigation], [SkipLink], [Tabs]];
    const options = {
      scope: (_config$scope = config.scope) != null ? _config$scope : document,
      onError: config.onError
    };
    components.forEach(([Component, config]) => {
      createAll(Component, config, options);
    });
  }

  /**
   * Create all instances of a specific component on the page
   *
   * Uses the `data-module` attribute to find all elements matching the specified
   * component on the page, creating instances of the component object for each
   * of them.
   *
   * Any component errors will be caught and logged to the console.
   *
   * @template {CompatibleClass} T
   * @param {T} Component - class of the component to create
   * @param {T["defaults"]} [config] - Config supplied to component
   * @param {OnErrorCallback<T> | Element | Document | CreateAllOptions<T> } [createAllOptions] - options for createAll including scope of the document to search within and callback function if error throw by component on init
   * @returns {Array<InstanceType<T>>} - array of instantiated components
   */
  function createAll(Component, config, createAllOptions) {
    let $scope = document;
    let onError;
    if (typeof createAllOptions === 'object') {
      var _createAllOptions$sco;
      createAllOptions = createAllOptions;
      $scope = (_createAllOptions$sco = createAllOptions.scope) != null ? _createAllOptions$sco : $scope;
      onError = createAllOptions.onError;
    }
    if (typeof createAllOptions === 'function') {
      onError = createAllOptions;
    }
    if (createAllOptions instanceof HTMLElement) {
      $scope = createAllOptions;
    }
    const $elements = $scope.querySelectorAll(`[data-module="${Component.moduleName}"]`);
    if (!isSupported()) {
      if (onError) {
        onError(new SupportError(), {
          component: Component,
          config
        });
      } else {
        console.log(new SupportError());
      }
      return [];
    }
    return Array.from($elements).map($element => {
      try {
        return typeof config !== 'undefined' ? new Component($element, config) : new Component($element);
      } catch (error) {
        if (onError) {
          onError(error, {
            element: $element,
            component: Component,
            config
          });
        } else {
          console.log(error);
        }
        return null;
      }
    }).filter(Boolean);
  }
  /**
   * @typedef {{new (...args: any[]): any, defaults?: object, moduleName: string}} CompatibleClass
   */
  /**
   * Config for all components via `initAll()`
   *
   * @typedef {object} Config
   * @property {AccordionConfig} [accordion] - Accordion config
   * @property {ButtonConfig} [button] - Button config
   * @property {CharacterCountConfig} [characterCount] - Character Count config
   * @property {ErrorSummaryConfig} [errorSummary] - Error Summary config
   * @property {ExitThisPageConfig} [exitThisPage] - Exit This Page config
   * @property {NotificationBannerConfig} [notificationBanner] - Notification Banner config
   * @property {PasswordInputConfig} [passwordInput] - Password input config
   */
  /**
   * Config for individual components
   *
   * @typedef {import('./components/accordion/accordion.mjs').AccordionConfig} AccordionConfig
   * @typedef {import('./components/accordion/accordion.mjs').AccordionTranslations} AccordionTranslations
   * @typedef {import('./components/button/button.mjs').ButtonConfig} ButtonConfig
   * @typedef {import('./components/character-count/character-count.mjs').CharacterCountConfig} CharacterCountConfig
   * @typedef {import('./components/character-count/character-count.mjs').CharacterCountTranslations} CharacterCountTranslations
   * @typedef {import('./components/error-summary/error-summary.mjs').ErrorSummaryConfig} ErrorSummaryConfig
   * @typedef {import('./components/exit-this-page/exit-this-page.mjs').ExitThisPageConfig} ExitThisPageConfig
   * @typedef {import('./components/exit-this-page/exit-this-page.mjs').ExitThisPageTranslations} ExitThisPageTranslations
   * @typedef {import('./components/notification-banner/notification-banner.mjs').NotificationBannerConfig} NotificationBannerConfig
   * @typedef {import('./components/password-input/password-input.mjs').PasswordInputConfig} PasswordInputConfig
   */
  /**
   * Component config keys, e.g. `accordion` and `characterCount`
   *
   * @typedef {keyof Config} ConfigKey
   */
  /**
   * @template {CompatibleClass} T
   * @typedef {object} ErrorContext
   * @property {Element} [element] - Element used for component module initialisation
   * @property {T} [component] - Class of component
   * @property {T["defaults"]} config - Config supplied to component
   */
  /**
   * @template {CompatibleClass} T
   * @callback OnErrorCallback
   * @param {unknown} error - Thrown error
   * @param {ErrorContext<T>} context - Object containing the element, component class and configuration
   */
  /**
   * @template {CompatibleClass} T
   * @typedef {object} CreateAllOptions
   * @property {Element | Document} [scope] - scope of the document to search within
   * @property {OnErrorCallback<T>} [onError] - callback function if error throw by component on init
   */

  exports.Accordion = Accordion;
  exports.Button = Button;
  exports.CharacterCount = CharacterCount;
  exports.Checkboxes = Checkboxes;
  exports.Component = GOVUKFrontendComponent;
  exports.ErrorSummary = ErrorSummary;
  exports.ExitThisPage = ExitThisPage;
  exports.Header = Header;
  exports.NotificationBanner = NotificationBanner;
  exports.PasswordInput = PasswordInput;
  exports.Radios = Radios;
  exports.ServiceNavigation = ServiceNavigation;
  exports.SkipLink = SkipLink;
  exports.Tabs = Tabs;
  exports.createAll = createAll;
  exports.initAll = initAll;
  exports.isSupported = isSupported;
  exports.version = version;

}));


},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJhc3NldHMvanMvbWFpbi5qcyIsIm5vZGVfbW9kdWxlcy9nb3Z1ay1mcm9udGVuZC9kaXN0L2dvdnVrL2FsbC5idW5kbGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIndXNlIHN0cmljdCdcblxuY29uc3QgR09WVUtGcm9udGVuZCA9IHJlcXVpcmUoJ2dvdnVrLWZyb250ZW5kJylcbkdPVlVLRnJvbnRlbmQuaW5pdEFsbCgpXG4iLCIoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuICB0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSAhPT0gJ3VuZGVmaW5lZCcgPyBmYWN0b3J5KGV4cG9ydHMpIDpcbiAgdHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kID8gZGVmaW5lKFsnZXhwb3J0cyddLCBmYWN0b3J5KSA6XG4gIChnbG9iYWwgPSB0eXBlb2YgZ2xvYmFsVGhpcyAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWxUaGlzIDogZ2xvYmFsIHx8IHNlbGYsIGZhY3RvcnkoZ2xvYmFsLkdPVlVLRnJvbnRlbmQgPSB7fSkpO1xufSkodGhpcywgKGZ1bmN0aW9uIChleHBvcnRzKSB7ICd1c2Ugc3RyaWN0JztcblxuICBjb25zdCB2ZXJzaW9uID0gJzUuNy4xJztcblxuICBmdW5jdGlvbiBub3JtYWxpc2VTdHJpbmcodmFsdWUsIHByb3BlcnR5KSB7XG4gICAgY29uc3QgdHJpbW1lZFZhbHVlID0gdmFsdWUgPyB2YWx1ZS50cmltKCkgOiAnJztcbiAgICBsZXQgb3V0cHV0O1xuICAgIGxldCBvdXRwdXRUeXBlID0gcHJvcGVydHkgPT0gbnVsbCA/IHZvaWQgMCA6IHByb3BlcnR5LnR5cGU7XG4gICAgaWYgKCFvdXRwdXRUeXBlKSB7XG4gICAgICBpZiAoWyd0cnVlJywgJ2ZhbHNlJ10uaW5jbHVkZXModHJpbW1lZFZhbHVlKSkge1xuICAgICAgICBvdXRwdXRUeXBlID0gJ2Jvb2xlYW4nO1xuICAgICAgfVxuICAgICAgaWYgKHRyaW1tZWRWYWx1ZS5sZW5ndGggPiAwICYmIGlzRmluaXRlKE51bWJlcih0cmltbWVkVmFsdWUpKSkge1xuICAgICAgICBvdXRwdXRUeXBlID0gJ251bWJlcic7XG4gICAgICB9XG4gICAgfVxuICAgIHN3aXRjaCAob3V0cHV0VHlwZSkge1xuICAgICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICAgIG91dHB1dCA9IHRyaW1tZWRWYWx1ZSA9PT0gJ3RydWUnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ251bWJlcic6XG4gICAgICAgIG91dHB1dCA9IE51bWJlcih0cmltbWVkVmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIG91dHB1dCA9IHZhbHVlO1xuICAgIH1cbiAgICByZXR1cm4gb3V0cHV0O1xuICB9XG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4vaW5kZXgubWpzJykuU2NoZW1hUHJvcGVydHl9IFNjaGVtYVByb3BlcnR5XG4gICAqL1xuXG4gIGZ1bmN0aW9uIG1lcmdlQ29uZmlncyguLi5jb25maWdPYmplY3RzKSB7XG4gICAgY29uc3QgZm9ybWF0dGVkQ29uZmlnT2JqZWN0ID0ge307XG4gICAgZm9yIChjb25zdCBjb25maWdPYmplY3Qgb2YgY29uZmlnT2JqZWN0cykge1xuICAgICAgZm9yIChjb25zdCBrZXkgb2YgT2JqZWN0LmtleXMoY29uZmlnT2JqZWN0KSkge1xuICAgICAgICBjb25zdCBvcHRpb24gPSBmb3JtYXR0ZWRDb25maWdPYmplY3Rba2V5XTtcbiAgICAgICAgY29uc3Qgb3ZlcnJpZGUgPSBjb25maWdPYmplY3Rba2V5XTtcbiAgICAgICAgaWYgKGlzT2JqZWN0KG9wdGlvbikgJiYgaXNPYmplY3Qob3ZlcnJpZGUpKSB7XG4gICAgICAgICAgZm9ybWF0dGVkQ29uZmlnT2JqZWN0W2tleV0gPSBtZXJnZUNvbmZpZ3Mob3B0aW9uLCBvdmVycmlkZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZm9ybWF0dGVkQ29uZmlnT2JqZWN0W2tleV0gPSBvdmVycmlkZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZm9ybWF0dGVkQ29uZmlnT2JqZWN0O1xuICB9XG4gIGZ1bmN0aW9uIGV4dHJhY3RDb25maWdCeU5hbWVzcGFjZShDb21wb25lbnQsIGRhdGFzZXQsIG5hbWVzcGFjZSkge1xuICAgIGNvbnN0IHByb3BlcnR5ID0gQ29tcG9uZW50LnNjaGVtYS5wcm9wZXJ0aWVzW25hbWVzcGFjZV07XG4gICAgaWYgKChwcm9wZXJ0eSA9PSBudWxsID8gdm9pZCAwIDogcHJvcGVydHkudHlwZSkgIT09ICdvYmplY3QnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IG5ld09iamVjdCA9IHtcbiAgICAgIFtuYW1lc3BhY2VdOiAoe30pXG4gICAgfTtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhkYXRhc2V0KSkge1xuICAgICAgbGV0IGN1cnJlbnQgPSBuZXdPYmplY3Q7XG4gICAgICBjb25zdCBrZXlQYXJ0cyA9IGtleS5zcGxpdCgnLicpO1xuICAgICAgZm9yIChjb25zdCBbaW5kZXgsIG5hbWVdIG9mIGtleVBhcnRzLmVudHJpZXMoKSkge1xuICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnQgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgaWYgKGluZGV4IDwga2V5UGFydHMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgaWYgKCFpc09iamVjdChjdXJyZW50W25hbWVdKSkge1xuICAgICAgICAgICAgICBjdXJyZW50W25hbWVdID0ge307XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtuYW1lXTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGtleSAhPT0gbmFtZXNwYWNlKSB7XG4gICAgICAgICAgICBjdXJyZW50W25hbWVdID0gbm9ybWFsaXNlU3RyaW5nKHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG5ld09iamVjdFtuYW1lc3BhY2VdO1xuICB9XG4gIGZ1bmN0aW9uIGdldEZyYWdtZW50RnJvbVVybCh1cmwpIHtcbiAgICBpZiAoIXVybC5pbmNsdWRlcygnIycpKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gdXJsLnNwbGl0KCcjJykucG9wKCk7XG4gIH1cbiAgZnVuY3Rpb24gZ2V0QnJlYWtwb2ludChuYW1lKSB7XG4gICAgY29uc3QgcHJvcGVydHkgPSBgLS1nb3Z1ay1mcm9udGVuZC1icmVha3BvaW50LSR7bmFtZX1gO1xuICAgIGNvbnN0IHZhbHVlID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50KS5nZXRQcm9wZXJ0eVZhbHVlKHByb3BlcnR5KTtcbiAgICByZXR1cm4ge1xuICAgICAgcHJvcGVydHksXG4gICAgICB2YWx1ZTogdmFsdWUgfHwgdW5kZWZpbmVkXG4gICAgfTtcbiAgfVxuICBmdW5jdGlvbiBzZXRGb2N1cygkZWxlbWVudCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgdmFyIF9vcHRpb25zJG9uQmVmb3JlRm9jdTtcbiAgICBjb25zdCBpc0ZvY3VzYWJsZSA9ICRlbGVtZW50LmdldEF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcbiAgICBpZiAoIWlzRm9jdXNhYmxlKSB7XG4gICAgICAkZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgfVxuICAgIGZ1bmN0aW9uIG9uRm9jdXMoKSB7XG4gICAgICAkZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgb25CbHVyLCB7XG4gICAgICAgIG9uY2U6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBmdW5jdGlvbiBvbkJsdXIoKSB7XG4gICAgICB2YXIgX29wdGlvbnMkb25CbHVyO1xuICAgICAgKF9vcHRpb25zJG9uQmx1ciA9IG9wdGlvbnMub25CbHVyKSA9PSBudWxsIHx8IF9vcHRpb25zJG9uQmx1ci5jYWxsKCRlbGVtZW50KTtcbiAgICAgIGlmICghaXNGb2N1c2FibGUpIHtcbiAgICAgICAgJGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKCd0YWJpbmRleCcpO1xuICAgICAgfVxuICAgIH1cbiAgICAkZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIG9uRm9jdXMsIHtcbiAgICAgIG9uY2U6IHRydWVcbiAgICB9KTtcbiAgICAoX29wdGlvbnMkb25CZWZvcmVGb2N1ID0gb3B0aW9ucy5vbkJlZm9yZUZvY3VzKSA9PSBudWxsIHx8IF9vcHRpb25zJG9uQmVmb3JlRm9jdS5jYWxsKCRlbGVtZW50KTtcbiAgICAkZWxlbWVudC5mb2N1cygpO1xuICB9XG4gIGZ1bmN0aW9uIGlzSW5pdGlhbGlzZWQoJHJvb3QsIG1vZHVsZU5hbWUpIHtcbiAgICByZXR1cm4gJHJvb3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiAkcm9vdC5oYXNBdHRyaWJ1dGUoYGRhdGEtJHttb2R1bGVOYW1lfS1pbml0YCk7XG4gIH1cblxuICAvKipcbiAgICogQ2hlY2tzIGlmIEdPVi5VSyBGcm9udGVuZCBpcyBzdXBwb3J0ZWQgb24gdGhpcyBwYWdlXG4gICAqXG4gICAqIFNvbWUgYnJvd3NlcnMgd2lsbCBsb2FkIGFuZCBydW4gb3VyIEphdmFTY3JpcHQgYnV0IEdPVi5VSyBGcm9udGVuZFxuICAgKiB3b24ndCBiZSBzdXBwb3J0ZWQuXG4gICAqXG4gICAqIEBwYXJhbSB7SFRNTEVsZW1lbnQgfCBudWxsfSBbJHNjb3BlXSAtIChpbnRlcm5hbCkgYDxib2R5PmAgSFRNTCBlbGVtZW50IGNoZWNrZWQgZm9yIGJyb3dzZXIgc3VwcG9ydFxuICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gV2hldGhlciBHT1YuVUsgRnJvbnRlbmQgaXMgc3VwcG9ydGVkIG9uIHRoaXMgcGFnZVxuICAgKi9cbiAgZnVuY3Rpb24gaXNTdXBwb3J0ZWQoJHNjb3BlID0gZG9jdW1lbnQuYm9keSkge1xuICAgIGlmICghJHNjb3BlKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiAkc2NvcGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdnb3Z1ay1mcm9udGVuZC1zdXBwb3J0ZWQnKTtcbiAgfVxuICBmdW5jdGlvbiB2YWxpZGF0ZUNvbmZpZyhzY2hlbWEsIGNvbmZpZykge1xuICAgIGNvbnN0IHZhbGlkYXRpb25FcnJvcnMgPSBbXTtcbiAgICBmb3IgKGNvbnN0IFtuYW1lLCBjb25kaXRpb25zXSBvZiBPYmplY3QuZW50cmllcyhzY2hlbWEpKSB7XG4gICAgICBjb25zdCBlcnJvcnMgPSBbXTtcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KGNvbmRpdGlvbnMpKSB7XG4gICAgICAgIGZvciAoY29uc3Qge1xuICAgICAgICAgIHJlcXVpcmVkLFxuICAgICAgICAgIGVycm9yTWVzc2FnZVxuICAgICAgICB9IG9mIGNvbmRpdGlvbnMpIHtcbiAgICAgICAgICBpZiAoIXJlcXVpcmVkLmV2ZXJ5KGtleSA9PiAhIWNvbmZpZ1trZXldKSkge1xuICAgICAgICAgICAgZXJyb3JzLnB1c2goZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG5hbWUgPT09ICdhbnlPZicgJiYgIShjb25kaXRpb25zLmxlbmd0aCAtIGVycm9ycy5sZW5ndGggPj0gMSkpIHtcbiAgICAgICAgICB2YWxpZGF0aW9uRXJyb3JzLnB1c2goLi4uZXJyb3JzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdmFsaWRhdGlvbkVycm9ycztcbiAgfVxuICBmdW5jdGlvbiBpc0FycmF5KG9wdGlvbikge1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KG9wdGlvbik7XG4gIH1cbiAgZnVuY3Rpb24gaXNPYmplY3Qob3B0aW9uKSB7XG4gICAgcmV0dXJuICEhb3B0aW9uICYmIHR5cGVvZiBvcHRpb24gPT09ICdvYmplY3QnICYmICFpc0FycmF5KG9wdGlvbik7XG4gIH1cbiAgZnVuY3Rpb24gZm9ybWF0RXJyb3JNZXNzYWdlKENvbXBvbmVudCwgbWVzc2FnZSkge1xuICAgIHJldHVybiBgJHtDb21wb25lbnQubW9kdWxlTmFtZX06ICR7bWVzc2FnZX1gO1xuICB9XG5cbiAgLyoqXG4gICAqIFNjaGVtYSBmb3IgY29tcG9uZW50IGNvbmZpZ1xuICAgKlxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBTY2hlbWFcbiAgICogQHByb3BlcnR5IHt7IFtmaWVsZDogc3RyaW5nXTogU2NoZW1hUHJvcGVydHkgfCB1bmRlZmluZWQgfX0gcHJvcGVydGllcyAtIFNjaGVtYSBwcm9wZXJ0aWVzXG4gICAqIEBwcm9wZXJ0eSB7U2NoZW1hQ29uZGl0aW9uW119IFthbnlPZl0gLSBMaXN0IG9mIHNjaGVtYSBjb25kaXRpb25zXG4gICAqL1xuXG4gIC8qKlxuICAgKiBTY2hlbWEgcHJvcGVydHkgZm9yIGNvbXBvbmVudCBjb25maWdcbiAgICpcbiAgICogQHR5cGVkZWYge29iamVjdH0gU2NoZW1hUHJvcGVydHlcbiAgICogQHByb3BlcnR5IHsnc3RyaW5nJyB8ICdib29sZWFuJyB8ICdudW1iZXInIHwgJ29iamVjdCd9IHR5cGUgLSBQcm9wZXJ0eSB0eXBlXG4gICAqL1xuXG4gIC8qKlxuICAgKiBTY2hlbWEgY29uZGl0aW9uIGZvciBjb21wb25lbnQgY29uZmlnXG4gICAqXG4gICAqIEB0eXBlZGVmIHtvYmplY3R9IFNjaGVtYUNvbmRpdGlvblxuICAgKiBAcHJvcGVydHkge3N0cmluZ1tdfSByZXF1aXJlZCAtIExpc3Qgb2YgcmVxdWlyZWQgY29uZmlnIGZpZWxkc1xuICAgKiBAcHJvcGVydHkge3N0cmluZ30gZXJyb3JNZXNzYWdlIC0gRXJyb3IgbWVzc2FnZSB3aGVuIHJlcXVpcmVkIGNvbmZpZyBmaWVsZHMgbm90IHByb3ZpZGVkXG4gICAqL1xuICAvKipcbiAgICogQHR5cGVkZWYgQ29tcG9uZW50V2l0aE1vZHVsZU5hbWVcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IG1vZHVsZU5hbWUgLSBOYW1lIG9mIHRoZSBjb21wb25lbnRcbiAgICovXG5cbiAgZnVuY3Rpb24gbm9ybWFsaXNlRGF0YXNldChDb21wb25lbnQsIGRhdGFzZXQpIHtcbiAgICBjb25zdCBvdXQgPSB7fTtcbiAgICBmb3IgKGNvbnN0IFtmaWVsZCwgcHJvcGVydHldIG9mIE9iamVjdC5lbnRyaWVzKENvbXBvbmVudC5zY2hlbWEucHJvcGVydGllcykpIHtcbiAgICAgIGlmIChmaWVsZCBpbiBkYXRhc2V0KSB7XG4gICAgICAgIG91dFtmaWVsZF0gPSBub3JtYWxpc2VTdHJpbmcoZGF0YXNldFtmaWVsZF0sIHByb3BlcnR5KTtcbiAgICAgIH1cbiAgICAgIGlmICgocHJvcGVydHkgPT0gbnVsbCA/IHZvaWQgMCA6IHByb3BlcnR5LnR5cGUpID09PSAnb2JqZWN0Jykge1xuICAgICAgICBvdXRbZmllbGRdID0gZXh0cmFjdENvbmZpZ0J5TmFtZXNwYWNlKENvbXBvbmVudCwgZGF0YXNldCwgZmllbGQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgY2xhc3MgR09WVUtGcm9udGVuZEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKC4uLmFyZ3MpIHtcbiAgICAgIHN1cGVyKC4uLmFyZ3MpO1xuICAgICAgdGhpcy5uYW1lID0gJ0dPVlVLRnJvbnRlbmRFcnJvcic7XG4gICAgfVxuICB9XG4gIGNsYXNzIFN1cHBvcnRFcnJvciBleHRlbmRzIEdPVlVLRnJvbnRlbmRFcnJvciB7XG4gICAgLyoqXG4gICAgICogQ2hlY2tzIGlmIEdPVi5VSyBGcm9udGVuZCBpcyBzdXBwb3J0ZWQgb24gdGhpcyBwYWdlXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50IHwgbnVsbH0gWyRzY29wZV0gLSBIVE1MIGVsZW1lbnQgYDxib2R5PmAgY2hlY2tlZCBmb3IgYnJvd3NlciBzdXBwb3J0XG4gICAgICovXG4gICAgY29uc3RydWN0b3IoJHNjb3BlID0gZG9jdW1lbnQuYm9keSkge1xuICAgICAgY29uc3Qgc3VwcG9ydE1lc3NhZ2UgPSAnbm9Nb2R1bGUnIGluIEhUTUxTY3JpcHRFbGVtZW50LnByb3RvdHlwZSA/ICdHT1YuVUsgRnJvbnRlbmQgaW5pdGlhbGlzZWQgd2l0aG91dCBgPGJvZHkgY2xhc3M9XCJnb3Z1ay1mcm9udGVuZC1zdXBwb3J0ZWRcIj5gIGZyb20gdGVtcGxhdGUgYDxzY3JpcHQ+YCBzbmlwcGV0JyA6ICdHT1YuVUsgRnJvbnRlbmQgaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXInO1xuICAgICAgc3VwZXIoJHNjb3BlID8gc3VwcG9ydE1lc3NhZ2UgOiAnR09WLlVLIEZyb250ZW5kIGluaXRpYWxpc2VkIHdpdGhvdXQgYDxzY3JpcHQgdHlwZT1cIm1vZHVsZVwiPmAnKTtcbiAgICAgIHRoaXMubmFtZSA9ICdTdXBwb3J0RXJyb3InO1xuICAgIH1cbiAgfVxuICBjbGFzcyBDb25maWdFcnJvciBleHRlbmRzIEdPVlVLRnJvbnRlbmRFcnJvciB7XG4gICAgY29uc3RydWN0b3IoLi4uYXJncykge1xuICAgICAgc3VwZXIoLi4uYXJncyk7XG4gICAgICB0aGlzLm5hbWUgPSAnQ29uZmlnRXJyb3InO1xuICAgIH1cbiAgfVxuICBjbGFzcyBFbGVtZW50RXJyb3IgZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kRXJyb3Ige1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2VPck9wdGlvbnMpIHtcbiAgICAgIGxldCBtZXNzYWdlID0gdHlwZW9mIG1lc3NhZ2VPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gbWVzc2FnZU9yT3B0aW9ucyA6ICcnO1xuICAgICAgaWYgKHR5cGVvZiBtZXNzYWdlT3JPcHRpb25zID09PSAnb2JqZWN0Jykge1xuICAgICAgICBjb25zdCB7XG4gICAgICAgICAgY29tcG9uZW50LFxuICAgICAgICAgIGlkZW50aWZpZXIsXG4gICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICBleHBlY3RlZFR5cGVcbiAgICAgICAgfSA9IG1lc3NhZ2VPck9wdGlvbnM7XG4gICAgICAgIG1lc3NhZ2UgPSBpZGVudGlmaWVyO1xuICAgICAgICBtZXNzYWdlICs9IGVsZW1lbnQgPyBgIGlzIG5vdCBvZiB0eXBlICR7ZXhwZWN0ZWRUeXBlICE9IG51bGwgPyBleHBlY3RlZFR5cGUgOiAnSFRNTEVsZW1lbnQnfWAgOiAnIG5vdCBmb3VuZCc7XG4gICAgICAgIG1lc3NhZ2UgPSBmb3JtYXRFcnJvck1lc3NhZ2UoY29tcG9uZW50LCBtZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgICAgdGhpcy5uYW1lID0gJ0VsZW1lbnRFcnJvcic7XG4gICAgfVxuICB9XG4gIGNsYXNzIEluaXRFcnJvciBleHRlbmRzIEdPVlVLRnJvbnRlbmRFcnJvciB7XG4gICAgY29uc3RydWN0b3IoY29tcG9uZW50T3JNZXNzYWdlKSB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gdHlwZW9mIGNvbXBvbmVudE9yTWVzc2FnZSA9PT0gJ3N0cmluZycgPyBjb21wb25lbnRPck1lc3NhZ2UgOiBmb3JtYXRFcnJvck1lc3NhZ2UoY29tcG9uZW50T3JNZXNzYWdlLCBgUm9vdCBlbGVtZW50IChcXGAkcm9vdFxcYCkgYWxyZWFkeSBpbml0aWFsaXNlZGApO1xuICAgICAgc3VwZXIobWVzc2FnZSk7XG4gICAgICB0aGlzLm5hbWUgPSAnSW5pdEVycm9yJztcbiAgICB9XG4gIH1cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uL2NvbW1vbi9pbmRleC5tanMnKS5Db21wb25lbnRXaXRoTW9kdWxlTmFtZX0gQ29tcG9uZW50V2l0aE1vZHVsZU5hbWVcbiAgICovXG5cbiAgY2xhc3MgR09WVUtGcm9udGVuZENvbXBvbmVudCB7XG4gICAgLyoqXG4gICAgICogUmV0dXJucyB0aGUgcm9vdCBlbGVtZW50IG9mIHRoZSBjb21wb25lbnRcbiAgICAgKlxuICAgICAqIEBwcm90ZWN0ZWRcbiAgICAgKiBAcmV0dXJucyB7Um9vdEVsZW1lbnRUeXBlfSAtIHRoZSByb290IGVsZW1lbnQgb2YgY29tcG9uZW50XG4gICAgICovXG4gICAgZ2V0ICRyb290KCkge1xuICAgICAgcmV0dXJuIHRoaXMuXyRyb290O1xuICAgIH1cbiAgICBjb25zdHJ1Y3Rvcigkcm9vdCkge1xuICAgICAgdGhpcy5fJHJvb3QgPSB2b2lkIDA7XG4gICAgICBjb25zdCBjaGlsZENvbnN0cnVjdG9yID0gdGhpcy5jb25zdHJ1Y3RvcjtcbiAgICAgIGlmICh0eXBlb2YgY2hpbGRDb25zdHJ1Y3Rvci5tb2R1bGVOYW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgSW5pdEVycm9yKGBcXGBtb2R1bGVOYW1lXFxgIG5vdCBkZWZpbmVkIGluIGNvbXBvbmVudGApO1xuICAgICAgfVxuICAgICAgaWYgKCEoJHJvb3QgaW5zdGFuY2VvZiBjaGlsZENvbnN0cnVjdG9yLmVsZW1lbnRUeXBlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBlbGVtZW50OiAkcm9vdCxcbiAgICAgICAgICBjb21wb25lbnQ6IGNoaWxkQ29uc3RydWN0b3IsXG4gICAgICAgICAgaWRlbnRpZmllcjogJ1Jvb3QgZWxlbWVudCAoYCRyb290YCknLFxuICAgICAgICAgIGV4cGVjdGVkVHlwZTogY2hpbGRDb25zdHJ1Y3Rvci5lbGVtZW50VHlwZS5uYW1lXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fJHJvb3QgPSAkcm9vdDtcbiAgICAgIH1cbiAgICAgIGNoaWxkQ29uc3RydWN0b3IuY2hlY2tTdXBwb3J0KCk7XG4gICAgICB0aGlzLmNoZWNrSW5pdGlhbGlzZWQoKTtcbiAgICAgIGNvbnN0IG1vZHVsZU5hbWUgPSBjaGlsZENvbnN0cnVjdG9yLm1vZHVsZU5hbWU7XG4gICAgICB0aGlzLiRyb290LnNldEF0dHJpYnV0ZShgZGF0YS0ke21vZHVsZU5hbWV9LWluaXRgLCAnJyk7XG4gICAgfVxuICAgIGNoZWNrSW5pdGlhbGlzZWQoKSB7XG4gICAgICBjb25zdCBjb25zdHJ1Y3RvciA9IHRoaXMuY29uc3RydWN0b3I7XG4gICAgICBjb25zdCBtb2R1bGVOYW1lID0gY29uc3RydWN0b3IubW9kdWxlTmFtZTtcbiAgICAgIGlmIChtb2R1bGVOYW1lICYmIGlzSW5pdGlhbGlzZWQodGhpcy4kcm9vdCwgbW9kdWxlTmFtZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEluaXRFcnJvcihjb25zdHJ1Y3Rvcik7XG4gICAgICB9XG4gICAgfVxuICAgIHN0YXRpYyBjaGVja1N1cHBvcnQoKSB7XG4gICAgICBpZiAoIWlzU3VwcG9ydGVkKCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFN1cHBvcnRFcnJvcigpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiBDaGlsZENsYXNzXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBtb2R1bGVOYW1lIC0gVGhlIG1vZHVsZSBuYW1lIHRoYXQnbGwgYmUgbG9va2VkIGZvciBpbiB0aGUgRE9NIHdoZW4gaW5pdGlhbGlzaW5nIHRoZSBjb21wb25lbnRcbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHt0eXBlb2YgR09WVUtGcm9udGVuZENvbXBvbmVudCAmIENoaWxkQ2xhc3N9IENoaWxkQ2xhc3NDb25zdHJ1Y3RvclxuICAgKi9cbiAgR09WVUtGcm9udGVuZENvbXBvbmVudC5lbGVtZW50VHlwZSA9IEhUTUxFbGVtZW50O1xuXG4gIGNsYXNzIEkxOG4ge1xuICAgIGNvbnN0cnVjdG9yKHRyYW5zbGF0aW9ucyA9IHt9LCBjb25maWcgPSB7fSkge1xuICAgICAgdmFyIF9jb25maWckbG9jYWxlO1xuICAgICAgdGhpcy50cmFuc2xhdGlvbnMgPSB2b2lkIDA7XG4gICAgICB0aGlzLmxvY2FsZSA9IHZvaWQgMDtcbiAgICAgIHRoaXMudHJhbnNsYXRpb25zID0gdHJhbnNsYXRpb25zO1xuICAgICAgdGhpcy5sb2NhbGUgPSAoX2NvbmZpZyRsb2NhbGUgPSBjb25maWcubG9jYWxlKSAhPSBudWxsID8gX2NvbmZpZyRsb2NhbGUgOiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZyB8fCAnZW4nO1xuICAgIH1cbiAgICB0KGxvb2t1cEtleSwgb3B0aW9ucykge1xuICAgICAgaWYgKCFsb29rdXBLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpMThuOiBsb29rdXAga2V5IG1pc3NpbmcnKTtcbiAgICAgIH1cbiAgICAgIGxldCB0cmFuc2xhdGlvbiA9IHRoaXMudHJhbnNsYXRpb25zW2xvb2t1cEtleV07XG4gICAgICBpZiAodHlwZW9mIChvcHRpb25zID09IG51bGwgPyB2b2lkIDAgOiBvcHRpb25zLmNvdW50KSA9PT0gJ251bWJlcicgJiYgdHlwZW9mIHRyYW5zbGF0aW9uID09PSAnb2JqZWN0Jykge1xuICAgICAgICBjb25zdCB0cmFuc2xhdGlvblBsdXJhbEZvcm0gPSB0cmFuc2xhdGlvblt0aGlzLmdldFBsdXJhbFN1ZmZpeChsb29rdXBLZXksIG9wdGlvbnMuY291bnQpXTtcbiAgICAgICAgaWYgKHRyYW5zbGF0aW9uUGx1cmFsRm9ybSkge1xuICAgICAgICAgIHRyYW5zbGF0aW9uID0gdHJhbnNsYXRpb25QbHVyYWxGb3JtO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBpZiAodHlwZW9mIHRyYW5zbGF0aW9uID09PSAnc3RyaW5nJykge1xuICAgICAgICBpZiAodHJhbnNsYXRpb24ubWF0Y2goLyV7KC5cXFMrKX0vKSkge1xuICAgICAgICAgIGlmICghb3B0aW9ucykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdpMThuOiBjYW5ub3QgcmVwbGFjZSBwbGFjZWhvbGRlcnMgaW4gc3RyaW5nIGlmIG5vIG9wdGlvbiBkYXRhIHByb3ZpZGVkJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0aGlzLnJlcGxhY2VQbGFjZWhvbGRlcnModHJhbnNsYXRpb24sIG9wdGlvbnMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cmFuc2xhdGlvbjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBsb29rdXBLZXk7XG4gICAgfVxuICAgIHJlcGxhY2VQbGFjZWhvbGRlcnModHJhbnNsYXRpb25TdHJpbmcsIG9wdGlvbnMpIHtcbiAgICAgIGNvbnN0IGZvcm1hdHRlciA9IEludGwuTnVtYmVyRm9ybWF0LnN1cHBvcnRlZExvY2FsZXNPZih0aGlzLmxvY2FsZSkubGVuZ3RoID8gbmV3IEludGwuTnVtYmVyRm9ybWF0KHRoaXMubG9jYWxlKSA6IHVuZGVmaW5lZDtcbiAgICAgIHJldHVybiB0cmFuc2xhdGlvblN0cmluZy5yZXBsYWNlKC8leyguXFxTKyl9L2csIGZ1bmN0aW9uIChwbGFjZWhvbGRlcldpdGhCcmFjZXMsIHBsYWNlaG9sZGVyS2V5KSB7XG4gICAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob3B0aW9ucywgcGxhY2Vob2xkZXJLZXkpKSB7XG4gICAgICAgICAgY29uc3QgcGxhY2Vob2xkZXJWYWx1ZSA9IG9wdGlvbnNbcGxhY2Vob2xkZXJLZXldO1xuICAgICAgICAgIGlmIChwbGFjZWhvbGRlclZhbHVlID09PSBmYWxzZSB8fCB0eXBlb2YgcGxhY2Vob2xkZXJWYWx1ZSAhPT0gJ251bWJlcicgJiYgdHlwZW9mIHBsYWNlaG9sZGVyVmFsdWUgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICByZXR1cm4gJyc7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0eXBlb2YgcGxhY2Vob2xkZXJWYWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZXIgPyBmb3JtYXR0ZXIuZm9ybWF0KHBsYWNlaG9sZGVyVmFsdWUpIDogYCR7cGxhY2Vob2xkZXJWYWx1ZX1gO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gcGxhY2Vob2xkZXJWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYGkxOG46IG5vIGRhdGEgZm91bmQgdG8gcmVwbGFjZSAke3BsYWNlaG9sZGVyV2l0aEJyYWNlc30gcGxhY2Vob2xkZXIgaW4gc3RyaW5nYCk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgaGFzSW50bFBsdXJhbFJ1bGVzU3VwcG9ydCgpIHtcbiAgICAgIHJldHVybiBCb29sZWFuKCdQbHVyYWxSdWxlcycgaW4gd2luZG93LkludGwgJiYgSW50bC5QbHVyYWxSdWxlcy5zdXBwb3J0ZWRMb2NhbGVzT2YodGhpcy5sb2NhbGUpLmxlbmd0aCk7XG4gICAgfVxuICAgIGdldFBsdXJhbFN1ZmZpeChsb29rdXBLZXksIGNvdW50KSB7XG4gICAgICBjb3VudCA9IE51bWJlcihjb3VudCk7XG4gICAgICBpZiAoIWlzRmluaXRlKGNvdW50KSkge1xuICAgICAgICByZXR1cm4gJ290aGVyJztcbiAgICAgIH1cbiAgICAgIGNvbnN0IHRyYW5zbGF0aW9uID0gdGhpcy50cmFuc2xhdGlvbnNbbG9va3VwS2V5XTtcbiAgICAgIGNvbnN0IHByZWZlcnJlZEZvcm0gPSB0aGlzLmhhc0ludGxQbHVyYWxSdWxlc1N1cHBvcnQoKSA/IG5ldyBJbnRsLlBsdXJhbFJ1bGVzKHRoaXMubG9jYWxlKS5zZWxlY3QoY291bnQpIDogdGhpcy5zZWxlY3RQbHVyYWxGb3JtVXNpbmdGYWxsYmFja1J1bGVzKGNvdW50KTtcbiAgICAgIGlmICh0eXBlb2YgdHJhbnNsYXRpb24gPT09ICdvYmplY3QnKSB7XG4gICAgICAgIGlmIChwcmVmZXJyZWRGb3JtIGluIHRyYW5zbGF0aW9uKSB7XG4gICAgICAgICAgcmV0dXJuIHByZWZlcnJlZEZvcm07XG4gICAgICAgIH0gZWxzZSBpZiAoJ290aGVyJyBpbiB0cmFuc2xhdGlvbikge1xuICAgICAgICAgIGNvbnNvbGUud2FybihgaTE4bjogTWlzc2luZyBwbHVyYWwgZm9ybSBcIi4ke3ByZWZlcnJlZEZvcm19XCIgZm9yIFwiJHt0aGlzLmxvY2FsZX1cIiBsb2NhbGUuIEZhbGxpbmcgYmFjayB0byBcIi5vdGhlclwiLmApO1xuICAgICAgICAgIHJldHVybiAnb3RoZXInO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYGkxOG46IFBsdXJhbCBmb3JtIFwiLm90aGVyXCIgaXMgcmVxdWlyZWQgZm9yIFwiJHt0aGlzLmxvY2FsZX1cIiBsb2NhbGVgKTtcbiAgICB9XG4gICAgc2VsZWN0UGx1cmFsRm9ybVVzaW5nRmFsbGJhY2tSdWxlcyhjb3VudCkge1xuICAgICAgY291bnQgPSBNYXRoLmFicyhNYXRoLmZsb29yKGNvdW50KSk7XG4gICAgICBjb25zdCBydWxlc2V0ID0gdGhpcy5nZXRQbHVyYWxSdWxlc0ZvckxvY2FsZSgpO1xuICAgICAgaWYgKHJ1bGVzZXQpIHtcbiAgICAgICAgcmV0dXJuIEkxOG4ucGx1cmFsUnVsZXNbcnVsZXNldF0oY291bnQpO1xuICAgICAgfVxuICAgICAgcmV0dXJuICdvdGhlcic7XG4gICAgfVxuICAgIGdldFBsdXJhbFJ1bGVzRm9yTG9jYWxlKCkge1xuICAgICAgY29uc3QgbG9jYWxlU2hvcnQgPSB0aGlzLmxvY2FsZS5zcGxpdCgnLScpWzBdO1xuICAgICAgZm9yIChjb25zdCBwbHVyYWxSdWxlIGluIEkxOG4ucGx1cmFsUnVsZXNNYXApIHtcbiAgICAgICAgY29uc3QgbGFuZ3VhZ2VzID0gSTE4bi5wbHVyYWxSdWxlc01hcFtwbHVyYWxSdWxlXTtcbiAgICAgICAgaWYgKGxhbmd1YWdlcy5pbmNsdWRlcyh0aGlzLmxvY2FsZSkgfHwgbGFuZ3VhZ2VzLmluY2x1ZGVzKGxvY2FsZVNob3J0KSkge1xuICAgICAgICAgIHJldHVybiBwbHVyYWxSdWxlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG4gIEkxOG4ucGx1cmFsUnVsZXNNYXAgPSB7XG4gICAgYXJhYmljOiBbJ2FyJ10sXG4gICAgY2hpbmVzZTogWydteScsICd6aCcsICdpZCcsICdqYScsICdqdicsICdrbycsICdtcycsICd0aCcsICd2aSddLFxuICAgIGZyZW5jaDogWydoeScsICdibicsICdmcicsICdndScsICdoaScsICdmYScsICdwYScsICd6dSddLFxuICAgIGdlcm1hbjogWydhZicsICdzcScsICdheicsICdldScsICdiZycsICdjYScsICdkYScsICdubCcsICdlbicsICdldCcsICdmaScsICdrYScsICdkZScsICdlbCcsICdodScsICdsYicsICdubycsICdzbycsICdzdycsICdzdicsICd0YScsICd0ZScsICd0cicsICd1ciddLFxuICAgIGlyaXNoOiBbJ2dhJ10sXG4gICAgcnVzc2lhbjogWydydScsICd1ayddLFxuICAgIHNjb3R0aXNoOiBbJ2dkJ10sXG4gICAgc3BhbmlzaDogWydwdC1QVCcsICdpdCcsICdlcyddLFxuICAgIHdlbHNoOiBbJ2N5J11cbiAgfTtcbiAgSTE4bi5wbHVyYWxSdWxlcyA9IHtcbiAgICBhcmFiaWMobikge1xuICAgICAgaWYgKG4gPT09IDApIHtcbiAgICAgICAgcmV0dXJuICd6ZXJvJztcbiAgICAgIH1cbiAgICAgIGlmIChuID09PSAxKSB7XG4gICAgICAgIHJldHVybiAnb25lJztcbiAgICAgIH1cbiAgICAgIGlmIChuID09PSAyKSB7XG4gICAgICAgIHJldHVybiAndHdvJztcbiAgICAgIH1cbiAgICAgIGlmIChuICUgMTAwID49IDMgJiYgbiAlIDEwMCA8PSAxMCkge1xuICAgICAgICByZXR1cm4gJ2Zldyc7XG4gICAgICB9XG4gICAgICBpZiAobiAlIDEwMCA+PSAxMSAmJiBuICUgMTAwIDw9IDk5KSB7XG4gICAgICAgIHJldHVybiAnbWFueSc7XG4gICAgICB9XG4gICAgICByZXR1cm4gJ290aGVyJztcbiAgICB9LFxuICAgIGNoaW5lc2UoKSB7XG4gICAgICByZXR1cm4gJ290aGVyJztcbiAgICB9LFxuICAgIGZyZW5jaChuKSB7XG4gICAgICByZXR1cm4gbiA9PT0gMCB8fCBuID09PSAxID8gJ29uZScgOiAnb3RoZXInO1xuICAgIH0sXG4gICAgZ2VybWFuKG4pIHtcbiAgICAgIHJldHVybiBuID09PSAxID8gJ29uZScgOiAnb3RoZXInO1xuICAgIH0sXG4gICAgaXJpc2gobikge1xuICAgICAgaWYgKG4gPT09IDEpIHtcbiAgICAgICAgcmV0dXJuICdvbmUnO1xuICAgICAgfVxuICAgICAgaWYgKG4gPT09IDIpIHtcbiAgICAgICAgcmV0dXJuICd0d28nO1xuICAgICAgfVxuICAgICAgaWYgKG4gPj0gMyAmJiBuIDw9IDYpIHtcbiAgICAgICAgcmV0dXJuICdmZXcnO1xuICAgICAgfVxuICAgICAgaWYgKG4gPj0gNyAmJiBuIDw9IDEwKSB7XG4gICAgICAgIHJldHVybiAnbWFueSc7XG4gICAgICB9XG4gICAgICByZXR1cm4gJ290aGVyJztcbiAgICB9LFxuICAgIHJ1c3NpYW4obikge1xuICAgICAgY29uc3QgbGFzdFR3byA9IG4gJSAxMDA7XG4gICAgICBjb25zdCBsYXN0ID0gbGFzdFR3byAlIDEwO1xuICAgICAgaWYgKGxhc3QgPT09IDEgJiYgbGFzdFR3byAhPT0gMTEpIHtcbiAgICAgICAgcmV0dXJuICdvbmUnO1xuICAgICAgfVxuICAgICAgaWYgKGxhc3QgPj0gMiAmJiBsYXN0IDw9IDQgJiYgIShsYXN0VHdvID49IDEyICYmIGxhc3RUd28gPD0gMTQpKSB7XG4gICAgICAgIHJldHVybiAnZmV3JztcbiAgICAgIH1cbiAgICAgIGlmIChsYXN0ID09PSAwIHx8IGxhc3QgPj0gNSAmJiBsYXN0IDw9IDkgfHwgbGFzdFR3byA+PSAxMSAmJiBsYXN0VHdvIDw9IDE0KSB7XG4gICAgICAgIHJldHVybiAnbWFueSc7XG4gICAgICB9XG4gICAgICByZXR1cm4gJ290aGVyJztcbiAgICB9LFxuICAgIHNjb3R0aXNoKG4pIHtcbiAgICAgIGlmIChuID09PSAxIHx8IG4gPT09IDExKSB7XG4gICAgICAgIHJldHVybiAnb25lJztcbiAgICAgIH1cbiAgICAgIGlmIChuID09PSAyIHx8IG4gPT09IDEyKSB7XG4gICAgICAgIHJldHVybiAndHdvJztcbiAgICAgIH1cbiAgICAgIGlmIChuID49IDMgJiYgbiA8PSAxMCB8fCBuID49IDEzICYmIG4gPD0gMTkpIHtcbiAgICAgICAgcmV0dXJuICdmZXcnO1xuICAgICAgfVxuICAgICAgcmV0dXJuICdvdGhlcic7XG4gICAgfSxcbiAgICBzcGFuaXNoKG4pIHtcbiAgICAgIGlmIChuID09PSAxKSB7XG4gICAgICAgIHJldHVybiAnb25lJztcbiAgICAgIH1cbiAgICAgIGlmIChuICUgMTAwMDAwMCA9PT0gMCAmJiBuICE9PSAwKSB7XG4gICAgICAgIHJldHVybiAnbWFueSc7XG4gICAgICB9XG4gICAgICByZXR1cm4gJ290aGVyJztcbiAgICB9LFxuICAgIHdlbHNoKG4pIHtcbiAgICAgIGlmIChuID09PSAwKSB7XG4gICAgICAgIHJldHVybiAnemVybyc7XG4gICAgICB9XG4gICAgICBpZiAobiA9PT0gMSkge1xuICAgICAgICByZXR1cm4gJ29uZSc7XG4gICAgICB9XG4gICAgICBpZiAobiA9PT0gMikge1xuICAgICAgICByZXR1cm4gJ3R3byc7XG4gICAgICB9XG4gICAgICBpZiAobiA9PT0gMykge1xuICAgICAgICByZXR1cm4gJ2Zldyc7XG4gICAgICB9XG4gICAgICBpZiAobiA9PT0gNikge1xuICAgICAgICByZXR1cm4gJ21hbnknO1xuICAgICAgfVxuICAgICAgcmV0dXJuICdvdGhlcic7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBBY2NvcmRpb24gY29tcG9uZW50XG4gICAqXG4gICAqIFRoaXMgYWxsb3dzIGEgY29sbGVjdGlvbiBvZiBzZWN0aW9ucyB0byBiZSBjb2xsYXBzZWQgYnkgZGVmYXVsdCwgc2hvd2luZyBvbmx5XG4gICAqIHRoZWlyIGhlYWRlcnMuIFNlY3Rpb25zIGNhbiBiZSBleHBhbmRlZCBvciBjb2xsYXBzZWQgaW5kaXZpZHVhbGx5IGJ5IGNsaWNraW5nXG4gICAqIHRoZWlyIGhlYWRlcnMuIEEgXCJTaG93IGFsbCBzZWN0aW9uc1wiIGJ1dHRvbiBpcyBhbHNvIGFkZGVkIHRvIHRoZSB0b3Agb2YgdGhlXG4gICAqIGFjY29yZGlvbiwgd2hpY2ggc3dpdGNoZXMgdG8gXCJIaWRlIGFsbCBzZWN0aW9uc1wiIHdoZW4gYWxsIHRoZSBzZWN0aW9ucyBhcmVcbiAgICogZXhwYW5kZWQuXG4gICAqXG4gICAqIFRoZSBzdGF0ZSBvZiBlYWNoIHNlY3Rpb24gaXMgc2F2ZWQgdG8gdGhlIERPTSB2aWEgdGhlIGBhcmlhLWV4cGFuZGVkYFxuICAgKiBhdHRyaWJ1dGUsIHdoaWNoIGFsc28gcHJvdmlkZXMgYWNjZXNzaWJpbGl0eS5cbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBBY2NvcmRpb24gZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGFjY29yZGlvblxuICAgICAqIEBwYXJhbSB7QWNjb3JkaW9uQ29uZmlnfSBbY29uZmlnXSAtIEFjY29yZGlvbiBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcigkcm9vdCwgY29uZmlnID0ge30pIHtcbiAgICAgIHN1cGVyKCRyb290KTtcbiAgICAgIHRoaXMuY29uZmlnID0gdm9pZCAwO1xuICAgICAgdGhpcy5pMThuID0gdm9pZCAwO1xuICAgICAgdGhpcy5jb250cm9sc0NsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fY29udHJvbHMnO1xuICAgICAgdGhpcy5zaG93QWxsQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zaG93LWFsbCc7XG4gICAgICB0aGlzLnNob3dBbGxUZXh0Q2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zaG93LWFsbC10ZXh0JztcbiAgICAgIHRoaXMuc2VjdGlvbkNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbic7XG4gICAgICB0aGlzLnNlY3Rpb25FeHBhbmRlZENsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi0tZXhwYW5kZWQnO1xuICAgICAgdGhpcy5zZWN0aW9uQnV0dG9uQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLWJ1dHRvbic7XG4gICAgICB0aGlzLnNlY3Rpb25IZWFkZXJDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGVyJztcbiAgICAgIHRoaXMuc2VjdGlvbkhlYWRpbmdDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGluZyc7XG4gICAgICB0aGlzLnNlY3Rpb25IZWFkaW5nRGl2aWRlckNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1oZWFkaW5nLWRpdmlkZXInO1xuICAgICAgdGhpcy5zZWN0aW9uSGVhZGluZ1RleHRDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGluZy10ZXh0JztcbiAgICAgIHRoaXMuc2VjdGlvbkhlYWRpbmdUZXh0Rm9jdXNDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24taGVhZGluZy10ZXh0LWZvY3VzJztcbiAgICAgIHRoaXMuc2VjdGlvblNob3dIaWRlVG9nZ2xlQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLXRvZ2dsZSc7XG4gICAgICB0aGlzLnNlY3Rpb25TaG93SGlkZVRvZ2dsZUZvY3VzQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uX19zZWN0aW9uLXRvZ2dsZS1mb2N1cyc7XG4gICAgICB0aGlzLnNlY3Rpb25TaG93SGlkZVRleHRDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tdG9nZ2xlLXRleHQnO1xuICAgICAgdGhpcy51cENoZXZyb25JY29uQ2xhc3MgPSAnZ292dWstYWNjb3JkaW9uLW5hdl9fY2hldnJvbic7XG4gICAgICB0aGlzLmRvd25DaGV2cm9uSWNvbkNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbi1uYXZfX2NoZXZyb24tLWRvd24nO1xuICAgICAgdGhpcy5zZWN0aW9uU3VtbWFyeUNsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1zdW1tYXJ5JztcbiAgICAgIHRoaXMuc2VjdGlvblN1bW1hcnlGb2N1c0NsYXNzID0gJ2dvdnVrLWFjY29yZGlvbl9fc2VjdGlvbi1zdW1tYXJ5LWZvY3VzJztcbiAgICAgIHRoaXMuc2VjdGlvbkNvbnRlbnRDbGFzcyA9ICdnb3Z1ay1hY2NvcmRpb25fX3NlY3Rpb24tY29udGVudCc7XG4gICAgICB0aGlzLiRzZWN0aW9ucyA9IHZvaWQgMDtcbiAgICAgIHRoaXMuJHNob3dBbGxCdXR0b24gPSBudWxsO1xuICAgICAgdGhpcy4kc2hvd0FsbEljb24gPSBudWxsO1xuICAgICAgdGhpcy4kc2hvd0FsbFRleHQgPSBudWxsO1xuICAgICAgdGhpcy5jb25maWcgPSBtZXJnZUNvbmZpZ3MoQWNjb3JkaW9uLmRlZmF1bHRzLCBjb25maWcsIG5vcm1hbGlzZURhdGFzZXQoQWNjb3JkaW9uLCB0aGlzLiRyb290LmRhdGFzZXQpKTtcbiAgICAgIHRoaXMuaTE4biA9IG5ldyBJMThuKHRoaXMuY29uZmlnLmkxOG4pO1xuICAgICAgY29uc3QgJHNlY3Rpb25zID0gdGhpcy4kcm9vdC5xdWVyeVNlbGVjdG9yQWxsKGAuJHt0aGlzLnNlY3Rpb25DbGFzc31gKTtcbiAgICAgIGlmICghJHNlY3Rpb25zLmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IEFjY29yZGlvbixcbiAgICAgICAgICBpZGVudGlmaWVyOiBgU2VjdGlvbnMgKFxcYDxkaXYgY2xhc3M9XCIke3RoaXMuc2VjdGlvbkNsYXNzfVwiPlxcYClgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy4kc2VjdGlvbnMgPSAkc2VjdGlvbnM7XG4gICAgICB0aGlzLmluaXRDb250cm9scygpO1xuICAgICAgdGhpcy5pbml0U2VjdGlvbkhlYWRlcnMoKTtcbiAgICAgIHRoaXMudXBkYXRlU2hvd0FsbEJ1dHRvbih0aGlzLmFyZUFsbFNlY3Rpb25zT3BlbigpKTtcbiAgICB9XG4gICAgaW5pdENvbnRyb2xzKCkge1xuICAgICAgdGhpcy4kc2hvd0FsbEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgdGhpcy4kc2hvd0FsbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICB0aGlzLiRzaG93QWxsQnV0dG9uLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCB0aGlzLnNob3dBbGxDbGFzcyk7XG4gICAgICB0aGlzLiRzaG93QWxsQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICdmYWxzZScpO1xuICAgICAgdGhpcy4kc2hvd0FsbEljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICB0aGlzLiRzaG93QWxsSWNvbi5jbGFzc0xpc3QuYWRkKHRoaXMudXBDaGV2cm9uSWNvbkNsYXNzKTtcbiAgICAgIHRoaXMuJHNob3dBbGxCdXR0b24uYXBwZW5kQ2hpbGQodGhpcy4kc2hvd0FsbEljb24pO1xuICAgICAgY29uc3QgJGFjY29yZGlvbkNvbnRyb2xzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAkYWNjb3JkaW9uQ29udHJvbHMuc2V0QXR0cmlidXRlKCdjbGFzcycsIHRoaXMuY29udHJvbHNDbGFzcyk7XG4gICAgICAkYWNjb3JkaW9uQ29udHJvbHMuYXBwZW5kQ2hpbGQodGhpcy4kc2hvd0FsbEJ1dHRvbik7XG4gICAgICB0aGlzLiRyb290Lmluc2VydEJlZm9yZSgkYWNjb3JkaW9uQ29udHJvbHMsIHRoaXMuJHJvb3QuZmlyc3RDaGlsZCk7XG4gICAgICB0aGlzLiRzaG93QWxsVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIHRoaXMuJHNob3dBbGxUZXh0LmNsYXNzTGlzdC5hZGQodGhpcy5zaG93QWxsVGV4dENsYXNzKTtcbiAgICAgIHRoaXMuJHNob3dBbGxCdXR0b24uYXBwZW5kQ2hpbGQodGhpcy4kc2hvd0FsbFRleHQpO1xuICAgICAgdGhpcy4kc2hvd0FsbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMub25TaG93T3JIaWRlQWxsVG9nZ2xlKCkpO1xuICAgICAgaWYgKCdvbmJlZm9yZW1hdGNoJyBpbiBkb2N1bWVudCkge1xuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmVtYXRjaCcsIGV2ZW50ID0+IHRoaXMub25CZWZvcmVNYXRjaChldmVudCkpO1xuICAgICAgfVxuICAgIH1cbiAgICBpbml0U2VjdGlvbkhlYWRlcnMoKSB7XG4gICAgICB0aGlzLiRzZWN0aW9ucy5mb3JFYWNoKCgkc2VjdGlvbiwgaSkgPT4ge1xuICAgICAgICBjb25zdCAkaGVhZGVyID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5zZWN0aW9uSGVhZGVyQ2xhc3N9YCk7XG4gICAgICAgIGlmICghJGhlYWRlcikge1xuICAgICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3Ioe1xuICAgICAgICAgICAgY29tcG9uZW50OiBBY2NvcmRpb24sXG4gICAgICAgICAgICBpZGVudGlmaWVyOiBgU2VjdGlvbiBoZWFkZXJzIChcXGA8ZGl2IGNsYXNzPVwiJHt0aGlzLnNlY3Rpb25IZWFkZXJDbGFzc31cIj5cXGApYFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY29uc3RydWN0SGVhZGVyTWFya3VwKCRoZWFkZXIsIGkpO1xuICAgICAgICB0aGlzLnNldEV4cGFuZGVkKHRoaXMuaXNFeHBhbmRlZCgkc2VjdGlvbiksICRzZWN0aW9uKTtcbiAgICAgICAgJGhlYWRlci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMub25TZWN0aW9uVG9nZ2xlKCRzZWN0aW9uKSk7XG4gICAgICAgIHRoaXMuc2V0SW5pdGlhbFN0YXRlKCRzZWN0aW9uKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdHJ1Y3RIZWFkZXJNYXJrdXAoJGhlYWRlciwgaW5kZXgpIHtcbiAgICAgIGNvbnN0ICRzcGFuID0gJGhlYWRlci5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLnNlY3Rpb25CdXR0b25DbGFzc31gKTtcbiAgICAgIGNvbnN0ICRoZWFkaW5nID0gJGhlYWRlci5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLnNlY3Rpb25IZWFkaW5nQ2xhc3N9YCk7XG4gICAgICBjb25zdCAkc3VtbWFyeSA9ICRoZWFkZXIucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5zZWN0aW9uU3VtbWFyeUNsYXNzfWApO1xuICAgICAgaWYgKCEkaGVhZGluZykge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IEFjY29yZGlvbixcbiAgICAgICAgICBpZGVudGlmaWVyOiBgU2VjdGlvbiBoZWFkaW5nIChcXGAuJHt0aGlzLnNlY3Rpb25IZWFkaW5nQ2xhc3N9XFxgKWBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoISRzcGFuKSB7XG4gICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3Ioe1xuICAgICAgICAgIGNvbXBvbmVudDogQWNjb3JkaW9uLFxuICAgICAgICAgIGlkZW50aWZpZXI6IGBTZWN0aW9uIGJ1dHRvbiBwbGFjZWhvbGRlciAoXFxgPHNwYW4gY2xhc3M9XCIke3RoaXMuc2VjdGlvbkJ1dHRvbkNsYXNzfVwiPlxcYClgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgJGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICAgICAgJGJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAnYnV0dG9uJyk7XG4gICAgICAkYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIGAke3RoaXMuJHJvb3QuaWR9LWNvbnRlbnQtJHtpbmRleCArIDF9YCk7XG4gICAgICBmb3IgKGNvbnN0IGF0dHIgb2YgQXJyYXkuZnJvbSgkc3Bhbi5hdHRyaWJ1dGVzKSkge1xuICAgICAgICBpZiAoYXR0ci5uYW1lICE9PSAnaWQnKSB7XG4gICAgICAgICAgJGJ1dHRvbi5zZXRBdHRyaWJ1dGUoYXR0ci5uYW1lLCBhdHRyLnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgJGhlYWRpbmdUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgJGhlYWRpbmdUZXh0LmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uSGVhZGluZ1RleHRDbGFzcyk7XG4gICAgICAkaGVhZGluZ1RleHQuaWQgPSAkc3Bhbi5pZDtcbiAgICAgIGNvbnN0ICRoZWFkaW5nVGV4dEZvY3VzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgJGhlYWRpbmdUZXh0Rm9jdXMuY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25IZWFkaW5nVGV4dEZvY3VzQ2xhc3MpO1xuICAgICAgJGhlYWRpbmdUZXh0LmFwcGVuZENoaWxkKCRoZWFkaW5nVGV4dEZvY3VzKTtcbiAgICAgIEFycmF5LmZyb20oJHNwYW4uY2hpbGROb2RlcykuZm9yRWFjaCgkY2hpbGQgPT4gJGhlYWRpbmdUZXh0Rm9jdXMuYXBwZW5kQ2hpbGQoJGNoaWxkKSk7XG4gICAgICBjb25zdCAkc2hvd0hpZGVUb2dnbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAkc2hvd0hpZGVUb2dnbGUuY2xhc3NMaXN0LmFkZCh0aGlzLnNlY3Rpb25TaG93SGlkZVRvZ2dsZUNsYXNzKTtcbiAgICAgICRzaG93SGlkZVRvZ2dsZS5zZXRBdHRyaWJ1dGUoJ2RhdGEtbm9zbmlwcGV0JywgJycpO1xuICAgICAgY29uc3QgJHNob3dIaWRlVG9nZ2xlRm9jdXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAkc2hvd0hpZGVUb2dnbGVGb2N1cy5jbGFzc0xpc3QuYWRkKHRoaXMuc2VjdGlvblNob3dIaWRlVG9nZ2xlRm9jdXNDbGFzcyk7XG4gICAgICAkc2hvd0hpZGVUb2dnbGUuYXBwZW5kQ2hpbGQoJHNob3dIaWRlVG9nZ2xlRm9jdXMpO1xuICAgICAgY29uc3QgJHNob3dIaWRlVGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIGNvbnN0ICRzaG93SGlkZUljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAkc2hvd0hpZGVJY29uLmNsYXNzTGlzdC5hZGQodGhpcy51cENoZXZyb25JY29uQ2xhc3MpO1xuICAgICAgJHNob3dIaWRlVG9nZ2xlRm9jdXMuYXBwZW5kQ2hpbGQoJHNob3dIaWRlSWNvbik7XG4gICAgICAkc2hvd0hpZGVUZXh0LmNsYXNzTGlzdC5hZGQodGhpcy5zZWN0aW9uU2hvd0hpZGVUZXh0Q2xhc3MpO1xuICAgICAgJHNob3dIaWRlVG9nZ2xlRm9jdXMuYXBwZW5kQ2hpbGQoJHNob3dIaWRlVGV4dCk7XG4gICAgICAkYnV0dG9uLmFwcGVuZENoaWxkKCRoZWFkaW5nVGV4dCk7XG4gICAgICAkYnV0dG9uLmFwcGVuZENoaWxkKHRoaXMuZ2V0QnV0dG9uUHVuY3R1YXRpb25FbCgpKTtcbiAgICAgIGlmICgkc3VtbWFyeSkge1xuICAgICAgICBjb25zdCAkc3VtbWFyeVNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAgIGNvbnN0ICRzdW1tYXJ5U3BhbkZvY3VzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgICAgICAkc3VtbWFyeVNwYW5Gb2N1cy5jbGFzc0xpc3QuYWRkKHRoaXMuc2VjdGlvblN1bW1hcnlGb2N1c0NsYXNzKTtcbiAgICAgICAgJHN1bW1hcnlTcGFuLmFwcGVuZENoaWxkKCRzdW1tYXJ5U3BhbkZvY3VzKTtcbiAgICAgICAgZm9yIChjb25zdCBhdHRyIG9mIEFycmF5LmZyb20oJHN1bW1hcnkuYXR0cmlidXRlcykpIHtcbiAgICAgICAgICAkc3VtbWFyeVNwYW4uc2V0QXR0cmlidXRlKGF0dHIubmFtZSwgYXR0ci52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgQXJyYXkuZnJvbSgkc3VtbWFyeS5jaGlsZE5vZGVzKS5mb3JFYWNoKCRjaGlsZCA9PiAkc3VtbWFyeVNwYW5Gb2N1cy5hcHBlbmRDaGlsZCgkY2hpbGQpKTtcbiAgICAgICAgJHN1bW1hcnkucmVtb3ZlKCk7XG4gICAgICAgICRidXR0b24uYXBwZW5kQ2hpbGQoJHN1bW1hcnlTcGFuKTtcbiAgICAgICAgJGJ1dHRvbi5hcHBlbmRDaGlsZCh0aGlzLmdldEJ1dHRvblB1bmN0dWF0aW9uRWwoKSk7XG4gICAgICB9XG4gICAgICAkYnV0dG9uLmFwcGVuZENoaWxkKCRzaG93SGlkZVRvZ2dsZSk7XG4gICAgICAkaGVhZGluZy5yZW1vdmVDaGlsZCgkc3Bhbik7XG4gICAgICAkaGVhZGluZy5hcHBlbmRDaGlsZCgkYnV0dG9uKTtcbiAgICB9XG4gICAgb25CZWZvcmVNYXRjaChldmVudCkge1xuICAgICAgY29uc3QgJGZyYWdtZW50ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgaWYgKCEoJGZyYWdtZW50IGluc3RhbmNlb2YgRWxlbWVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgJHNlY3Rpb24gPSAkZnJhZ21lbnQuY2xvc2VzdChgLiR7dGhpcy5zZWN0aW9uQ2xhc3N9YCk7XG4gICAgICBpZiAoJHNlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5zZXRFeHBhbmRlZCh0cnVlLCAkc2VjdGlvbik7XG4gICAgICB9XG4gICAgfVxuICAgIG9uU2VjdGlvblRvZ2dsZSgkc2VjdGlvbikge1xuICAgICAgY29uc3Qgbm93RXhwYW5kZWQgPSAhdGhpcy5pc0V4cGFuZGVkKCRzZWN0aW9uKTtcbiAgICAgIHRoaXMuc2V0RXhwYW5kZWQobm93RXhwYW5kZWQsICRzZWN0aW9uKTtcbiAgICAgIHRoaXMuc3RvcmVTdGF0ZSgkc2VjdGlvbiwgbm93RXhwYW5kZWQpO1xuICAgIH1cbiAgICBvblNob3dPckhpZGVBbGxUb2dnbGUoKSB7XG4gICAgICBjb25zdCBub3dFeHBhbmRlZCA9ICF0aGlzLmFyZUFsbFNlY3Rpb25zT3BlbigpO1xuICAgICAgdGhpcy4kc2VjdGlvbnMuZm9yRWFjaCgkc2VjdGlvbiA9PiB7XG4gICAgICAgIHRoaXMuc2V0RXhwYW5kZWQobm93RXhwYW5kZWQsICRzZWN0aW9uKTtcbiAgICAgICAgdGhpcy5zdG9yZVN0YXRlKCRzZWN0aW9uLCBub3dFeHBhbmRlZCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMudXBkYXRlU2hvd0FsbEJ1dHRvbihub3dFeHBhbmRlZCk7XG4gICAgfVxuICAgIHNldEV4cGFuZGVkKGV4cGFuZGVkLCAkc2VjdGlvbikge1xuICAgICAgY29uc3QgJHNob3dIaWRlSWNvbiA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMudXBDaGV2cm9uSWNvbkNsYXNzfWApO1xuICAgICAgY29uc3QgJHNob3dIaWRlVGV4dCA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuc2VjdGlvblNob3dIaWRlVGV4dENsYXNzfWApO1xuICAgICAgY29uc3QgJGJ1dHRvbiA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuc2VjdGlvbkJ1dHRvbkNsYXNzfWApO1xuICAgICAgY29uc3QgJGNvbnRlbnQgPSAkc2VjdGlvbi5xdWVyeVNlbGVjdG9yKGAuJHt0aGlzLnNlY3Rpb25Db250ZW50Q2xhc3N9YCk7XG4gICAgICBpZiAoISRjb250ZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3Ioe1xuICAgICAgICAgIGNvbXBvbmVudDogQWNjb3JkaW9uLFxuICAgICAgICAgIGlkZW50aWZpZXI6IGBTZWN0aW9uIGNvbnRlbnQgKFxcYDxkaXYgY2xhc3M9XCIke3RoaXMuc2VjdGlvbkNvbnRlbnRDbGFzc31cIj5cXGApYFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICghJHNob3dIaWRlSWNvbiB8fCAhJHNob3dIaWRlVGV4dCB8fCAhJGJ1dHRvbikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBuZXdCdXR0b25UZXh0ID0gZXhwYW5kZWQgPyB0aGlzLmkxOG4udCgnaGlkZVNlY3Rpb24nKSA6IHRoaXMuaTE4bi50KCdzaG93U2VjdGlvbicpO1xuICAgICAgJHNob3dIaWRlVGV4dC50ZXh0Q29udGVudCA9IG5ld0J1dHRvblRleHQ7XG4gICAgICAkYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsIGAke2V4cGFuZGVkfWApO1xuICAgICAgY29uc3QgYXJpYUxhYmVsUGFydHMgPSBbXTtcbiAgICAgIGNvbnN0ICRoZWFkaW5nVGV4dCA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuc2VjdGlvbkhlYWRpbmdUZXh0Q2xhc3N9YCk7XG4gICAgICBpZiAoJGhlYWRpbmdUZXh0KSB7XG4gICAgICAgIGFyaWFMYWJlbFBhcnRzLnB1c2goYCR7JGhlYWRpbmdUZXh0LnRleHRDb250ZW50fWAudHJpbSgpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0ICRzdW1tYXJ5ID0gJHNlY3Rpb24ucXVlcnlTZWxlY3RvcihgLiR7dGhpcy5zZWN0aW9uU3VtbWFyeUNsYXNzfWApO1xuICAgICAgaWYgKCRzdW1tYXJ5KSB7XG4gICAgICAgIGFyaWFMYWJlbFBhcnRzLnB1c2goYCR7JHN1bW1hcnkudGV4dENvbnRlbnR9YC50cmltKCkpO1xuICAgICAgfVxuICAgICAgY29uc3QgYXJpYUxhYmVsTWVzc2FnZSA9IGV4cGFuZGVkID8gdGhpcy5pMThuLnQoJ2hpZGVTZWN0aW9uQXJpYUxhYmVsJykgOiB0aGlzLmkxOG4udCgnc2hvd1NlY3Rpb25BcmlhTGFiZWwnKTtcbiAgICAgIGFyaWFMYWJlbFBhcnRzLnB1c2goYXJpYUxhYmVsTWVzc2FnZSk7XG4gICAgICAkYnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGFyaWFMYWJlbFBhcnRzLmpvaW4oJyAsICcpKTtcbiAgICAgIGlmIChleHBhbmRlZCkge1xuICAgICAgICAkY29udGVudC5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgICAkc2VjdGlvbi5jbGFzc0xpc3QuYWRkKHRoaXMuc2VjdGlvbkV4cGFuZGVkQ2xhc3MpO1xuICAgICAgICAkc2hvd0hpZGVJY29uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5kb3duQ2hldnJvbkljb25DbGFzcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkY29udGVudC5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICd1bnRpbC1mb3VuZCcpO1xuICAgICAgICAkc2VjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuc2VjdGlvbkV4cGFuZGVkQ2xhc3MpO1xuICAgICAgICAkc2hvd0hpZGVJY29uLmNsYXNzTGlzdC5hZGQodGhpcy5kb3duQ2hldnJvbkljb25DbGFzcyk7XG4gICAgICB9XG4gICAgICB0aGlzLnVwZGF0ZVNob3dBbGxCdXR0b24odGhpcy5hcmVBbGxTZWN0aW9uc09wZW4oKSk7XG4gICAgfVxuICAgIGlzRXhwYW5kZWQoJHNlY3Rpb24pIHtcbiAgICAgIHJldHVybiAkc2VjdGlvbi5jbGFzc0xpc3QuY29udGFpbnModGhpcy5zZWN0aW9uRXhwYW5kZWRDbGFzcyk7XG4gICAgfVxuICAgIGFyZUFsbFNlY3Rpb25zT3BlbigpIHtcbiAgICAgIHJldHVybiBBcnJheS5mcm9tKHRoaXMuJHNlY3Rpb25zKS5ldmVyeSgkc2VjdGlvbiA9PiB0aGlzLmlzRXhwYW5kZWQoJHNlY3Rpb24pKTtcbiAgICB9XG4gICAgdXBkYXRlU2hvd0FsbEJ1dHRvbihleHBhbmRlZCkge1xuICAgICAgaWYgKCF0aGlzLiRzaG93QWxsQnV0dG9uIHx8ICF0aGlzLiRzaG93QWxsVGV4dCB8fCAhdGhpcy4kc2hvd0FsbEljb24pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy4kc2hvd0FsbEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBleHBhbmRlZC50b1N0cmluZygpKTtcbiAgICAgIHRoaXMuJHNob3dBbGxUZXh0LnRleHRDb250ZW50ID0gZXhwYW5kZWQgPyB0aGlzLmkxOG4udCgnaGlkZUFsbFNlY3Rpb25zJykgOiB0aGlzLmkxOG4udCgnc2hvd0FsbFNlY3Rpb25zJyk7XG4gICAgICB0aGlzLiRzaG93QWxsSWNvbi5jbGFzc0xpc3QudG9nZ2xlKHRoaXMuZG93bkNoZXZyb25JY29uQ2xhc3MsICFleHBhbmRlZCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogR2V0IHRoZSBpZGVudGlmaWVyIGZvciBhIHNlY3Rpb25cbiAgICAgKlxuICAgICAqIFdlIG5lZWQgYSB1bmlxdWUgd2F5IG9mIGlkZW50aWZ5aW5nIGVhY2ggY29udGVudCBpbiB0aGUgQWNjb3JkaW9uLlxuICAgICAqIFNpbmNlIGFuIGAjaWRgIHNob3VsZCBiZSB1bmlxdWUgYW5kIGFuIGBpZGAgaXMgcmVxdWlyZWQgZm9yIGBhcmlhLWBcbiAgICAgKiBhdHRyaWJ1dGVzIGBpZGAgY2FuIGJlIHNhZmVseSB1c2VkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtFbGVtZW50fSAkc2VjdGlvbiAtIFNlY3Rpb24gZWxlbWVudFxuICAgICAqIEByZXR1cm5zIHtzdHJpbmcgfCB1bmRlZmluZWQgfCBudWxsfSBJZGVudGlmaWVyIGZvciBzZWN0aW9uXG4gICAgICovXG4gICAgZ2V0SWRlbnRpZmllcigkc2VjdGlvbikge1xuICAgICAgY29uc3QgJGJ1dHRvbiA9ICRzZWN0aW9uLnF1ZXJ5U2VsZWN0b3IoYC4ke3RoaXMuc2VjdGlvbkJ1dHRvbkNsYXNzfWApO1xuICAgICAgcmV0dXJuICRidXR0b24gPT0gbnVsbCA/IHZvaWQgMCA6ICRidXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XG4gICAgfVxuICAgIHN0b3JlU3RhdGUoJHNlY3Rpb24sIGlzRXhwYW5kZWQpIHtcbiAgICAgIGlmICghdGhpcy5jb25maWcucmVtZW1iZXJFeHBhbmRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBpZCA9IHRoaXMuZ2V0SWRlbnRpZmllcigkc2VjdGlvbik7XG4gICAgICBpZiAoaWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICB3aW5kb3cuc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbShpZCwgaXNFeHBhbmRlZC50b1N0cmluZygpKTtcbiAgICAgICAgfSBjYXRjaCAoZXhjZXB0aW9uKSB7fVxuICAgICAgfVxuICAgIH1cbiAgICBzZXRJbml0aWFsU3RhdGUoJHNlY3Rpb24pIHtcbiAgICAgIGlmICghdGhpcy5jb25maWcucmVtZW1iZXJFeHBhbmRlZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBpZCA9IHRoaXMuZ2V0SWRlbnRpZmllcigkc2VjdGlvbik7XG4gICAgICBpZiAoaWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBzdGF0ZSA9IHdpbmRvdy5zZXNzaW9uU3RvcmFnZS5nZXRJdGVtKGlkKTtcbiAgICAgICAgICBpZiAoc3RhdGUgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0RXhwYW5kZWQoc3RhdGUgPT09ICd0cnVlJywgJHNlY3Rpb24pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXhjZXB0aW9uKSB7fVxuICAgICAgfVxuICAgIH1cbiAgICBnZXRCdXR0b25QdW5jdHVhdGlvbkVsKCkge1xuICAgICAgY29uc3QgJHB1bmN0dWF0aW9uRWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgICAkcHVuY3R1YXRpb25FbC5jbGFzc0xpc3QuYWRkKCdnb3Z1ay12aXN1YWxseS1oaWRkZW4nLCB0aGlzLnNlY3Rpb25IZWFkaW5nRGl2aWRlckNsYXNzKTtcbiAgICAgICRwdW5jdHVhdGlvbkVsLnRleHRDb250ZW50ID0gJywgJztcbiAgICAgIHJldHVybiAkcHVuY3R1YXRpb25FbDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWNjb3JkaW9uIGNvbmZpZ1xuICAgKlxuICAgKiBAc2VlIHtAbGluayBBY2NvcmRpb24uZGVmYXVsdHN9XG4gICAqIEB0eXBlZGVmIHtvYmplY3R9IEFjY29yZGlvbkNvbmZpZ1xuICAgKiBAcHJvcGVydHkge0FjY29yZGlvblRyYW5zbGF0aW9uc30gW2kxOG49QWNjb3JkaW9uLmRlZmF1bHRzLmkxOG5dIC0gQWNjb3JkaW9uIHRyYW5zbGF0aW9uc1xuICAgKiBAcHJvcGVydHkge2Jvb2xlYW59IFtyZW1lbWJlckV4cGFuZGVkXSAtIFdoZXRoZXIgdGhlIGV4cGFuZGVkIGFuZCBjb2xsYXBzZWRcbiAgICogICBzdGF0ZSBvZiBlYWNoIHNlY3Rpb24gaXMgcmVtZW1iZXJlZCBhbmQgcmVzdG9yZWQgd2hlbiBuYXZpZ2F0aW5nLlxuICAgKi9cblxuICAvKipcbiAgICogQWNjb3JkaW9uIHRyYW5zbGF0aW9uc1xuICAgKlxuICAgKiBAc2VlIHtAbGluayBBY2NvcmRpb24uZGVmYXVsdHMuaTE4bn1cbiAgICogQHR5cGVkZWYge29iamVjdH0gQWNjb3JkaW9uVHJhbnNsYXRpb25zXG4gICAqXG4gICAqIE1lc3NhZ2VzIHVzZWQgYnkgdGhlIGNvbXBvbmVudCBmb3IgdGhlIGxhYmVscyBvZiBpdHMgYnV0dG9ucy4gVGhpcyBpbmNsdWRlc1xuICAgKiB0aGUgdmlzaWJsZSB0ZXh0IHNob3duIG9uIHNjcmVlbiwgYW5kIHRleHQgdG8gaGVscCBhc3Npc3RpdmUgdGVjaG5vbG9neSB1c2Vyc1xuICAgKiBmb3IgdGhlIGJ1dHRvbnMgdG9nZ2xpbmcgZWFjaCBzZWN0aW9uLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW2hpZGVBbGxTZWN0aW9uc10gLSBUaGUgdGV4dCBjb250ZW50IGZvciB0aGUgJ0hpZGUgYWxsXG4gICAqICAgc2VjdGlvbnMnIGJ1dHRvbiwgdXNlZCB3aGVuIGF0IGxlYXN0IG9uZSBzZWN0aW9uIGlzIGV4cGFuZGVkLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW2hpZGVTZWN0aW9uXSAtIFRoZSB0ZXh0IGNvbnRlbnQgZm9yIHRoZSAnSGlkZSdcbiAgICogICBidXR0b24sIHVzZWQgd2hlbiBhIHNlY3Rpb24gaXMgZXhwYW5kZWQuXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbaGlkZVNlY3Rpb25BcmlhTGFiZWxdIC0gVGhlIHRleHQgY29udGVudCBhcHBlbmRlZCB0byB0aGVcbiAgICogICAnSGlkZScgYnV0dG9uJ3MgYWNjZXNzaWJsZSBuYW1lIHdoZW4gYSBzZWN0aW9uIGlzIGV4cGFuZGVkLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3Nob3dBbGxTZWN0aW9uc10gLSBUaGUgdGV4dCBjb250ZW50IGZvciB0aGUgJ1Nob3cgYWxsXG4gICAqICAgc2VjdGlvbnMnIGJ1dHRvbiwgdXNlZCB3aGVuIGFsbCBzZWN0aW9ucyBhcmUgY29sbGFwc2VkLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3Nob3dTZWN0aW9uXSAtIFRoZSB0ZXh0IGNvbnRlbnQgZm9yIHRoZSAnU2hvdydcbiAgICogICBidXR0b24sIHVzZWQgd2hlbiBhIHNlY3Rpb24gaXMgY29sbGFwc2VkLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3Nob3dTZWN0aW9uQXJpYUxhYmVsXSAtIFRoZSB0ZXh0IGNvbnRlbnQgYXBwZW5kZWQgdG8gdGhlXG4gICAqICAgJ1Nob3cnIGJ1dHRvbidzIGFjY2Vzc2libGUgbmFtZSB3aGVuIGEgc2VjdGlvbiBpcyBleHBhbmRlZC5cbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2NvbW1vbi9pbmRleC5tanMnKS5TY2hlbWF9IFNjaGVtYVxuICAgKi9cbiAgQWNjb3JkaW9uLm1vZHVsZU5hbWUgPSAnZ292dWstYWNjb3JkaW9uJztcbiAgQWNjb3JkaW9uLmRlZmF1bHRzID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgaTE4bjoge1xuICAgICAgaGlkZUFsbFNlY3Rpb25zOiAnSGlkZSBhbGwgc2VjdGlvbnMnLFxuICAgICAgaGlkZVNlY3Rpb246ICdIaWRlJyxcbiAgICAgIGhpZGVTZWN0aW9uQXJpYUxhYmVsOiAnSGlkZSB0aGlzIHNlY3Rpb24nLFxuICAgICAgc2hvd0FsbFNlY3Rpb25zOiAnU2hvdyBhbGwgc2VjdGlvbnMnLFxuICAgICAgc2hvd1NlY3Rpb246ICdTaG93JyxcbiAgICAgIHNob3dTZWN0aW9uQXJpYUxhYmVsOiAnU2hvdyB0aGlzIHNlY3Rpb24nXG4gICAgfSxcbiAgICByZW1lbWJlckV4cGFuZGVkOiB0cnVlXG4gIH0pO1xuICBBY2NvcmRpb24uc2NoZW1hID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgcHJvcGVydGllczoge1xuICAgICAgaTE4bjoge1xuICAgICAgICB0eXBlOiAnb2JqZWN0J1xuICAgICAgfSxcbiAgICAgIHJlbWVtYmVyRXhwYW5kZWQ6IHtcbiAgICAgICAgdHlwZTogJ2Jvb2xlYW4nXG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBERUJPVU5DRV9USU1FT1VUX0lOX1NFQ09ORFMgPSAxO1xuXG4gIC8qKlxuICAgKiBKYXZhU2NyaXB0IGVuaGFuY2VtZW50cyBmb3IgdGhlIEJ1dHRvbiBjb21wb25lbnRcbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBCdXR0b24gZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGJ1dHRvblxuICAgICAqIEBwYXJhbSB7QnV0dG9uQ29uZmlnfSBbY29uZmlnXSAtIEJ1dHRvbiBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcigkcm9vdCwgY29uZmlnID0ge30pIHtcbiAgICAgIHN1cGVyKCRyb290KTtcbiAgICAgIHRoaXMuY29uZmlnID0gdm9pZCAwO1xuICAgICAgdGhpcy5kZWJvdW5jZUZvcm1TdWJtaXRUaW1lciA9IG51bGw7XG4gICAgICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhCdXR0b24uZGVmYXVsdHMsIGNvbmZpZywgbm9ybWFsaXNlRGF0YXNldChCdXR0b24sIHRoaXMuJHJvb3QuZGF0YXNldCkpO1xuICAgICAgdGhpcy4kcm9vdC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZXZlbnQgPT4gdGhpcy5oYW5kbGVLZXlEb3duKGV2ZW50KSk7XG4gICAgICB0aGlzLiRyb290LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4gdGhpcy5kZWJvdW5jZShldmVudCkpO1xuICAgIH1cbiAgICBoYW5kbGVLZXlEb3duKGV2ZW50KSB7XG4gICAgICBjb25zdCAkdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgaWYgKGV2ZW50LmtleSAhPT0gJyAnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICgkdGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQgJiYgJHRhcmdldC5nZXRBdHRyaWJ1dGUoJ3JvbGUnKSA9PT0gJ2J1dHRvbicpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgJHRhcmdldC5jbGljaygpO1xuICAgICAgfVxuICAgIH1cbiAgICBkZWJvdW5jZShldmVudCkge1xuICAgICAgaWYgKCF0aGlzLmNvbmZpZy5wcmV2ZW50RG91YmxlQ2xpY2spIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMuZGVib3VuY2VGb3JtU3VibWl0VGltZXIpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhpcy5kZWJvdW5jZUZvcm1TdWJtaXRUaW1lciA9IHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdGhpcy5kZWJvdW5jZUZvcm1TdWJtaXRUaW1lciA9IG51bGw7XG4gICAgICB9LCBERUJPVU5DRV9USU1FT1VUX0lOX1NFQ09ORFMgKiAxMDAwKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQnV0dG9uIGNvbmZpZ1xuICAgKlxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBCdXR0b25Db25maWdcbiAgICogQHByb3BlcnR5IHtib29sZWFufSBbcHJldmVudERvdWJsZUNsaWNrPWZhbHNlXSAtIFByZXZlbnQgYWNjaWRlbnRhbCBkb3VibGVcbiAgICogICBjbGlja3Mgb24gc3VibWl0IGJ1dHRvbnMgZnJvbSBzdWJtaXR0aW5nIGZvcm1zIG11bHRpcGxlIHRpbWVzLlxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vY29tbW9uL2luZGV4Lm1qcycpLlNjaGVtYX0gU2NoZW1hXG4gICAqL1xuICBCdXR0b24ubW9kdWxlTmFtZSA9ICdnb3Z1ay1idXR0b24nO1xuICBCdXR0b24uZGVmYXVsdHMgPSBPYmplY3QuZnJlZXplKHtcbiAgICBwcmV2ZW50RG91YmxlQ2xpY2s6IGZhbHNlXG4gIH0pO1xuICBCdXR0b24uc2NoZW1hID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgcHJvcGVydGllczoge1xuICAgICAgcHJldmVudERvdWJsZUNsaWNrOiB7XG4gICAgICAgIHR5cGU6ICdib29sZWFuJ1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgZnVuY3Rpb24gY2xvc2VzdEF0dHJpYnV0ZVZhbHVlKCRlbGVtZW50LCBhdHRyaWJ1dGVOYW1lKSB7XG4gICAgY29uc3QgJGNsb3Nlc3RFbGVtZW50V2l0aEF0dHJpYnV0ZSA9ICRlbGVtZW50LmNsb3Nlc3QoYFske2F0dHJpYnV0ZU5hbWV9XWApO1xuICAgIHJldHVybiAkY2xvc2VzdEVsZW1lbnRXaXRoQXR0cmlidXRlID8gJGNsb3Nlc3RFbGVtZW50V2l0aEF0dHJpYnV0ZS5nZXRBdHRyaWJ1dGUoYXR0cmlidXRlTmFtZSkgOiBudWxsO1xuICB9XG5cbiAgLyoqXG4gICAqIENoYXJhY3RlciBjb3VudCBjb21wb25lbnRcbiAgICpcbiAgICogVHJhY2tzIHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBvciB3b3JkcyBpbiB0aGUgYC5nb3Z1ay1qcy1jaGFyYWN0ZXItY291bnRgXG4gICAqIGA8dGV4dGFyZWE+YCBpbnNpZGUgdGhlIGVsZW1lbnQuIERpc3BsYXlzIGEgbWVzc2FnZSB3aXRoIHRoZSByZW1haW5pbmcgbnVtYmVyXG4gICAqIG9mIGNoYXJhY3RlcnMvd29yZHMgYXZhaWxhYmxlLCBvciB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMvd29yZHMgaW4gZXhjZXNzLlxuICAgKlxuICAgKiBZb3UgY2FuIGNvbmZpZ3VyZSB0aGUgbWVzc2FnZSB0byBvbmx5IGFwcGVhciBhZnRlciBhIGNlcnRhaW4gcGVyY2VudGFnZVxuICAgKiBvZiB0aGUgYXZhaWxhYmxlIGNoYXJhY3RlcnMvd29yZHMgaGFzIGJlZW4gZW50ZXJlZC5cbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBDaGFyYWN0ZXJDb3VudCBleHRlbmRzIEdPVlVLRnJvbnRlbmRDb21wb25lbnQge1xuICAgIC8qKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudCB8IG51bGx9ICRyb290IC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3IgY2hhcmFjdGVyIGNvdW50XG4gICAgICogQHBhcmFtIHtDaGFyYWN0ZXJDb3VudENvbmZpZ30gW2NvbmZpZ10gLSBDaGFyYWN0ZXIgY291bnQgY29uZmlnXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoJHJvb3QsIGNvbmZpZyA9IHt9KSB7XG4gICAgICB2YXIgX3JlZiwgX3RoaXMkY29uZmlnJG1heHdvcmRzO1xuICAgICAgc3VwZXIoJHJvb3QpO1xuICAgICAgdGhpcy4kdGV4dGFyZWEgPSB2b2lkIDA7XG4gICAgICB0aGlzLiR2aXNpYmxlQ291bnRNZXNzYWdlID0gdm9pZCAwO1xuICAgICAgdGhpcy4kc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlID0gdm9pZCAwO1xuICAgICAgdGhpcy5sYXN0SW5wdXRUaW1lc3RhbXAgPSBudWxsO1xuICAgICAgdGhpcy5sYXN0SW5wdXRWYWx1ZSA9ICcnO1xuICAgICAgdGhpcy52YWx1ZUNoZWNrZXIgPSBudWxsO1xuICAgICAgdGhpcy5jb25maWcgPSB2b2lkIDA7XG4gICAgICB0aGlzLmkxOG4gPSB2b2lkIDA7XG4gICAgICB0aGlzLm1heExlbmd0aCA9IHZvaWQgMDtcbiAgICAgIGNvbnN0ICR0ZXh0YXJlYSA9IHRoaXMuJHJvb3QucXVlcnlTZWxlY3RvcignLmdvdnVrLWpzLWNoYXJhY3Rlci1jb3VudCcpO1xuICAgICAgaWYgKCEoJHRleHRhcmVhIGluc3RhbmNlb2YgSFRNTFRleHRBcmVhRWxlbWVudCB8fCAkdGV4dGFyZWEgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IENoYXJhY3RlckNvdW50LFxuICAgICAgICAgIGVsZW1lbnQ6ICR0ZXh0YXJlYSxcbiAgICAgICAgICBleHBlY3RlZFR5cGU6ICdIVE1MVGV4dGFyZWFFbGVtZW50IG9yIEhUTUxJbnB1dEVsZW1lbnQnLFxuICAgICAgICAgIGlkZW50aWZpZXI6ICdGb3JtIGZpZWxkIChgLmdvdnVrLWpzLWNoYXJhY3Rlci1jb3VudGApJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGRhdGFzZXRDb25maWcgPSBub3JtYWxpc2VEYXRhc2V0KENoYXJhY3RlckNvdW50LCB0aGlzLiRyb290LmRhdGFzZXQpO1xuICAgICAgbGV0IGNvbmZpZ092ZXJyaWRlcyA9IHt9O1xuICAgICAgaWYgKCdtYXh3b3JkcycgaW4gZGF0YXNldENvbmZpZyB8fCAnbWF4bGVuZ3RoJyBpbiBkYXRhc2V0Q29uZmlnKSB7XG4gICAgICAgIGNvbmZpZ092ZXJyaWRlcyA9IHtcbiAgICAgICAgICBtYXhsZW5ndGg6IHVuZGVmaW5lZCxcbiAgICAgICAgICBtYXh3b3JkczogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhDaGFyYWN0ZXJDb3VudC5kZWZhdWx0cywgY29uZmlnLCBjb25maWdPdmVycmlkZXMsIGRhdGFzZXRDb25maWcpO1xuICAgICAgY29uc3QgZXJyb3JzID0gdmFsaWRhdGVDb25maWcoQ2hhcmFjdGVyQ291bnQuc2NoZW1hLCB0aGlzLmNvbmZpZyk7XG4gICAgICBpZiAoZXJyb3JzWzBdKSB7XG4gICAgICAgIHRocm93IG5ldyBDb25maWdFcnJvcihmb3JtYXRFcnJvck1lc3NhZ2UoQ2hhcmFjdGVyQ291bnQsIGVycm9yc1swXSkpO1xuICAgICAgfVxuICAgICAgdGhpcy5pMThuID0gbmV3IEkxOG4odGhpcy5jb25maWcuaTE4biwge1xuICAgICAgICBsb2NhbGU6IGNsb3Nlc3RBdHRyaWJ1dGVWYWx1ZSh0aGlzLiRyb290LCAnbGFuZycpXG4gICAgICB9KTtcbiAgICAgIHRoaXMubWF4TGVuZ3RoID0gKF9yZWYgPSAoX3RoaXMkY29uZmlnJG1heHdvcmRzID0gdGhpcy5jb25maWcubWF4d29yZHMpICE9IG51bGwgPyBfdGhpcyRjb25maWckbWF4d29yZHMgOiB0aGlzLmNvbmZpZy5tYXhsZW5ndGgpICE9IG51bGwgPyBfcmVmIDogSW5maW5pdHk7XG4gICAgICB0aGlzLiR0ZXh0YXJlYSA9ICR0ZXh0YXJlYTtcbiAgICAgIGNvbnN0IHRleHRhcmVhRGVzY3JpcHRpb25JZCA9IGAke3RoaXMuJHRleHRhcmVhLmlkfS1pbmZvYDtcbiAgICAgIGNvbnN0ICR0ZXh0YXJlYURlc2NyaXB0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGV4dGFyZWFEZXNjcmlwdGlvbklkKTtcbiAgICAgIGlmICghJHRleHRhcmVhRGVzY3JpcHRpb24pIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBDaGFyYWN0ZXJDb3VudCxcbiAgICAgICAgICBlbGVtZW50OiAkdGV4dGFyZWFEZXNjcmlwdGlvbixcbiAgICAgICAgICBpZGVudGlmaWVyOiBgQ291bnQgbWVzc2FnZSAoXFxgaWQ9XCIke3RleHRhcmVhRGVzY3JpcHRpb25JZH1cIlxcYClgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGAkeyR0ZXh0YXJlYURlc2NyaXB0aW9uLnRleHRDb250ZW50fWAubWF0Y2goL15cXHMqJC8pKSB7XG4gICAgICAgICR0ZXh0YXJlYURlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gdGhpcy5pMThuLnQoJ3RleHRhcmVhRGVzY3JpcHRpb24nLCB7XG4gICAgICAgICAgY291bnQ6IHRoaXMubWF4TGVuZ3RoXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy4kdGV4dGFyZWEuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCdhZnRlcmVuZCcsICR0ZXh0YXJlYURlc2NyaXB0aW9uKTtcbiAgICAgIGNvbnN0ICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UuY2xhc3NOYW1lID0gJ2dvdnVrLWNoYXJhY3Rlci1jb3VudF9fc3Itc3RhdHVzIGdvdnVrLXZpc3VhbGx5LWhpZGRlbic7XG4gICAgICAkc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlLnNldEF0dHJpYnV0ZSgnYXJpYS1saXZlJywgJ3BvbGl0ZScpO1xuICAgICAgdGhpcy4kc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlID0gJHNjcmVlblJlYWRlckNvdW50TWVzc2FnZTtcbiAgICAgICR0ZXh0YXJlYURlc2NyaXB0aW9uLmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCAkc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlKTtcbiAgICAgIGNvbnN0ICR2aXNpYmxlQ291bnRNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAkdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc05hbWUgPSAkdGV4dGFyZWFEZXNjcmlwdGlvbi5jbGFzc05hbWU7XG4gICAgICAkdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc0xpc3QuYWRkKCdnb3Z1ay1jaGFyYWN0ZXItY291bnRfX3N0YXR1cycpO1xuICAgICAgJHZpc2libGVDb3VudE1lc3NhZ2Uuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG4gICAgICB0aGlzLiR2aXNpYmxlQ291bnRNZXNzYWdlID0gJHZpc2libGVDb3VudE1lc3NhZ2U7XG4gICAgICAkdGV4dGFyZWFEZXNjcmlwdGlvbi5pbnNlcnRBZGphY2VudEVsZW1lbnQoJ2FmdGVyZW5kJywgJHZpc2libGVDb3VudE1lc3NhZ2UpO1xuICAgICAgJHRleHRhcmVhRGVzY3JpcHRpb24uY2xhc3NMaXN0LmFkZCgnZ292dWstdmlzdWFsbHktaGlkZGVuJyk7XG4gICAgICB0aGlzLiR0ZXh0YXJlYS5yZW1vdmVBdHRyaWJ1dGUoJ21heGxlbmd0aCcpO1xuICAgICAgdGhpcy5iaW5kQ2hhbmdlRXZlbnRzKCk7XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZXNob3cnLCAoKSA9PiB0aGlzLnVwZGF0ZUNvdW50TWVzc2FnZSgpKTtcbiAgICAgIHRoaXMudXBkYXRlQ291bnRNZXNzYWdlKCk7XG4gICAgfVxuICAgIGJpbmRDaGFuZ2VFdmVudHMoKSB7XG4gICAgICB0aGlzLiR0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsICgpID0+IHRoaXMuaGFuZGxlS2V5VXAoKSk7XG4gICAgICB0aGlzLiR0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsICgpID0+IHRoaXMuaGFuZGxlRm9jdXMoKSk7XG4gICAgICB0aGlzLiR0ZXh0YXJlYS5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKCkgPT4gdGhpcy5oYW5kbGVCbHVyKCkpO1xuICAgIH1cbiAgICBoYW5kbGVLZXlVcCgpIHtcbiAgICAgIHRoaXMudXBkYXRlVmlzaWJsZUNvdW50TWVzc2FnZSgpO1xuICAgICAgdGhpcy5sYXN0SW5wdXRUaW1lc3RhbXAgPSBEYXRlLm5vdygpO1xuICAgIH1cbiAgICBoYW5kbGVGb2N1cygpIHtcbiAgICAgIHRoaXMudmFsdWVDaGVja2VyID0gd2luZG93LnNldEludGVydmFsKCgpID0+IHtcbiAgICAgICAgaWYgKCF0aGlzLmxhc3RJbnB1dFRpbWVzdGFtcCB8fCBEYXRlLm5vdygpIC0gNTAwID49IHRoaXMubGFzdElucHV0VGltZXN0YW1wKSB7XG4gICAgICAgICAgdGhpcy51cGRhdGVJZlZhbHVlQ2hhbmdlZCgpO1xuICAgICAgICB9XG4gICAgICB9LCAxMDAwKTtcbiAgICB9XG4gICAgaGFuZGxlQmx1cigpIHtcbiAgICAgIGlmICh0aGlzLnZhbHVlQ2hlY2tlcikge1xuICAgICAgICB3aW5kb3cuY2xlYXJJbnRlcnZhbCh0aGlzLnZhbHVlQ2hlY2tlcik7XG4gICAgICB9XG4gICAgfVxuICAgIHVwZGF0ZUlmVmFsdWVDaGFuZ2VkKCkge1xuICAgICAgaWYgKHRoaXMuJHRleHRhcmVhLnZhbHVlICE9PSB0aGlzLmxhc3RJbnB1dFZhbHVlKSB7XG4gICAgICAgIHRoaXMubGFzdElucHV0VmFsdWUgPSB0aGlzLiR0ZXh0YXJlYS52YWx1ZTtcbiAgICAgICAgdGhpcy51cGRhdGVDb3VudE1lc3NhZ2UoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdXBkYXRlQ291bnRNZXNzYWdlKCkge1xuICAgICAgdGhpcy51cGRhdGVWaXNpYmxlQ291bnRNZXNzYWdlKCk7XG4gICAgICB0aGlzLnVwZGF0ZVNjcmVlblJlYWRlckNvdW50TWVzc2FnZSgpO1xuICAgIH1cbiAgICB1cGRhdGVWaXNpYmxlQ291bnRNZXNzYWdlKCkge1xuICAgICAgY29uc3QgcmVtYWluaW5nTnVtYmVyID0gdGhpcy5tYXhMZW5ndGggLSB0aGlzLmNvdW50KHRoaXMuJHRleHRhcmVhLnZhbHVlKTtcbiAgICAgIGNvbnN0IGlzRXJyb3IgPSByZW1haW5pbmdOdW1iZXIgPCAwO1xuICAgICAgdGhpcy4kdmlzaWJsZUNvdW50TWVzc2FnZS5jbGFzc0xpc3QudG9nZ2xlKCdnb3Z1ay1jaGFyYWN0ZXItY291bnRfX21lc3NhZ2UtLWRpc2FibGVkJywgIXRoaXMuaXNPdmVyVGhyZXNob2xkKCkpO1xuICAgICAgdGhpcy4kdGV4dGFyZWEuY2xhc3NMaXN0LnRvZ2dsZSgnZ292dWstdGV4dGFyZWEtLWVycm9yJywgaXNFcnJvcik7XG4gICAgICB0aGlzLiR2aXNpYmxlQ291bnRNZXNzYWdlLmNsYXNzTGlzdC50b2dnbGUoJ2dvdnVrLWVycm9yLW1lc3NhZ2UnLCBpc0Vycm9yKTtcbiAgICAgIHRoaXMuJHZpc2libGVDb3VudE1lc3NhZ2UuY2xhc3NMaXN0LnRvZ2dsZSgnZ292dWstaGludCcsICFpc0Vycm9yKTtcbiAgICAgIHRoaXMuJHZpc2libGVDb3VudE1lc3NhZ2UudGV4dENvbnRlbnQgPSB0aGlzLmdldENvdW50TWVzc2FnZSgpO1xuICAgIH1cbiAgICB1cGRhdGVTY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UoKSB7XG4gICAgICBpZiAodGhpcy5pc092ZXJUaHJlc2hvbGQoKSkge1xuICAgICAgICB0aGlzLiRzY3JlZW5SZWFkZXJDb3VudE1lc3NhZ2UucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWhpZGRlbicpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy4kc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpO1xuICAgICAgfVxuICAgICAgdGhpcy4kc2NyZWVuUmVhZGVyQ291bnRNZXNzYWdlLnRleHRDb250ZW50ID0gdGhpcy5nZXRDb3VudE1lc3NhZ2UoKTtcbiAgICB9XG4gICAgY291bnQodGV4dCkge1xuICAgICAgaWYgKHRoaXMuY29uZmlnLm1heHdvcmRzKSB7XG4gICAgICAgIHZhciBfdGV4dCRtYXRjaDtcbiAgICAgICAgY29uc3QgdG9rZW5zID0gKF90ZXh0JG1hdGNoID0gdGV4dC5tYXRjaCgvXFxTKy9nKSkgIT0gbnVsbCA/IF90ZXh0JG1hdGNoIDogW107XG4gICAgICAgIHJldHVybiB0b2tlbnMubGVuZ3RoO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRleHQubGVuZ3RoO1xuICAgIH1cbiAgICBnZXRDb3VudE1lc3NhZ2UoKSB7XG4gICAgICBjb25zdCByZW1haW5pbmdOdW1iZXIgPSB0aGlzLm1heExlbmd0aCAtIHRoaXMuY291bnQodGhpcy4kdGV4dGFyZWEudmFsdWUpO1xuICAgICAgY29uc3QgY291bnRUeXBlID0gdGhpcy5jb25maWcubWF4d29yZHMgPyAnd29yZHMnIDogJ2NoYXJhY3RlcnMnO1xuICAgICAgcmV0dXJuIHRoaXMuZm9ybWF0Q291bnRNZXNzYWdlKHJlbWFpbmluZ051bWJlciwgY291bnRUeXBlKTtcbiAgICB9XG4gICAgZm9ybWF0Q291bnRNZXNzYWdlKHJlbWFpbmluZ051bWJlciwgY291bnRUeXBlKSB7XG4gICAgICBpZiAocmVtYWluaW5nTnVtYmVyID09PSAwKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmkxOG4udChgJHtjb3VudFR5cGV9QXRMaW1pdGApO1xuICAgICAgfVxuICAgICAgY29uc3QgdHJhbnNsYXRpb25LZXlTdWZmaXggPSByZW1haW5pbmdOdW1iZXIgPCAwID8gJ092ZXJMaW1pdCcgOiAnVW5kZXJMaW1pdCc7XG4gICAgICByZXR1cm4gdGhpcy5pMThuLnQoYCR7Y291bnRUeXBlfSR7dHJhbnNsYXRpb25LZXlTdWZmaXh9YCwge1xuICAgICAgICBjb3VudDogTWF0aC5hYnMocmVtYWluaW5nTnVtYmVyKVxuICAgICAgfSk7XG4gICAgfVxuICAgIGlzT3ZlclRocmVzaG9sZCgpIHtcbiAgICAgIGlmICghdGhpcy5jb25maWcudGhyZXNob2xkKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgY29uc3QgY3VycmVudExlbmd0aCA9IHRoaXMuY291bnQodGhpcy4kdGV4dGFyZWEudmFsdWUpO1xuICAgICAgY29uc3QgbWF4TGVuZ3RoID0gdGhpcy5tYXhMZW5ndGg7XG4gICAgICBjb25zdCB0aHJlc2hvbGRWYWx1ZSA9IG1heExlbmd0aCAqIHRoaXMuY29uZmlnLnRocmVzaG9sZCAvIDEwMDtcbiAgICAgIHJldHVybiB0aHJlc2hvbGRWYWx1ZSA8PSBjdXJyZW50TGVuZ3RoO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDaGFyYWN0ZXIgY291bnQgY29uZmlnXG4gICAqXG4gICAqIEBzZWUge0BsaW5rIENoYXJhY3RlckNvdW50LmRlZmF1bHRzfVxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBDaGFyYWN0ZXJDb3VudENvbmZpZ1xuICAgKiBAcHJvcGVydHkge251bWJlcn0gW21heGxlbmd0aF0gLSBUaGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycy5cbiAgICogICBJZiBtYXh3b3JkcyBpcyBwcm92aWRlZCwgdGhlIG1heGxlbmd0aCBvcHRpb24gd2lsbCBiZSBpZ25vcmVkLlxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW21heHdvcmRzXSAtIFRoZSBtYXhpbXVtIG51bWJlciBvZiB3b3Jkcy4gSWYgbWF4d29yZHMgaXNcbiAgICogICBwcm92aWRlZCwgdGhlIG1heGxlbmd0aCBvcHRpb24gd2lsbCBiZSBpZ25vcmVkLlxuICAgKiBAcHJvcGVydHkge251bWJlcn0gW3RocmVzaG9sZD0wXSAtIFRoZSBwZXJjZW50YWdlIHZhbHVlIG9mIHRoZSBsaW1pdCBhdFxuICAgKiAgIHdoaWNoIHBvaW50IHRoZSBjb3VudCBtZXNzYWdlIGlzIGRpc3BsYXllZC4gSWYgdGhpcyBhdHRyaWJ1dGUgaXMgc2V0LCB0aGVcbiAgICogICBjb3VudCBtZXNzYWdlIHdpbGwgYmUgaGlkZGVuIGJ5IGRlZmF1bHQuXG4gICAqIEBwcm9wZXJ0eSB7Q2hhcmFjdGVyQ291bnRUcmFuc2xhdGlvbnN9IFtpMThuPUNoYXJhY3RlckNvdW50LmRlZmF1bHRzLmkxOG5dIC0gQ2hhcmFjdGVyIGNvdW50IHRyYW5zbGF0aW9uc1xuICAgKi9cblxuICAvKipcbiAgICogQ2hhcmFjdGVyIGNvdW50IHRyYW5zbGF0aW9uc1xuICAgKlxuICAgKiBAc2VlIHtAbGluayBDaGFyYWN0ZXJDb3VudC5kZWZhdWx0cy5pMThufVxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBDaGFyYWN0ZXJDb3VudFRyYW5zbGF0aW9uc1xuICAgKlxuICAgKiBNZXNzYWdlcyBzaG93biB0byB1c2VycyBhcyB0aGV5IHR5cGUuIEl0IHByb3ZpZGVzIGZlZWRiYWNrIG9uIGhvdyBtYW55IHdvcmRzXG4gICAqIG9yIGNoYXJhY3RlcnMgdGhleSBoYXZlIHJlbWFpbmluZyBvciBpZiB0aGV5IGFyZSBvdmVyIHRoZSBsaW1pdC4gVGhpcyBhbHNvXG4gICAqIGluY2x1ZGVzIGEgbWVzc2FnZSB1c2VkIGFzIGFuIGFjY2Vzc2libGUgZGVzY3JpcHRpb24gZm9yIHRoZSB0ZXh0YXJlYS5cbiAgICogQHByb3BlcnR5IHtUcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBbY2hhcmFjdGVyc1VuZGVyTGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWRcbiAgICogICB3aGVuIHRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBpcyB1bmRlciB0aGUgY29uZmlndXJlZCBtYXhpbXVtLCBgbWF4bGVuZ3RoYC5cbiAgICogICBUaGlzIG1lc3NhZ2UgaXMgZGlzcGxheWVkIHZpc3VhbGx5IGFuZCB0aHJvdWdoIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuIFRoZVxuICAgKiAgIGNvbXBvbmVudCB3aWxsIHJlcGxhY2UgdGhlIGAle2NvdW50fWAgcGxhY2Vob2xkZXIgd2l0aCB0aGUgbnVtYmVyIG9mXG4gICAqICAgcmVtYWluaW5nIGNoYXJhY3RlcnMuIFRoaXMgaXMgYSBbcGx1cmFsaXNlZCBsaXN0IG9mXG4gICAqICAgbWVzc2FnZXNdKGh0dHBzOi8vZnJvbnRlbmQuZGVzaWduLXN5c3RlbS5zZXJ2aWNlLmdvdi51ay9sb2NhbGlzZS1nb3Z1ay1mcm9udGVuZCkuXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbY2hhcmFjdGVyc0F0TGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWQgd2hlbiB0aGUgbnVtYmVyIG9mXG4gICAqICAgY2hhcmFjdGVycyByZWFjaGVzIHRoZSBjb25maWd1cmVkIG1heGltdW0sIGBtYXhsZW5ndGhgLiBUaGlzIG1lc3NhZ2UgaXNcbiAgICogICBkaXNwbGF5ZWQgdmlzdWFsbHkgYW5kIHRocm91Z2ggYXNzaXN0aXZlIHRlY2hub2xvZ2llcy5cbiAgICogQHByb3BlcnR5IHtUcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBbY2hhcmFjdGVyc092ZXJMaW1pdF0gLSBNZXNzYWdlIGRpc3BsYXllZFxuICAgKiAgIHdoZW4gdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGlzIG92ZXIgdGhlIGNvbmZpZ3VyZWQgbWF4aW11bSwgYG1heGxlbmd0aGAuXG4gICAqICAgVGhpcyBtZXNzYWdlIGlzIGRpc3BsYXllZCB2aXN1YWxseSBhbmQgdGhyb3VnaCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLiBUaGVcbiAgICogICBjb21wb25lbnQgd2lsbCByZXBsYWNlIHRoZSBgJXtjb3VudH1gIHBsYWNlaG9sZGVyIHdpdGggdGhlIG51bWJlciBvZlxuICAgKiAgIHJlbWFpbmluZyBjaGFyYWN0ZXJzLiBUaGlzIGlzIGEgW3BsdXJhbGlzZWQgbGlzdCBvZlxuICAgKiAgIG1lc3NhZ2VzXShodHRwczovL2Zyb250ZW5kLmRlc2lnbi1zeXN0ZW0uc2VydmljZS5nb3YudWsvbG9jYWxpc2UtZ292dWstZnJvbnRlbmQpLlxuICAgKiBAcHJvcGVydHkge1RyYW5zbGF0aW9uUGx1cmFsRm9ybXN9IFt3b3Jkc1VuZGVyTGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWQgd2hlblxuICAgKiAgIHRoZSBudW1iZXIgb2Ygd29yZHMgaXMgdW5kZXIgdGhlIGNvbmZpZ3VyZWQgbWF4aW11bSwgYG1heGxlbmd0aGAuIFRoaXNcbiAgICogICBtZXNzYWdlIGlzIGRpc3BsYXllZCB2aXN1YWxseSBhbmQgdGhyb3VnaCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLiBUaGVcbiAgICogICBjb21wb25lbnQgd2lsbCByZXBsYWNlIHRoZSBgJXtjb3VudH1gIHBsYWNlaG9sZGVyIHdpdGggdGhlIG51bWJlciBvZlxuICAgKiAgIHJlbWFpbmluZyB3b3Jkcy4gVGhpcyBpcyBhIFtwbHVyYWxpc2VkIGxpc3Qgb2ZcbiAgICogICBtZXNzYWdlc10oaHR0cHM6Ly9mcm9udGVuZC5kZXNpZ24tc3lzdGVtLnNlcnZpY2UuZ292LnVrL2xvY2FsaXNlLWdvdnVrLWZyb250ZW5kKS5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFt3b3Jkc0F0TGltaXRdIC0gTWVzc2FnZSBkaXNwbGF5ZWQgd2hlbiB0aGUgbnVtYmVyIG9mXG4gICAqICAgd29yZHMgcmVhY2hlcyB0aGUgY29uZmlndXJlZCBtYXhpbXVtLCBgbWF4bGVuZ3RoYC4gVGhpcyBtZXNzYWdlIGlzXG4gICAqICAgZGlzcGxheWVkIHZpc3VhbGx5IGFuZCB0aHJvdWdoIGFzc2lzdGl2ZSB0ZWNobm9sb2dpZXMuXG4gICAqIEBwcm9wZXJ0eSB7VHJhbnNsYXRpb25QbHVyYWxGb3Jtc30gW3dvcmRzT3ZlckxpbWl0XSAtIE1lc3NhZ2UgZGlzcGxheWVkIHdoZW5cbiAgICogICB0aGUgbnVtYmVyIG9mIHdvcmRzIGlzIG92ZXIgdGhlIGNvbmZpZ3VyZWQgbWF4aW11bSwgYG1heGxlbmd0aGAuIFRoaXNcbiAgICogICBtZXNzYWdlIGlzIGRpc3BsYXllZCB2aXN1YWxseSBhbmQgdGhyb3VnaCBhc3Npc3RpdmUgdGVjaG5vbG9naWVzLiBUaGVcbiAgICogICBjb21wb25lbnQgd2lsbCByZXBsYWNlIHRoZSBgJXtjb3VudH1gIHBsYWNlaG9sZGVyIHdpdGggdGhlIG51bWJlciBvZlxuICAgKiAgIHJlbWFpbmluZyB3b3Jkcy4gVGhpcyBpcyBhIFtwbHVyYWxpc2VkIGxpc3Qgb2ZcbiAgICogICBtZXNzYWdlc10oaHR0cHM6Ly9mcm9udGVuZC5kZXNpZ24tc3lzdGVtLnNlcnZpY2UuZ292LnVrL2xvY2FsaXNlLWdvdnVrLWZyb250ZW5kKS5cbiAgICogQHByb3BlcnR5IHtUcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBbdGV4dGFyZWFEZXNjcmlwdGlvbl0gLSBNZXNzYWdlIG1hZGVcbiAgICogICBhdmFpbGFibGUgdG8gYXNzaXN0aXZlIHRlY2hub2xvZ2llcywgaWYgbm9uZSBpcyBhbHJlYWR5IHByZXNlbnQgaW4gdGhlXG4gICAqICAgSFRNTCwgdG8gZGVzY3JpYmUgdGhhdCB0aGUgY29tcG9uZW50IGFjY2VwdHMgb25seSBhIGxpbWl0ZWQgYW1vdW50IG9mXG4gICAqICAgY29udGVudC4gSXQgaXMgdmlzaWJsZSBvbiB0aGUgcGFnZSB3aGVuIEphdmFTY3JpcHQgaXMgdW5hdmFpbGFibGUuIFRoZVxuICAgKiAgIGNvbXBvbmVudCB3aWxsIHJlcGxhY2UgdGhlIGAle2NvdW50fWAgcGxhY2Vob2xkZXIgd2l0aCB0aGUgdmFsdWUgb2YgdGhlXG4gICAqICAgYG1heGxlbmd0aGAgb3IgYG1heHdvcmRzYCBwYXJhbWV0ZXIuXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi9jb21tb24vaW5kZXgubWpzJykuU2NoZW1hfSBTY2hlbWFcbiAgICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vaTE4bi5tanMnKS5UcmFuc2xhdGlvblBsdXJhbEZvcm1zfSBUcmFuc2xhdGlvblBsdXJhbEZvcm1zXG4gICAqL1xuICBDaGFyYWN0ZXJDb3VudC5tb2R1bGVOYW1lID0gJ2dvdnVrLWNoYXJhY3Rlci1jb3VudCc7XG4gIENoYXJhY3RlckNvdW50LmRlZmF1bHRzID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgdGhyZXNob2xkOiAwLFxuICAgIGkxOG46IHtcbiAgICAgIGNoYXJhY3RlcnNVbmRlckxpbWl0OiB7XG4gICAgICAgIG9uZTogJ1lvdSBoYXZlICV7Y291bnR9IGNoYXJhY3RlciByZW1haW5pbmcnLFxuICAgICAgICBvdGhlcjogJ1lvdSBoYXZlICV7Y291bnR9IGNoYXJhY3RlcnMgcmVtYWluaW5nJ1xuICAgICAgfSxcbiAgICAgIGNoYXJhY3RlcnNBdExpbWl0OiAnWW91IGhhdmUgMCBjaGFyYWN0ZXJzIHJlbWFpbmluZycsXG4gICAgICBjaGFyYWN0ZXJzT3ZlckxpbWl0OiB7XG4gICAgICAgIG9uZTogJ1lvdSBoYXZlICV7Y291bnR9IGNoYXJhY3RlciB0b28gbWFueScsXG4gICAgICAgIG90aGVyOiAnWW91IGhhdmUgJXtjb3VudH0gY2hhcmFjdGVycyB0b28gbWFueSdcbiAgICAgIH0sXG4gICAgICB3b3Jkc1VuZGVyTGltaXQ6IHtcbiAgICAgICAgb25lOiAnWW91IGhhdmUgJXtjb3VudH0gd29yZCByZW1haW5pbmcnLFxuICAgICAgICBvdGhlcjogJ1lvdSBoYXZlICV7Y291bnR9IHdvcmRzIHJlbWFpbmluZydcbiAgICAgIH0sXG4gICAgICB3b3Jkc0F0TGltaXQ6ICdZb3UgaGF2ZSAwIHdvcmRzIHJlbWFpbmluZycsXG4gICAgICB3b3Jkc092ZXJMaW1pdDoge1xuICAgICAgICBvbmU6ICdZb3UgaGF2ZSAle2NvdW50fSB3b3JkIHRvbyBtYW55JyxcbiAgICAgICAgb3RoZXI6ICdZb3UgaGF2ZSAle2NvdW50fSB3b3JkcyB0b28gbWFueSdcbiAgICAgIH0sXG4gICAgICB0ZXh0YXJlYURlc2NyaXB0aW9uOiB7XG4gICAgICAgIG90aGVyOiAnJ1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gIENoYXJhY3RlckNvdW50LnNjaGVtYSA9IE9iamVjdC5mcmVlemUoe1xuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgIGkxOG46IHtcbiAgICAgICAgdHlwZTogJ29iamVjdCdcbiAgICAgIH0sXG4gICAgICBtYXh3b3Jkczoge1xuICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgfSxcbiAgICAgIG1heGxlbmd0aDoge1xuICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgfSxcbiAgICAgIHRocmVzaG9sZDoge1xuICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgfVxuICAgIH0sXG4gICAgYW55T2Y6IFt7XG4gICAgICByZXF1aXJlZDogWydtYXh3b3JkcyddLFxuICAgICAgZXJyb3JNZXNzYWdlOiAnRWl0aGVyIFwibWF4bGVuZ3RoXCIgb3IgXCJtYXh3b3Jkc1wiIG11c3QgYmUgcHJvdmlkZWQnXG4gICAgfSwge1xuICAgICAgcmVxdWlyZWQ6IFsnbWF4bGVuZ3RoJ10sXG4gICAgICBlcnJvck1lc3NhZ2U6ICdFaXRoZXIgXCJtYXhsZW5ndGhcIiBvciBcIm1heHdvcmRzXCIgbXVzdCBiZSBwcm92aWRlZCdcbiAgICB9XVxuICB9KTtcblxuICAvKipcbiAgICogQ2hlY2tib3hlcyBjb21wb25lbnRcbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBDaGVja2JveGVzIGV4dGVuZHMgR09WVUtGcm9udGVuZENvbXBvbmVudCB7XG4gICAgLyoqXG4gICAgICogQ2hlY2tib3hlcyBjYW4gYmUgYXNzb2NpYXRlZCB3aXRoIGEgJ2NvbmRpdGlvbmFsbHkgcmV2ZWFsZWQnIGNvbnRlbnQgYmxvY2tcbiAgICAgKiDigJMgZm9yIGV4YW1wbGUsIGEgY2hlY2tib3ggZm9yICdQaG9uZScgY291bGQgcmV2ZWFsIGFuIGFkZGl0aW9uYWwgZm9ybSBmaWVsZFxuICAgICAqIGZvciB0aGUgdXNlciB0byBlbnRlciB0aGVpciBwaG9uZSBudW1iZXIuXG4gICAgICpcbiAgICAgKiBUaGVzZSBhc3NvY2lhdGlvbnMgYXJlIG1hZGUgdXNpbmcgYSBgZGF0YS1hcmlhLWNvbnRyb2xzYCBhdHRyaWJ1dGUsIHdoaWNoXG4gICAgICogaXMgcHJvbW90ZWQgdG8gYW4gYXJpYS1jb250cm9scyBhdHRyaWJ1dGUgZHVyaW5nIGluaXRpYWxpc2F0aW9uLlxuICAgICAqXG4gICAgICogV2UgYWxzbyBuZWVkIHRvIHJlc3RvcmUgdGhlIHN0YXRlIG9mIGFueSBjb25kaXRpb25hbCByZXZlYWxzIG9uIHRoZSBwYWdlXG4gICAgICogKGZvciBleGFtcGxlIGlmIHRoZSB1c2VyIGhhcyBuYXZpZ2F0ZWQgYmFjayksIGFuZCBzZXQgdXAgZXZlbnQgaGFuZGxlcnMgdG9cbiAgICAgKiBrZWVwIHRoZSByZXZlYWwgaW4gc3luYyB3aXRoIHRoZSBjaGVja2JveCBzdGF0ZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudCB8IG51bGx9ICRyb290IC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3IgY2hlY2tib3hlc1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCRyb290KSB7XG4gICAgICBzdXBlcigkcm9vdCk7XG4gICAgICB0aGlzLiRpbnB1dHMgPSB2b2lkIDA7XG4gICAgICBjb25zdCAkaW5wdXRzID0gdGhpcy4kcm9vdC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcbiAgICAgIGlmICghJGlucHV0cy5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBDaGVja2JveGVzLFxuICAgICAgICAgIGlkZW50aWZpZXI6ICdGb3JtIGlucHV0cyAoYDxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIj5gKSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLiRpbnB1dHMgPSAkaW5wdXRzO1xuICAgICAgdGhpcy4kaW5wdXRzLmZvckVhY2goJGlucHV0ID0+IHtcbiAgICAgICAgY29uc3QgdGFyZ2V0SWQgPSAkaW5wdXQuZ2V0QXR0cmlidXRlKCdkYXRhLWFyaWEtY29udHJvbHMnKTtcbiAgICAgICAgaWYgKCF0YXJnZXRJZCkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRhcmdldElkKSkge1xuICAgICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3Ioe1xuICAgICAgICAgICAgY29tcG9uZW50OiBDaGVja2JveGVzLFxuICAgICAgICAgICAgaWRlbnRpZmllcjogYENvbmRpdGlvbmFsIHJldmVhbCAoXFxgaWQ9XCIke3RhcmdldElkfVwiXFxgKWBcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAkaW5wdXQuc2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJywgdGFyZ2V0SWQpO1xuICAgICAgICAkaW5wdXQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLWFyaWEtY29udHJvbHMnKTtcbiAgICAgIH0pO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VzaG93JywgKCkgPT4gdGhpcy5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzKCkpO1xuICAgICAgdGhpcy5zeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzKCk7XG4gICAgICB0aGlzLiRyb290LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4gdGhpcy5oYW5kbGVDbGljayhldmVudCkpO1xuICAgIH1cbiAgICBzeW5jQWxsQ29uZGl0aW9uYWxSZXZlYWxzKCkge1xuICAgICAgdGhpcy4kaW5wdXRzLmZvckVhY2goJGlucHV0ID0+IHRoaXMuc3luY0NvbmRpdGlvbmFsUmV2ZWFsV2l0aElucHV0U3RhdGUoJGlucHV0KSk7XG4gICAgfVxuICAgIHN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRpbnB1dCkge1xuICAgICAgY29uc3QgdGFyZ2V0SWQgPSAkaW5wdXQuZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XG4gICAgICBpZiAoIXRhcmdldElkKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0ICR0YXJnZXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0YXJnZXRJZCk7XG4gICAgICBpZiAoJHRhcmdldCAhPSBudWxsICYmICR0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdnb3Z1ay1jaGVja2JveGVzX19jb25kaXRpb25hbCcpKSB7XG4gICAgICAgIGNvbnN0IGlucHV0SXNDaGVja2VkID0gJGlucHV0LmNoZWNrZWQ7XG4gICAgICAgICRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBpbnB1dElzQ2hlY2tlZC50b1N0cmluZygpKTtcbiAgICAgICAgJHRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdnb3Z1ay1jaGVja2JveGVzX19jb25kaXRpb25hbC0taGlkZGVuJywgIWlucHV0SXNDaGVja2VkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdW5DaGVja0FsbElucHV0c0V4Y2VwdCgkaW5wdXQpIHtcbiAgICAgIGNvbnN0IGFsbElucHV0c1dpdGhTYW1lTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYGlucHV0W3R5cGU9XCJjaGVja2JveFwiXVtuYW1lPVwiJHskaW5wdXQubmFtZX1cIl1gKTtcbiAgICAgIGFsbElucHV0c1dpdGhTYW1lTmFtZS5mb3JFYWNoKCRpbnB1dFdpdGhTYW1lTmFtZSA9PiB7XG4gICAgICAgIGNvbnN0IGhhc1NhbWVGb3JtT3duZXIgPSAkaW5wdXQuZm9ybSA9PT0gJGlucHV0V2l0aFNhbWVOYW1lLmZvcm07XG4gICAgICAgIGlmIChoYXNTYW1lRm9ybU93bmVyICYmICRpbnB1dFdpdGhTYW1lTmFtZSAhPT0gJGlucHV0KSB7XG4gICAgICAgICAgJGlucHV0V2l0aFNhbWVOYW1lLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgICB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRpbnB1dFdpdGhTYW1lTmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICB1bkNoZWNrRXhjbHVzaXZlSW5wdXRzKCRpbnB1dCkge1xuICAgICAgY29uc3QgYWxsSW5wdXRzV2l0aFNhbWVOYW1lQW5kRXhjbHVzaXZlQmVoYXZpb3VyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChgaW5wdXRbZGF0YS1iZWhhdmlvdXI9XCJleGNsdXNpdmVcIl1bdHlwZT1cImNoZWNrYm94XCJdW25hbWU9XCIkeyRpbnB1dC5uYW1lfVwiXWApO1xuICAgICAgYWxsSW5wdXRzV2l0aFNhbWVOYW1lQW5kRXhjbHVzaXZlQmVoYXZpb3VyLmZvckVhY2goJGV4Y2x1c2l2ZUlucHV0ID0+IHtcbiAgICAgICAgY29uc3QgaGFzU2FtZUZvcm1Pd25lciA9ICRpbnB1dC5mb3JtID09PSAkZXhjbHVzaXZlSW5wdXQuZm9ybTtcbiAgICAgICAgaWYgKGhhc1NhbWVGb3JtT3duZXIpIHtcbiAgICAgICAgICAkZXhjbHVzaXZlSW5wdXQuY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuc3luY0NvbmRpdGlvbmFsUmV2ZWFsV2l0aElucHV0U3RhdGUoJGV4Y2x1c2l2ZUlucHV0KTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGhhbmRsZUNsaWNrKGV2ZW50KSB7XG4gICAgICBjb25zdCAkY2xpY2tlZElucHV0ID0gZXZlbnQudGFyZ2V0O1xuICAgICAgaWYgKCEoJGNsaWNrZWRJbnB1dCBpbnN0YW5jZW9mIEhUTUxJbnB1dEVsZW1lbnQpIHx8ICRjbGlja2VkSW5wdXQudHlwZSAhPT0gJ2NoZWNrYm94Jykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBoYXNBcmlhQ29udHJvbHMgPSAkY2xpY2tlZElucHV0LmdldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xuICAgICAgaWYgKGhhc0FyaWFDb250cm9scykge1xuICAgICAgICB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRjbGlja2VkSW5wdXQpO1xuICAgICAgfVxuICAgICAgaWYgKCEkY2xpY2tlZElucHV0LmNoZWNrZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgaGFzQmVoYXZpb3VyRXhjbHVzaXZlID0gJGNsaWNrZWRJbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtYmVoYXZpb3VyJykgPT09ICdleGNsdXNpdmUnO1xuICAgICAgaWYgKGhhc0JlaGF2aW91ckV4Y2x1c2l2ZSkge1xuICAgICAgICB0aGlzLnVuQ2hlY2tBbGxJbnB1dHNFeGNlcHQoJGNsaWNrZWRJbnB1dCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnVuQ2hlY2tFeGNsdXNpdmVJbnB1dHMoJGNsaWNrZWRJbnB1dCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIENoZWNrYm94ZXMubW9kdWxlTmFtZSA9ICdnb3Z1ay1jaGVja2JveGVzJztcblxuICAvKipcbiAgICogRXJyb3Igc3VtbWFyeSBjb21wb25lbnRcbiAgICpcbiAgICogVGFrZXMgZm9jdXMgb24gaW5pdGlhbGlzYXRpb24gZm9yIGFjY2Vzc2libGUgYW5ub3VuY2VtZW50LCB1bmxlc3MgZGlzYWJsZWQgaW5cbiAgICogY29uZmlndXJhdGlvbi5cbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBFcnJvclN1bW1hcnkgZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGVycm9yIHN1bW1hcnlcbiAgICAgKiBAcGFyYW0ge0Vycm9yU3VtbWFyeUNvbmZpZ30gW2NvbmZpZ10gLSBFcnJvciBzdW1tYXJ5IGNvbmZpZ1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCRyb290LCBjb25maWcgPSB7fSkge1xuICAgICAgc3VwZXIoJHJvb3QpO1xuICAgICAgdGhpcy5jb25maWcgPSB2b2lkIDA7XG4gICAgICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhFcnJvclN1bW1hcnkuZGVmYXVsdHMsIGNvbmZpZywgbm9ybWFsaXNlRGF0YXNldChFcnJvclN1bW1hcnksIHRoaXMuJHJvb3QuZGF0YXNldCkpO1xuICAgICAgaWYgKCF0aGlzLmNvbmZpZy5kaXNhYmxlQXV0b0ZvY3VzKSB7XG4gICAgICAgIHNldEZvY3VzKHRoaXMuJHJvb3QpO1xuICAgICAgfVxuICAgICAgdGhpcy4kcm9vdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50ID0+IHRoaXMuaGFuZGxlQ2xpY2soZXZlbnQpKTtcbiAgICB9XG4gICAgaGFuZGxlQ2xpY2soZXZlbnQpIHtcbiAgICAgIGNvbnN0ICR0YXJnZXQgPSBldmVudC50YXJnZXQ7XG4gICAgICBpZiAoJHRhcmdldCAmJiB0aGlzLmZvY3VzVGFyZ2V0KCR0YXJnZXQpKSB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfVxuICAgIGZvY3VzVGFyZ2V0KCR0YXJnZXQpIHtcbiAgICAgIGlmICghKCR0YXJnZXQgaW5zdGFuY2VvZiBIVE1MQW5jaG9yRWxlbWVudCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgaW5wdXRJZCA9IGdldEZyYWdtZW50RnJvbVVybCgkdGFyZ2V0LmhyZWYpO1xuICAgICAgaWYgKCFpbnB1dElkKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0ICRpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlucHV0SWQpO1xuICAgICAgaWYgKCEkaW5wdXQpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgJGxlZ2VuZE9yTGFiZWwgPSB0aGlzLmdldEFzc29jaWF0ZWRMZWdlbmRPckxhYmVsKCRpbnB1dCk7XG4gICAgICBpZiAoISRsZWdlbmRPckxhYmVsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgICRsZWdlbmRPckxhYmVsLnNjcm9sbEludG9WaWV3KCk7XG4gICAgICAkaW5wdXQuZm9jdXMoe1xuICAgICAgICBwcmV2ZW50U2Nyb2xsOiB0cnVlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBnZXRBc3NvY2lhdGVkTGVnZW5kT3JMYWJlbCgkaW5wdXQpIHtcbiAgICAgIHZhciBfZG9jdW1lbnQkcXVlcnlTZWxlY3Q7XG4gICAgICBjb25zdCAkZmllbGRzZXQgPSAkaW5wdXQuY2xvc2VzdCgnZmllbGRzZXQnKTtcbiAgICAgIGlmICgkZmllbGRzZXQpIHtcbiAgICAgICAgY29uc3QgJGxlZ2VuZHMgPSAkZmllbGRzZXQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ2xlZ2VuZCcpO1xuICAgICAgICBpZiAoJGxlZ2VuZHMubGVuZ3RoKSB7XG4gICAgICAgICAgY29uc3QgJGNhbmRpZGF0ZUxlZ2VuZCA9ICRsZWdlbmRzWzBdO1xuICAgICAgICAgIGlmICgkaW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50ICYmICgkaW5wdXQudHlwZSA9PT0gJ2NoZWNrYm94JyB8fCAkaW5wdXQudHlwZSA9PT0gJ3JhZGlvJykpIHtcbiAgICAgICAgICAgIHJldHVybiAkY2FuZGlkYXRlTGVnZW5kO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBsZWdlbmRUb3AgPSAkY2FuZGlkYXRlTGVnZW5kLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcbiAgICAgICAgICBjb25zdCBpbnB1dFJlY3QgPSAkaW5wdXQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgaWYgKGlucHV0UmVjdC5oZWlnaHQgJiYgd2luZG93LmlubmVySGVpZ2h0KSB7XG4gICAgICAgICAgICBjb25zdCBpbnB1dEJvdHRvbSA9IGlucHV0UmVjdC50b3AgKyBpbnB1dFJlY3QuaGVpZ2h0O1xuICAgICAgICAgICAgaWYgKGlucHV0Qm90dG9tIC0gbGVnZW5kVG9wIDwgd2luZG93LmlubmVySGVpZ2h0IC8gMikge1xuICAgICAgICAgICAgICByZXR1cm4gJGNhbmRpZGF0ZUxlZ2VuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiAoX2RvY3VtZW50JHF1ZXJ5U2VsZWN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgbGFiZWxbZm9yPSckeyRpbnB1dC5nZXRBdHRyaWJ1dGUoJ2lkJyl9J11gKSkgIT0gbnVsbCA/IF9kb2N1bWVudCRxdWVyeVNlbGVjdCA6ICRpbnB1dC5jbG9zZXN0KCdsYWJlbCcpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBFcnJvciBzdW1tYXJ5IGNvbmZpZ1xuICAgKlxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBFcnJvclN1bW1hcnlDb25maWdcbiAgICogQHByb3BlcnR5IHtib29sZWFufSBbZGlzYWJsZUF1dG9Gb2N1cz1mYWxzZV0gLSBJZiBzZXQgdG8gYHRydWVgIHRoZSBlcnJvclxuICAgKiAgIHN1bW1hcnkgd2lsbCBub3QgYmUgZm9jdXNzZWQgd2hlbiB0aGUgcGFnZSBsb2Fkcy5cbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2NvbW1vbi9pbmRleC5tanMnKS5TY2hlbWF9IFNjaGVtYVxuICAgKi9cbiAgRXJyb3JTdW1tYXJ5Lm1vZHVsZU5hbWUgPSAnZ292dWstZXJyb3Itc3VtbWFyeSc7XG4gIEVycm9yU3VtbWFyeS5kZWZhdWx0cyA9IE9iamVjdC5mcmVlemUoe1xuICAgIGRpc2FibGVBdXRvRm9jdXM6IGZhbHNlXG4gIH0pO1xuICBFcnJvclN1bW1hcnkuc2NoZW1hID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgcHJvcGVydGllczoge1xuICAgICAgZGlzYWJsZUF1dG9Gb2N1czoge1xuICAgICAgICB0eXBlOiAnYm9vbGVhbidcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBFeGl0IHRoaXMgcGFnZSBjb21wb25lbnRcbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBFeGl0VGhpc1BhZ2UgZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0aGF0IHdyYXBzIHRoZSBFeGl0IFRoaXMgUGFnZSBidXR0b25cbiAgICAgKiBAcGFyYW0ge0V4aXRUaGlzUGFnZUNvbmZpZ30gW2NvbmZpZ10gLSBFeGl0IFRoaXMgUGFnZSBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcigkcm9vdCwgY29uZmlnID0ge30pIHtcbiAgICAgIHN1cGVyKCRyb290KTtcbiAgICAgIHRoaXMuY29uZmlnID0gdm9pZCAwO1xuICAgICAgdGhpcy5pMThuID0gdm9pZCAwO1xuICAgICAgdGhpcy4kYnV0dG9uID0gdm9pZCAwO1xuICAgICAgdGhpcy4kc2tpcGxpbmtCdXR0b24gPSBudWxsO1xuICAgICAgdGhpcy4kdXBkYXRlU3BhbiA9IG51bGw7XG4gICAgICB0aGlzLiRpbmRpY2F0b3JDb250YWluZXIgPSBudWxsO1xuICAgICAgdGhpcy4kb3ZlcmxheSA9IG51bGw7XG4gICAgICB0aGlzLmtleXByZXNzQ291bnRlciA9IDA7XG4gICAgICB0aGlzLmxhc3RLZXlXYXNNb2RpZmllZCA9IGZhbHNlO1xuICAgICAgdGhpcy50aW1lb3V0VGltZSA9IDUwMDA7XG4gICAgICB0aGlzLmtleXByZXNzVGltZW91dElkID0gbnVsbDtcbiAgICAgIHRoaXMudGltZW91dE1lc3NhZ2VJZCA9IG51bGw7XG4gICAgICBjb25zdCAkYnV0dG9uID0gdGhpcy4kcm9vdC5xdWVyeVNlbGVjdG9yKCcuZ292dWstZXhpdC10aGlzLXBhZ2VfX2J1dHRvbicpO1xuICAgICAgaWYgKCEoJGJ1dHRvbiBpbnN0YW5jZW9mIEhUTUxBbmNob3JFbGVtZW50KSkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IEV4aXRUaGlzUGFnZSxcbiAgICAgICAgICBlbGVtZW50OiAkYnV0dG9uLFxuICAgICAgICAgIGV4cGVjdGVkVHlwZTogJ0hUTUxBbmNob3JFbGVtZW50JyxcbiAgICAgICAgICBpZGVudGlmaWVyOiAnQnV0dG9uIChgLmdvdnVrLWV4aXQtdGhpcy1wYWdlX19idXR0b25gKSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhFeGl0VGhpc1BhZ2UuZGVmYXVsdHMsIGNvbmZpZywgbm9ybWFsaXNlRGF0YXNldChFeGl0VGhpc1BhZ2UsIHRoaXMuJHJvb3QuZGF0YXNldCkpO1xuICAgICAgdGhpcy5pMThuID0gbmV3IEkxOG4odGhpcy5jb25maWcuaTE4bik7XG4gICAgICB0aGlzLiRidXR0b24gPSAkYnV0dG9uO1xuICAgICAgY29uc3QgJHNraXBsaW5rQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmdvdnVrLWpzLWV4aXQtdGhpcy1wYWdlLXNraXBsaW5rJyk7XG4gICAgICBpZiAoJHNraXBsaW5rQnV0dG9uIGluc3RhbmNlb2YgSFRNTEFuY2hvckVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy4kc2tpcGxpbmtCdXR0b24gPSAkc2tpcGxpbmtCdXR0b247XG4gICAgICB9XG4gICAgICB0aGlzLmJ1aWxkSW5kaWNhdG9yKCk7XG4gICAgICB0aGlzLmluaXRVcGRhdGVTcGFuKCk7XG4gICAgICB0aGlzLmluaXRCdXR0b25DbGlja0hhbmRsZXIoKTtcbiAgICAgIGlmICghKCdnb3Z1a0Zyb250ZW5kRXhpdFRoaXNQYWdlS2V5cHJlc3MnIGluIGRvY3VtZW50LmJvZHkuZGF0YXNldCkpIHtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLmhhbmRsZUtleXByZXNzLmJpbmQodGhpcyksIHRydWUpO1xuICAgICAgICBkb2N1bWVudC5ib2R5LmRhdGFzZXQuZ292dWtGcm9udGVuZEV4aXRUaGlzUGFnZUtleXByZXNzID0gJ3RydWUnO1xuICAgICAgfVxuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BhZ2VzaG93JywgdGhpcy5yZXNldFBhZ2UuYmluZCh0aGlzKSk7XG4gICAgfVxuICAgIGluaXRVcGRhdGVTcGFuKCkge1xuICAgICAgdGhpcy4kdXBkYXRlU3BhbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIHRoaXMuJHVwZGF0ZVNwYW4uc2V0QXR0cmlidXRlKCdyb2xlJywgJ3N0YXR1cycpO1xuICAgICAgdGhpcy4kdXBkYXRlU3Bhbi5jbGFzc05hbWUgPSAnZ292dWstdmlzdWFsbHktaGlkZGVuJztcbiAgICAgIHRoaXMuJHJvb3QuYXBwZW5kQ2hpbGQodGhpcy4kdXBkYXRlU3Bhbik7XG4gICAgfVxuICAgIGluaXRCdXR0b25DbGlja0hhbmRsZXIoKSB7XG4gICAgICB0aGlzLiRidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmhhbmRsZUNsaWNrLmJpbmQodGhpcykpO1xuICAgICAgaWYgKHRoaXMuJHNraXBsaW5rQnV0dG9uKSB7XG4gICAgICAgIHRoaXMuJHNraXBsaW5rQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5oYW5kbGVDbGljay5iaW5kKHRoaXMpKTtcbiAgICAgIH1cbiAgICB9XG4gICAgYnVpbGRJbmRpY2F0b3IoKSB7XG4gICAgICB0aGlzLiRpbmRpY2F0b3JDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgIHRoaXMuJGluZGljYXRvckNvbnRhaW5lci5jbGFzc05hbWUgPSAnZ292dWstZXhpdC10aGlzLXBhZ2VfX2luZGljYXRvcic7XG4gICAgICB0aGlzLiRpbmRpY2F0b3JDb250YWluZXIuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICd0cnVlJyk7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IDM7IGkrKykge1xuICAgICAgICBjb25zdCAkaW5kaWNhdG9yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICRpbmRpY2F0b3IuY2xhc3NOYW1lID0gJ2dvdnVrLWV4aXQtdGhpcy1wYWdlX19pbmRpY2F0b3ItbGlnaHQnO1xuICAgICAgICB0aGlzLiRpbmRpY2F0b3JDb250YWluZXIuYXBwZW5kQ2hpbGQoJGluZGljYXRvcik7XG4gICAgICB9XG4gICAgICB0aGlzLiRidXR0b24uYXBwZW5kQ2hpbGQodGhpcy4kaW5kaWNhdG9yQ29udGFpbmVyKTtcbiAgICB9XG4gICAgdXBkYXRlSW5kaWNhdG9yKCkge1xuICAgICAgaWYgKCF0aGlzLiRpbmRpY2F0b3JDb250YWluZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy4kaW5kaWNhdG9yQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoJ2dvdnVrLWV4aXQtdGhpcy1wYWdlX19pbmRpY2F0b3ItLXZpc2libGUnLCB0aGlzLmtleXByZXNzQ291bnRlciA+IDApO1xuICAgICAgY29uc3QgJGluZGljYXRvcnMgPSB0aGlzLiRpbmRpY2F0b3JDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmdvdnVrLWV4aXQtdGhpcy1wYWdlX19pbmRpY2F0b3ItbGlnaHQnKTtcbiAgICAgICRpbmRpY2F0b3JzLmZvckVhY2goKCRpbmRpY2F0b3IsIGluZGV4KSA9PiB7XG4gICAgICAgICRpbmRpY2F0b3IuY2xhc3NMaXN0LnRvZ2dsZSgnZ292dWstZXhpdC10aGlzLXBhZ2VfX2luZGljYXRvci1saWdodC0tb24nLCBpbmRleCA8IHRoaXMua2V5cHJlc3NDb3VudGVyKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBleGl0UGFnZSgpIHtcbiAgICAgIGlmICghdGhpcy4kdXBkYXRlU3Bhbikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLiR1cGRhdGVTcGFuLnRleHRDb250ZW50ID0gJyc7XG4gICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQoJ2dvdnVrLWV4aXQtdGhpcy1wYWdlLWhpZGUtY29udGVudCcpO1xuICAgICAgdGhpcy4kb3ZlcmxheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgdGhpcy4kb3ZlcmxheS5jbGFzc05hbWUgPSAnZ292dWstZXhpdC10aGlzLXBhZ2Utb3ZlcmxheSc7XG4gICAgICB0aGlzLiRvdmVybGF5LnNldEF0dHJpYnV0ZSgncm9sZScsICdhbGVydCcpO1xuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0aGlzLiRvdmVybGF5KTtcbiAgICAgIHRoaXMuJG92ZXJsYXkudGV4dENvbnRlbnQgPSB0aGlzLmkxOG4udCgnYWN0aXZhdGVkJyk7XG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHRoaXMuJGJ1dHRvbi5ocmVmO1xuICAgIH1cbiAgICBoYW5kbGVDbGljayhldmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuZXhpdFBhZ2UoKTtcbiAgICB9XG4gICAgaGFuZGxlS2V5cHJlc3MoZXZlbnQpIHtcbiAgICAgIGlmICghdGhpcy4kdXBkYXRlU3Bhbikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAoZXZlbnQua2V5ID09PSAnU2hpZnQnICYmICF0aGlzLmxhc3RLZXlXYXNNb2RpZmllZCkge1xuICAgICAgICB0aGlzLmtleXByZXNzQ291bnRlciArPSAxO1xuICAgICAgICB0aGlzLnVwZGF0ZUluZGljYXRvcigpO1xuICAgICAgICBpZiAodGhpcy50aW1lb3V0TWVzc2FnZUlkKSB7XG4gICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXRNZXNzYWdlSWQpO1xuICAgICAgICAgIHRoaXMudGltZW91dE1lc3NhZ2VJZCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMua2V5cHJlc3NDb3VudGVyID49IDMpIHtcbiAgICAgICAgICB0aGlzLmtleXByZXNzQ291bnRlciA9IDA7XG4gICAgICAgICAgaWYgKHRoaXMua2V5cHJlc3NUaW1lb3V0SWQpIHtcbiAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5rZXlwcmVzc1RpbWVvdXRJZCk7XG4gICAgICAgICAgICB0aGlzLmtleXByZXNzVGltZW91dElkID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5leGl0UGFnZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGlmICh0aGlzLmtleXByZXNzQ291bnRlciA9PT0gMSkge1xuICAgICAgICAgICAgdGhpcy4kdXBkYXRlU3Bhbi50ZXh0Q29udGVudCA9IHRoaXMuaTE4bi50KCdwcmVzc1R3b01vcmVUaW1lcycpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLiR1cGRhdGVTcGFuLnRleHRDb250ZW50ID0gdGhpcy5pMThuLnQoJ3ByZXNzT25lTW9yZVRpbWUnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRLZXlwcmVzc1RpbWVyKCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMua2V5cHJlc3NUaW1lb3V0SWQpIHtcbiAgICAgICAgdGhpcy5yZXNldEtleXByZXNzVGltZXIoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMubGFzdEtleVdhc01vZGlmaWVkID0gZXZlbnQuc2hpZnRLZXk7XG4gICAgfVxuICAgIHNldEtleXByZXNzVGltZXIoKSB7XG4gICAgICBpZiAodGhpcy5rZXlwcmVzc1RpbWVvdXRJZCkge1xuICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMua2V5cHJlc3NUaW1lb3V0SWQpO1xuICAgICAgfVxuICAgICAgdGhpcy5rZXlwcmVzc1RpbWVvdXRJZCA9IHdpbmRvdy5zZXRUaW1lb3V0KHRoaXMucmVzZXRLZXlwcmVzc1RpbWVyLmJpbmQodGhpcyksIHRoaXMudGltZW91dFRpbWUpO1xuICAgIH1cbiAgICByZXNldEtleXByZXNzVGltZXIoKSB7XG4gICAgICBpZiAoIXRoaXMuJHVwZGF0ZVNwYW4pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKHRoaXMua2V5cHJlc3NUaW1lb3V0SWQpIHtcbiAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLmtleXByZXNzVGltZW91dElkKTtcbiAgICAgICAgdGhpcy5rZXlwcmVzc1RpbWVvdXRJZCA9IG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCAkdXBkYXRlU3BhbiA9IHRoaXMuJHVwZGF0ZVNwYW47XG4gICAgICB0aGlzLmtleXByZXNzQ291bnRlciA9IDA7XG4gICAgICAkdXBkYXRlU3Bhbi50ZXh0Q29udGVudCA9IHRoaXMuaTE4bi50KCd0aW1lZE91dCcpO1xuICAgICAgdGhpcy50aW1lb3V0TWVzc2FnZUlkID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAkdXBkYXRlU3Bhbi50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgfSwgdGhpcy50aW1lb3V0VGltZSk7XG4gICAgICB0aGlzLnVwZGF0ZUluZGljYXRvcigpO1xuICAgIH1cbiAgICByZXNldFBhZ2UoKSB7XG4gICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2dvdnVrLWV4aXQtdGhpcy1wYWdlLWhpZGUtY29udGVudCcpO1xuICAgICAgaWYgKHRoaXMuJG92ZXJsYXkpIHtcbiAgICAgICAgdGhpcy4kb3ZlcmxheS5yZW1vdmUoKTtcbiAgICAgICAgdGhpcy4kb3ZlcmxheSA9IG51bGw7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy4kdXBkYXRlU3Bhbikge1xuICAgICAgICB0aGlzLiR1cGRhdGVTcGFuLnNldEF0dHJpYnV0ZSgncm9sZScsICdzdGF0dXMnKTtcbiAgICAgICAgdGhpcy4kdXBkYXRlU3Bhbi50ZXh0Q29udGVudCA9ICcnO1xuICAgICAgfVxuICAgICAgdGhpcy51cGRhdGVJbmRpY2F0b3IoKTtcbiAgICAgIGlmICh0aGlzLmtleXByZXNzVGltZW91dElkKSB7XG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5rZXlwcmVzc1RpbWVvdXRJZCk7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy50aW1lb3V0TWVzc2FnZUlkKSB7XG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy50aW1lb3V0TWVzc2FnZUlkKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogRXhpdCB0aGlzIFBhZ2UgY29uZmlnXG4gICAqXG4gICAqIEBzZWUge0BsaW5rIEV4aXRUaGlzUGFnZS5kZWZhdWx0c31cbiAgICogQHR5cGVkZWYge29iamVjdH0gRXhpdFRoaXNQYWdlQ29uZmlnXG4gICAqIEBwcm9wZXJ0eSB7RXhpdFRoaXNQYWdlVHJhbnNsYXRpb25zfSBbaTE4bj1FeGl0VGhpc1BhZ2UuZGVmYXVsdHMuaTE4bl0gLSBFeGl0IHRoaXMgcGFnZSB0cmFuc2xhdGlvbnNcbiAgICovXG5cbiAgLyoqXG4gICAqIEV4aXQgdGhpcyBQYWdlIHRyYW5zbGF0aW9uc1xuICAgKlxuICAgKiBAc2VlIHtAbGluayBFeGl0VGhpc1BhZ2UuZGVmYXVsdHMuaTE4bn1cbiAgICogQHR5cGVkZWYge29iamVjdH0gRXhpdFRoaXNQYWdlVHJhbnNsYXRpb25zXG4gICAqXG4gICAqIE1lc3NhZ2VzIHVzZWQgYnkgdGhlIGNvbXBvbmVudCBwcm9ncmFtYXRpY2FsbHkgaW5zZXJ0ZWQgdGV4dCwgaW5jbHVkaW5nXG4gICAqIG92ZXJsYXkgdGV4dCBhbmQgc2NyZWVuIHJlYWRlciBhbm5vdW5jZW1lbnRzLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW2FjdGl2YXRlZF0gLSBTY3JlZW4gcmVhZGVyIGFubm91bmNlbWVudCBmb3Igd2hlbiBFdFBcbiAgICogICBrZXlwcmVzcyBmdW5jdGlvbmFsaXR5IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBhY3RpdmF0ZWQuXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbdGltZWRPdXRdIC0gU2NyZWVuIHJlYWRlciBhbm5vdW5jZW1lbnQgZm9yIHdoZW4gdGhlIEV0UFxuICAgKiAgIGtleXByZXNzIGZ1bmN0aW9uYWxpdHkgaGFzIHRpbWVkIG91dC5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtwcmVzc1R3b01vcmVUaW1lc10gLSBTY3JlZW4gcmVhZGVyIGFubm91bmNlbWVudCBpbmZvcm1pbmdcbiAgICogICB0aGUgdXNlciB0aGV5IG11c3QgcHJlc3MgdGhlIGFjdGl2YXRpb24ga2V5IHR3byBtb3JlIHRpbWVzLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3ByZXNzT25lTW9yZVRpbWVdIC0gU2NyZWVuIHJlYWRlciBhbm5vdW5jZW1lbnQgaW5mb3JtaW5nXG4gICAqICAgdGhlIHVzZXIgdGhleSBtdXN0IHByZXNzIHRoZSBhY3RpdmF0aW9uIGtleSBvbmUgbW9yZSB0aW1lLlxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vY29tbW9uL2luZGV4Lm1qcycpLlNjaGVtYX0gU2NoZW1hXG4gICAqL1xuICBFeGl0VGhpc1BhZ2UubW9kdWxlTmFtZSA9ICdnb3Z1ay1leGl0LXRoaXMtcGFnZSc7XG4gIEV4aXRUaGlzUGFnZS5kZWZhdWx0cyA9IE9iamVjdC5mcmVlemUoe1xuICAgIGkxOG46IHtcbiAgICAgIGFjdGl2YXRlZDogJ0xvYWRpbmcuJyxcbiAgICAgIHRpbWVkT3V0OiAnRXhpdCB0aGlzIHBhZ2UgZXhwaXJlZC4nLFxuICAgICAgcHJlc3NUd29Nb3JlVGltZXM6ICdTaGlmdCwgcHJlc3MgMiBtb3JlIHRpbWVzIHRvIGV4aXQuJyxcbiAgICAgIHByZXNzT25lTW9yZVRpbWU6ICdTaGlmdCwgcHJlc3MgMSBtb3JlIHRpbWUgdG8gZXhpdC4nXG4gICAgfVxuICB9KTtcbiAgRXhpdFRoaXNQYWdlLnNjaGVtYSA9IE9iamVjdC5mcmVlemUoe1xuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgIGkxOG46IHtcbiAgICAgICAgdHlwZTogJ29iamVjdCdcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBIZWFkZXIgY29tcG9uZW50XG4gICAqXG4gICAqIEBwcmVzZXJ2ZVxuICAgKi9cbiAgY2xhc3MgSGVhZGVyIGV4dGVuZHMgR09WVUtGcm9udGVuZENvbXBvbmVudCB7XG4gICAgLyoqXG4gICAgICogQXBwbHkgYSBtYXRjaE1lZGlhIGZvciBkZXNrdG9wIHdoaWNoIHdpbGwgdHJpZ2dlciBhIHN0YXRlIHN5bmMgaWYgdGhlXG4gICAgICogYnJvd3NlciB2aWV3cG9ydCBtb3ZlcyBiZXR3ZWVuIHN0YXRlcy5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7RWxlbWVudCB8IG51bGx9ICRyb290IC0gSFRNTCBlbGVtZW50IHRvIHVzZSBmb3IgaGVhZGVyXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoJHJvb3QpIHtcbiAgICAgIHN1cGVyKCRyb290KTtcbiAgICAgIHRoaXMuJG1lbnVCdXR0b24gPSB2b2lkIDA7XG4gICAgICB0aGlzLiRtZW51ID0gdm9pZCAwO1xuICAgICAgdGhpcy5tZW51SXNPcGVuID0gZmFsc2U7XG4gICAgICB0aGlzLm1xbCA9IG51bGw7XG4gICAgICBjb25zdCAkbWVudUJ1dHRvbiA9IHRoaXMuJHJvb3QucXVlcnlTZWxlY3RvcignLmdvdnVrLWpzLWhlYWRlci10b2dnbGUnKTtcbiAgICAgIGlmICghJG1lbnVCdXR0b24pIHtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICB9XG4gICAgICBjb25zdCBtZW51SWQgPSAkbWVudUJ1dHRvbi5nZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnKTtcbiAgICAgIGlmICghbWVudUlkKSB7XG4gICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3Ioe1xuICAgICAgICAgIGNvbXBvbmVudDogSGVhZGVyLFxuICAgICAgICAgIGlkZW50aWZpZXI6ICdOYXZpZ2F0aW9uIGJ1dHRvbiAoYDxidXR0b24gY2xhc3M9XCJnb3Z1ay1qcy1oZWFkZXItdG9nZ2xlXCI+YCkgYXR0cmlidXRlIChgYXJpYS1jb250cm9sc2ApJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0ICRtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWVudUlkKTtcbiAgICAgIGlmICghJG1lbnUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBIZWFkZXIsXG4gICAgICAgICAgZWxlbWVudDogJG1lbnUsXG4gICAgICAgICAgaWRlbnRpZmllcjogYE5hdmlnYXRpb24gKFxcYDx1bCBpZD1cIiR7bWVudUlkfVwiPlxcYClgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy4kbWVudSA9ICRtZW51O1xuICAgICAgdGhpcy4kbWVudUJ1dHRvbiA9ICRtZW51QnV0dG9uO1xuICAgICAgdGhpcy5zZXR1cFJlc3BvbnNpdmVDaGVja3MoKTtcbiAgICAgIHRoaXMuJG1lbnVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLmhhbmRsZU1lbnVCdXR0b25DbGljaygpKTtcbiAgICB9XG4gICAgc2V0dXBSZXNwb25zaXZlQ2hlY2tzKCkge1xuICAgICAgY29uc3QgYnJlYWtwb2ludCA9IGdldEJyZWFrcG9pbnQoJ2Rlc2t0b3AnKTtcbiAgICAgIGlmICghYnJlYWtwb2ludC52YWx1ZSkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IEhlYWRlcixcbiAgICAgICAgICBpZGVudGlmaWVyOiBgQ1NTIGN1c3RvbSBwcm9wZXJ0eSAoXFxgJHticmVha3BvaW50LnByb3BlcnR5fVxcYCkgb24gcHNldWRvLWNsYXNzIFxcYDpyb290XFxgYFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMubXFsID0gd2luZG93Lm1hdGNoTWVkaWEoYChtaW4td2lkdGg6ICR7YnJlYWtwb2ludC52YWx1ZX0pYCk7XG4gICAgICBpZiAoJ2FkZEV2ZW50TGlzdGVuZXInIGluIHRoaXMubXFsKSB7XG4gICAgICAgIHRoaXMubXFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHRoaXMuY2hlY2tNb2RlKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5tcWwuYWRkTGlzdGVuZXIoKCkgPT4gdGhpcy5jaGVja01vZGUoKSk7XG4gICAgICB9XG4gICAgICB0aGlzLmNoZWNrTW9kZSgpO1xuICAgIH1cbiAgICBjaGVja01vZGUoKSB7XG4gICAgICBpZiAoIXRoaXMubXFsIHx8ICF0aGlzLiRtZW51IHx8ICF0aGlzLiRtZW51QnV0dG9uKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1xbC5tYXRjaGVzKSB7XG4gICAgICAgIHRoaXMuJG1lbnUucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgdGhpcy4kbWVudUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuJG1lbnVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgdGhpcy4kbWVudUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCB0aGlzLm1lbnVJc09wZW4udG9TdHJpbmcoKSk7XG4gICAgICAgIGlmICh0aGlzLm1lbnVJc09wZW4pIHtcbiAgICAgICAgICB0aGlzLiRtZW51LnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy4kbWVudS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVNZW51QnV0dG9uQ2xpY2soKSB7XG4gICAgICB0aGlzLm1lbnVJc09wZW4gPSAhdGhpcy5tZW51SXNPcGVuO1xuICAgICAgdGhpcy5jaGVja01vZGUoKTtcbiAgICB9XG4gIH1cbiAgSGVhZGVyLm1vZHVsZU5hbWUgPSAnZ292dWstaGVhZGVyJztcblxuICAvKipcbiAgICogTm90aWZpY2F0aW9uIEJhbm5lciBjb21wb25lbnRcbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBOb3RpZmljYXRpb25CYW5uZXIgZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIG5vdGlmaWNhdGlvbiBiYW5uZXJcbiAgICAgKiBAcGFyYW0ge05vdGlmaWNhdGlvbkJhbm5lckNvbmZpZ30gW2NvbmZpZ10gLSBOb3RpZmljYXRpb24gYmFubmVyIGNvbmZpZ1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCRyb290LCBjb25maWcgPSB7fSkge1xuICAgICAgc3VwZXIoJHJvb3QpO1xuICAgICAgdGhpcy5jb25maWcgPSB2b2lkIDA7XG4gICAgICB0aGlzLmNvbmZpZyA9IG1lcmdlQ29uZmlncyhOb3RpZmljYXRpb25CYW5uZXIuZGVmYXVsdHMsIGNvbmZpZywgbm9ybWFsaXNlRGF0YXNldChOb3RpZmljYXRpb25CYW5uZXIsIHRoaXMuJHJvb3QuZGF0YXNldCkpO1xuICAgICAgaWYgKHRoaXMuJHJvb3QuZ2V0QXR0cmlidXRlKCdyb2xlJykgPT09ICdhbGVydCcgJiYgIXRoaXMuY29uZmlnLmRpc2FibGVBdXRvRm9jdXMpIHtcbiAgICAgICAgc2V0Rm9jdXModGhpcy4kcm9vdCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIE5vdGlmaWNhdGlvbiBiYW5uZXIgY29uZmlnXG4gICAqXG4gICAqIEB0eXBlZGVmIHtvYmplY3R9IE5vdGlmaWNhdGlvbkJhbm5lckNvbmZpZ1xuICAgKiBAcHJvcGVydHkge2Jvb2xlYW59IFtkaXNhYmxlQXV0b0ZvY3VzPWZhbHNlXSAtIElmIHNldCB0byBgdHJ1ZWAgdGhlXG4gICAqICAgbm90aWZpY2F0aW9uIGJhbm5lciB3aWxsIG5vdCBiZSBmb2N1c3NlZCB3aGVuIHRoZSBwYWdlIGxvYWRzLiBUaGlzIG9ubHlcbiAgICogICBhcHBsaWVzIGlmIHRoZSBjb21wb25lbnQgaGFzIGEgYHJvbGVgIG9mIGBhbGVydGAg4oCTIGluIG90aGVyIGNhc2VzIHRoZVxuICAgKiAgIGNvbXBvbmVudCB3aWxsIG5vdCBiZSBmb2N1c2VkIG9uIHBhZ2UgbG9hZCwgcmVnYXJkbGVzcyBvZiB0aGlzIG9wdGlvbi5cbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2NvbW1vbi9pbmRleC5tanMnKS5TY2hlbWF9IFNjaGVtYVxuICAgKi9cbiAgTm90aWZpY2F0aW9uQmFubmVyLm1vZHVsZU5hbWUgPSAnZ292dWstbm90aWZpY2F0aW9uLWJhbm5lcic7XG4gIE5vdGlmaWNhdGlvbkJhbm5lci5kZWZhdWx0cyA9IE9iamVjdC5mcmVlemUoe1xuICAgIGRpc2FibGVBdXRvRm9jdXM6IGZhbHNlXG4gIH0pO1xuICBOb3RpZmljYXRpb25CYW5uZXIuc2NoZW1hID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgcHJvcGVydGllczoge1xuICAgICAgZGlzYWJsZUF1dG9Gb2N1czoge1xuICAgICAgICB0eXBlOiAnYm9vbGVhbidcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBQYXNzd29yZCBpbnB1dCBjb21wb25lbnRcbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBQYXNzd29yZElucHV0IGV4dGVuZHMgR09WVUtGcm9udGVuZENvbXBvbmVudCB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtFbGVtZW50IHwgbnVsbH0gJHJvb3QgLSBIVE1MIGVsZW1lbnQgdG8gdXNlIGZvciBwYXNzd29yZCBpbnB1dFxuICAgICAqIEBwYXJhbSB7UGFzc3dvcmRJbnB1dENvbmZpZ30gW2NvbmZpZ10gLSBQYXNzd29yZCBpbnB1dCBjb25maWdcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcigkcm9vdCwgY29uZmlnID0ge30pIHtcbiAgICAgIHN1cGVyKCRyb290KTtcbiAgICAgIHRoaXMuY29uZmlnID0gdm9pZCAwO1xuICAgICAgdGhpcy5pMThuID0gdm9pZCAwO1xuICAgICAgdGhpcy4kaW5wdXQgPSB2b2lkIDA7XG4gICAgICB0aGlzLiRzaG93SGlkZUJ1dHRvbiA9IHZvaWQgMDtcbiAgICAgIHRoaXMuJHNjcmVlblJlYWRlclN0YXR1c01lc3NhZ2UgPSB2b2lkIDA7XG4gICAgICBjb25zdCAkaW5wdXQgPSB0aGlzLiRyb290LnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay1qcy1wYXNzd29yZC1pbnB1dC1pbnB1dCcpO1xuICAgICAgaWYgKCEoJGlucHV0IGluc3RhbmNlb2YgSFRNTElucHV0RWxlbWVudCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBQYXNzd29yZElucHV0LFxuICAgICAgICAgIGVsZW1lbnQ6ICRpbnB1dCxcbiAgICAgICAgICBleHBlY3RlZFR5cGU6ICdIVE1MSW5wdXRFbGVtZW50JyxcbiAgICAgICAgICBpZGVudGlmaWVyOiAnRm9ybSBmaWVsZCAoYC5nb3Z1ay1qcy1wYXNzd29yZC1pbnB1dC1pbnB1dGApJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICgkaW5wdXQudHlwZSAhPT0gJ3Bhc3N3b3JkJykge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKCdQYXNzd29yZCBpbnB1dDogRm9ybSBmaWVsZCAoYC5nb3Z1ay1qcy1wYXNzd29yZC1pbnB1dC1pbnB1dGApIG11c3QgYmUgb2YgdHlwZSBgcGFzc3dvcmRgLicpO1xuICAgICAgfVxuICAgICAgY29uc3QgJHNob3dIaWRlQnV0dG9uID0gdGhpcy4kcm9vdC5xdWVyeVNlbGVjdG9yKCcuZ292dWstanMtcGFzc3dvcmQtaW5wdXQtdG9nZ2xlJyk7XG4gICAgICBpZiAoISgkc2hvd0hpZGVCdXR0b24gaW5zdGFuY2VvZiBIVE1MQnV0dG9uRWxlbWVudCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBQYXNzd29yZElucHV0LFxuICAgICAgICAgIGVsZW1lbnQ6ICRzaG93SGlkZUJ1dHRvbixcbiAgICAgICAgICBleHBlY3RlZFR5cGU6ICdIVE1MQnV0dG9uRWxlbWVudCcsXG4gICAgICAgICAgaWRlbnRpZmllcjogJ0J1dHRvbiAoYC5nb3Z1ay1qcy1wYXNzd29yZC1pbnB1dC10b2dnbGVgKSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoJHNob3dIaWRlQnV0dG9uLnR5cGUgIT09ICdidXR0b24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3IoJ1Bhc3N3b3JkIGlucHV0OiBCdXR0b24gKGAuZ292dWstanMtcGFzc3dvcmQtaW5wdXQtdG9nZ2xlYCkgbXVzdCBiZSBvZiB0eXBlIGBidXR0b25gLicpO1xuICAgICAgfVxuICAgICAgdGhpcy4kaW5wdXQgPSAkaW5wdXQ7XG4gICAgICB0aGlzLiRzaG93SGlkZUJ1dHRvbiA9ICRzaG93SGlkZUJ1dHRvbjtcbiAgICAgIHRoaXMuY29uZmlnID0gbWVyZ2VDb25maWdzKFBhc3N3b3JkSW5wdXQuZGVmYXVsdHMsIGNvbmZpZywgbm9ybWFsaXNlRGF0YXNldChQYXNzd29yZElucHV0LCB0aGlzLiRyb290LmRhdGFzZXQpKTtcbiAgICAgIHRoaXMuaTE4biA9IG5ldyBJMThuKHRoaXMuY29uZmlnLmkxOG4sIHtcbiAgICAgICAgbG9jYWxlOiBjbG9zZXN0QXR0cmlidXRlVmFsdWUodGhpcy4kcm9vdCwgJ2xhbmcnKVxuICAgICAgfSk7XG4gICAgICB0aGlzLiRzaG93SGlkZUJ1dHRvbi5yZW1vdmVBdHRyaWJ1dGUoJ2hpZGRlbicpO1xuICAgICAgY29uc3QgJHNjcmVlblJlYWRlclN0YXR1c01lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICRzY3JlZW5SZWFkZXJTdGF0dXNNZXNzYWdlLmNsYXNzTmFtZSA9ICdnb3Z1ay1wYXNzd29yZC1pbnB1dF9fc3Itc3RhdHVzIGdvdnVrLXZpc3VhbGx5LWhpZGRlbic7XG4gICAgICAkc2NyZWVuUmVhZGVyU3RhdHVzTWVzc2FnZS5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGl2ZScsICdwb2xpdGUnKTtcbiAgICAgIHRoaXMuJHNjcmVlblJlYWRlclN0YXR1c01lc3NhZ2UgPSAkc2NyZWVuUmVhZGVyU3RhdHVzTWVzc2FnZTtcbiAgICAgIHRoaXMuJGlucHV0Lmluc2VydEFkamFjZW50RWxlbWVudCgnYWZ0ZXJlbmQnLCAkc2NyZWVuUmVhZGVyU3RhdHVzTWVzc2FnZSk7XG4gICAgICB0aGlzLiRzaG93SGlkZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMudG9nZ2xlLmJpbmQodGhpcykpO1xuICAgICAgaWYgKHRoaXMuJGlucHV0LmZvcm0pIHtcbiAgICAgICAgdGhpcy4kaW5wdXQuZm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoKSA9PiB0aGlzLmhpZGUoKSk7XG4gICAgICB9XG4gICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncGFnZXNob3cnLCBldmVudCA9PiB7XG4gICAgICAgIGlmIChldmVudC5wZXJzaXN0ZWQgJiYgdGhpcy4kaW5wdXQudHlwZSAhPT0gJ3Bhc3N3b3JkJykge1xuICAgICAgICAgIHRoaXMuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHRoaXMuaGlkZSgpO1xuICAgIH1cbiAgICB0b2dnbGUoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBpZiAodGhpcy4kaW5wdXQudHlwZSA9PT0gJ3Bhc3N3b3JkJykge1xuICAgICAgICB0aGlzLnNob3coKTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfVxuICAgIHNob3coKSB7XG4gICAgICB0aGlzLnNldFR5cGUoJ3RleHQnKTtcbiAgICB9XG4gICAgaGlkZSgpIHtcbiAgICAgIHRoaXMuc2V0VHlwZSgncGFzc3dvcmQnKTtcbiAgICB9XG4gICAgc2V0VHlwZSh0eXBlKSB7XG4gICAgICBpZiAodHlwZSA9PT0gdGhpcy4kaW5wdXQudHlwZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLiRpbnB1dC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCB0eXBlKTtcbiAgICAgIGNvbnN0IGlzSGlkZGVuID0gdHlwZSA9PT0gJ3Bhc3N3b3JkJztcbiAgICAgIGNvbnN0IHByZWZpeEJ1dHRvbiA9IGlzSGlkZGVuID8gJ3Nob3cnIDogJ2hpZGUnO1xuICAgICAgY29uc3QgcHJlZml4U3RhdHVzID0gaXNIaWRkZW4gPyAncGFzc3dvcmRIaWRkZW4nIDogJ3Bhc3N3b3JkU2hvd24nO1xuICAgICAgdGhpcy4kc2hvd0hpZGVCdXR0b24uaW5uZXJUZXh0ID0gdGhpcy5pMThuLnQoYCR7cHJlZml4QnV0dG9ufVBhc3N3b3JkYCk7XG4gICAgICB0aGlzLiRzaG93SGlkZUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCB0aGlzLmkxOG4udChgJHtwcmVmaXhCdXR0b259UGFzc3dvcmRBcmlhTGFiZWxgKSk7XG4gICAgICB0aGlzLiRzY3JlZW5SZWFkZXJTdGF0dXNNZXNzYWdlLmlubmVyVGV4dCA9IHRoaXMuaTE4bi50KGAke3ByZWZpeFN0YXR1c31Bbm5vdW5jZW1lbnRgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGFzc3dvcmQgaW5wdXQgY29uZmlnXG4gICAqXG4gICAqIEB0eXBlZGVmIHtvYmplY3R9IFBhc3N3b3JkSW5wdXRDb25maWdcbiAgICogQHByb3BlcnR5IHtQYXNzd29yZElucHV0VHJhbnNsYXRpb25zfSBbaTE4bj1QYXNzd29yZElucHV0LmRlZmF1bHRzLmkxOG5dIC0gUGFzc3dvcmQgaW5wdXQgdHJhbnNsYXRpb25zXG4gICAqL1xuXG4gIC8qKlxuICAgKiBQYXNzd29yZCBpbnB1dCB0cmFuc2xhdGlvbnNcbiAgICpcbiAgICogQHNlZSB7QGxpbmsgUGFzc3dvcmRJbnB1dC5kZWZhdWx0cy5pMThufVxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBQYXNzd29yZElucHV0VHJhbnNsYXRpb25zXG4gICAqXG4gICAqIE1lc3NhZ2VzIGRpc3BsYXllZCB0byB0aGUgdXNlciBpbmRpY2F0aW5nIHRoZSBzdGF0ZSBvZiB0aGUgc2hvdy9oaWRlIHRvZ2dsZS5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtzaG93UGFzc3dvcmRdIC0gVmlzaWJsZSB0ZXh0IG9mIHRoZSBidXR0b24gd2hlbiB0aGVcbiAgICogICBwYXNzd29yZCBpcyBjdXJyZW50bHkgaGlkZGVuLiBQbGFpbiB0ZXh0IG9ubHkuXG4gICAqIEBwcm9wZXJ0eSB7c3RyaW5nfSBbaGlkZVBhc3N3b3JkXSAtIFZpc2libGUgdGV4dCBvZiB0aGUgYnV0dG9uIHdoZW4gdGhlXG4gICAqICAgcGFzc3dvcmQgaXMgY3VycmVudGx5IHZpc2libGUuIFBsYWluIHRleHQgb25seS5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtzaG93UGFzc3dvcmRBcmlhTGFiZWxdIC0gYXJpYS1sYWJlbCBvZiB0aGUgYnV0dG9uIHdoZW5cbiAgICogICB0aGUgcGFzc3dvcmQgaXMgY3VycmVudGx5IGhpZGRlbi4gUGxhaW4gdGV4dCBvbmx5LlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW2hpZGVQYXNzd29yZEFyaWFMYWJlbF0gLSBhcmlhLWxhYmVsIG9mIHRoZSBidXR0b24gd2hlblxuICAgKiAgIHRoZSBwYXNzd29yZCBpcyBjdXJyZW50bHkgdmlzaWJsZS4gUGxhaW4gdGV4dCBvbmx5LlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gW3Bhc3N3b3JkU2hvd25Bbm5vdW5jZW1lbnRdIC0gU2NyZWVuIHJlYWRlclxuICAgKiAgIGFubm91bmNlbWVudCB0byBtYWtlIHdoZW4gdGhlIHBhc3N3b3JkIGhhcyBqdXN0IGJlY29tZSB2aXNpYmxlLlxuICAgKiAgIFBsYWluIHRleHQgb25seS5cbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IFtwYXNzd29yZEhpZGRlbkFubm91bmNlbWVudF0gLSBTY3JlZW4gcmVhZGVyXG4gICAqICAgYW5ub3VuY2VtZW50IHRvIG1ha2Ugd2hlbiB0aGUgcGFzc3dvcmQgaGFzIGp1c3QgYmVlbiBoaWRkZW4uXG4gICAqICAgUGxhaW4gdGV4dCBvbmx5LlxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vY29tbW9uL2luZGV4Lm1qcycpLlNjaGVtYX0gU2NoZW1hXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2kxOG4ubWpzJykuVHJhbnNsYXRpb25QbHVyYWxGb3Jtc30gVHJhbnNsYXRpb25QbHVyYWxGb3Jtc1xuICAgKi9cbiAgUGFzc3dvcmRJbnB1dC5tb2R1bGVOYW1lID0gJ2dvdnVrLXBhc3N3b3JkLWlucHV0JztcbiAgUGFzc3dvcmRJbnB1dC5kZWZhdWx0cyA9IE9iamVjdC5mcmVlemUoe1xuICAgIGkxOG46IHtcbiAgICAgIHNob3dQYXNzd29yZDogJ1Nob3cnLFxuICAgICAgaGlkZVBhc3N3b3JkOiAnSGlkZScsXG4gICAgICBzaG93UGFzc3dvcmRBcmlhTGFiZWw6ICdTaG93IHBhc3N3b3JkJyxcbiAgICAgIGhpZGVQYXNzd29yZEFyaWFMYWJlbDogJ0hpZGUgcGFzc3dvcmQnLFxuICAgICAgcGFzc3dvcmRTaG93bkFubm91bmNlbWVudDogJ1lvdXIgcGFzc3dvcmQgaXMgdmlzaWJsZScsXG4gICAgICBwYXNzd29yZEhpZGRlbkFubm91bmNlbWVudDogJ1lvdXIgcGFzc3dvcmQgaXMgaGlkZGVuJ1xuICAgIH1cbiAgfSk7XG4gIFBhc3N3b3JkSW5wdXQuc2NoZW1hID0gT2JqZWN0LmZyZWV6ZSh7XG4gICAgcHJvcGVydGllczoge1xuICAgICAgaTE4bjoge1xuICAgICAgICB0eXBlOiAnb2JqZWN0J1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgLyoqXG4gICAqIFJhZGlvcyBjb21wb25lbnRcbiAgICpcbiAgICogQHByZXNlcnZlXG4gICAqL1xuICBjbGFzcyBSYWRpb3MgZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBSYWRpb3MgY2FuIGJlIGFzc29jaWF0ZWQgd2l0aCBhICdjb25kaXRpb25hbGx5IHJldmVhbGVkJyBjb250ZW50IGJsb2NrIOKAk1xuICAgICAqIGZvciBleGFtcGxlLCBhIHJhZGlvIGZvciAnUGhvbmUnIGNvdWxkIHJldmVhbCBhbiBhZGRpdGlvbmFsIGZvcm0gZmllbGQgZm9yXG4gICAgICogdGhlIHVzZXIgdG8gZW50ZXIgdGhlaXIgcGhvbmUgbnVtYmVyLlxuICAgICAqXG4gICAgICogVGhlc2UgYXNzb2NpYXRpb25zIGFyZSBtYWRlIHVzaW5nIGEgYGRhdGEtYXJpYS1jb250cm9sc2AgYXR0cmlidXRlLCB3aGljaFxuICAgICAqIGlzIHByb21vdGVkIHRvIGFuIGFyaWEtY29udHJvbHMgYXR0cmlidXRlIGR1cmluZyBpbml0aWFsaXNhdGlvbi5cbiAgICAgKlxuICAgICAqIFdlIGFsc28gbmVlZCB0byByZXN0b3JlIHRoZSBzdGF0ZSBvZiBhbnkgY29uZGl0aW9uYWwgcmV2ZWFscyBvbiB0aGUgcGFnZVxuICAgICAqIChmb3IgZXhhbXBsZSBpZiB0aGUgdXNlciBoYXMgbmF2aWdhdGVkIGJhY2spLCBhbmQgc2V0IHVwIGV2ZW50IGhhbmRsZXJzIHRvXG4gICAgICoga2VlcCB0aGUgcmV2ZWFsIGluIHN5bmMgd2l0aCB0aGUgcmFkaW8gc3RhdGUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIHJhZGlvc1xuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCRyb290KSB7XG4gICAgICBzdXBlcigkcm9vdCk7XG4gICAgICB0aGlzLiRpbnB1dHMgPSB2b2lkIDA7XG4gICAgICBjb25zdCAkaW5wdXRzID0gdGhpcy4kcm9vdC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dFt0eXBlPVwicmFkaW9cIl0nKTtcbiAgICAgIGlmICghJGlucHV0cy5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBSYWRpb3MsXG4gICAgICAgICAgaWRlbnRpZmllcjogJ0Zvcm0gaW5wdXRzIChgPGlucHV0IHR5cGU9XCJyYWRpb1wiPmApJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMuJGlucHV0cyA9ICRpbnB1dHM7XG4gICAgICB0aGlzLiRpbnB1dHMuZm9yRWFjaCgkaW5wdXQgPT4ge1xuICAgICAgICBjb25zdCB0YXJnZXRJZCA9ICRpbnB1dC5nZXRBdHRyaWJ1dGUoJ2RhdGEtYXJpYS1jb250cm9scycpO1xuICAgICAgICBpZiAoIXRhcmdldElkKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0SWQpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgICBjb21wb25lbnQ6IFJhZGlvcyxcbiAgICAgICAgICAgIGlkZW50aWZpZXI6IGBDb25kaXRpb25hbCByZXZlYWwgKFxcYGlkPVwiJHt0YXJnZXRJZH1cIlxcYClgXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgJGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycsIHRhcmdldElkKTtcbiAgICAgICAgJGlucHV0LnJlbW92ZUF0dHJpYnV0ZSgnZGF0YS1hcmlhLWNvbnRyb2xzJyk7XG4gICAgICB9KTtcbiAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwYWdlc2hvdycsICgpID0+IHRoaXMuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscygpKTtcbiAgICAgIHRoaXMuc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscygpO1xuICAgICAgdGhpcy4kcm9vdC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50ID0+IHRoaXMuaGFuZGxlQ2xpY2soZXZlbnQpKTtcbiAgICB9XG4gICAgc3luY0FsbENvbmRpdGlvbmFsUmV2ZWFscygpIHtcbiAgICAgIHRoaXMuJGlucHV0cy5mb3JFYWNoKCRpbnB1dCA9PiB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRpbnB1dCkpO1xuICAgIH1cbiAgICBzeW5jQ29uZGl0aW9uYWxSZXZlYWxXaXRoSW5wdXRTdGF0ZSgkaW5wdXQpIHtcbiAgICAgIGNvbnN0IHRhcmdldElkID0gJGlucHV0LmdldEF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xuICAgICAgaWYgKCF0YXJnZXRJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCAkdGFyZ2V0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodGFyZ2V0SWQpO1xuICAgICAgaWYgKCR0YXJnZXQgIT0gbnVsbCAmJiAkdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZ292dWstcmFkaW9zX19jb25kaXRpb25hbCcpKSB7XG4gICAgICAgIGNvbnN0IGlucHV0SXNDaGVja2VkID0gJGlucHV0LmNoZWNrZWQ7XG4gICAgICAgICRpbnB1dC5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCBpbnB1dElzQ2hlY2tlZC50b1N0cmluZygpKTtcbiAgICAgICAgJHRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdnb3Z1ay1yYWRpb3NfX2NvbmRpdGlvbmFsLS1oaWRkZW4nLCAhaW5wdXRJc0NoZWNrZWQpO1xuICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVDbGljayhldmVudCkge1xuICAgICAgY29uc3QgJGNsaWNrZWRJbnB1dCA9IGV2ZW50LnRhcmdldDtcbiAgICAgIGlmICghKCRjbGlja2VkSW5wdXQgaW5zdGFuY2VvZiBIVE1MSW5wdXRFbGVtZW50KSB8fCAkY2xpY2tlZElucHV0LnR5cGUgIT09ICdyYWRpbycpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgJGFsbElucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0W3R5cGU9XCJyYWRpb1wiXVthcmlhLWNvbnRyb2xzXScpO1xuICAgICAgY29uc3QgJGNsaWNrZWRJbnB1dEZvcm0gPSAkY2xpY2tlZElucHV0LmZvcm07XG4gICAgICBjb25zdCAkY2xpY2tlZElucHV0TmFtZSA9ICRjbGlja2VkSW5wdXQubmFtZTtcbiAgICAgICRhbGxJbnB1dHMuZm9yRWFjaCgkaW5wdXQgPT4ge1xuICAgICAgICBjb25zdCBoYXNTYW1lRm9ybU93bmVyID0gJGlucHV0LmZvcm0gPT09ICRjbGlja2VkSW5wdXRGb3JtO1xuICAgICAgICBjb25zdCBoYXNTYW1lTmFtZSA9ICRpbnB1dC5uYW1lID09PSAkY2xpY2tlZElucHV0TmFtZTtcbiAgICAgICAgaWYgKGhhc1NhbWVOYW1lICYmIGhhc1NhbWVGb3JtT3duZXIpIHtcbiAgICAgICAgICB0aGlzLnN5bmNDb25kaXRpb25hbFJldmVhbFdpdGhJbnB1dFN0YXRlKCRpbnB1dCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBSYWRpb3MubW9kdWxlTmFtZSA9ICdnb3Z1ay1yYWRpb3MnO1xuXG4gIC8qKlxuICAgKiBTZXJ2aWNlIE5hdmlnYXRpb24gY29tcG9uZW50XG4gICAqXG4gICAqIEBwcmVzZXJ2ZVxuICAgKi9cbiAgY2xhc3MgU2VydmljZU5hdmlnYXRpb24gZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIGhlYWRlclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKCRyb290KSB7XG4gICAgICBzdXBlcigkcm9vdCk7XG4gICAgICB0aGlzLiRtZW51QnV0dG9uID0gdm9pZCAwO1xuICAgICAgdGhpcy4kbWVudSA9IHZvaWQgMDtcbiAgICAgIHRoaXMubWVudUlzT3BlbiA9IGZhbHNlO1xuICAgICAgdGhpcy5tcWwgPSBudWxsO1xuICAgICAgY29uc3QgJG1lbnVCdXR0b24gPSB0aGlzLiRyb290LnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay1qcy1zZXJ2aWNlLW5hdmlnYXRpb24tdG9nZ2xlJyk7XG4gICAgICBpZiAoISRtZW51QnV0dG9uKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgICAgY29uc3QgbWVudUlkID0gJG1lbnVCdXR0b24uZ2V0QXR0cmlidXRlKCdhcmlhLWNvbnRyb2xzJyk7XG4gICAgICBpZiAoIW1lbnVJZCkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IFNlcnZpY2VOYXZpZ2F0aW9uLFxuICAgICAgICAgIGlkZW50aWZpZXI6ICdOYXZpZ2F0aW9uIGJ1dHRvbiAoYDxidXR0b24gY2xhc3M9XCJnb3Z1ay1qcy1zZXJ2aWNlLW5hdmlnYXRpb24tdG9nZ2xlXCI+YCkgYXR0cmlidXRlIChgYXJpYS1jb250cm9sc2ApJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0ICRtZW51ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobWVudUlkKTtcbiAgICAgIGlmICghJG1lbnUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBTZXJ2aWNlTmF2aWdhdGlvbixcbiAgICAgICAgICBlbGVtZW50OiAkbWVudSxcbiAgICAgICAgICBpZGVudGlmaWVyOiBgTmF2aWdhdGlvbiAoXFxgPHVsIGlkPVwiJHttZW51SWR9XCI+XFxgKWBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLiRtZW51ID0gJG1lbnU7XG4gICAgICB0aGlzLiRtZW51QnV0dG9uID0gJG1lbnVCdXR0b247XG4gICAgICB0aGlzLnNldHVwUmVzcG9uc2l2ZUNoZWNrcygpO1xuICAgICAgdGhpcy4kbWVudUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuaGFuZGxlTWVudUJ1dHRvbkNsaWNrKCkpO1xuICAgIH1cbiAgICBzZXR1cFJlc3BvbnNpdmVDaGVja3MoKSB7XG4gICAgICBjb25zdCBicmVha3BvaW50ID0gZ2V0QnJlYWtwb2ludCgndGFibGV0Jyk7XG4gICAgICBpZiAoIWJyZWFrcG9pbnQudmFsdWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBTZXJ2aWNlTmF2aWdhdGlvbixcbiAgICAgICAgICBpZGVudGlmaWVyOiBgQ1NTIGN1c3RvbSBwcm9wZXJ0eSAoXFxgJHticmVha3BvaW50LnByb3BlcnR5fVxcYCkgb24gcHNldWRvLWNsYXNzIFxcYDpyb290XFxgYFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIHRoaXMubXFsID0gd2luZG93Lm1hdGNoTWVkaWEoYChtaW4td2lkdGg6ICR7YnJlYWtwb2ludC52YWx1ZX0pYCk7XG4gICAgICBpZiAoJ2FkZEV2ZW50TGlzdGVuZXInIGluIHRoaXMubXFsKSB7XG4gICAgICAgIHRoaXMubXFsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHRoaXMuY2hlY2tNb2RlKCkpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5tcWwuYWRkTGlzdGVuZXIoKCkgPT4gdGhpcy5jaGVja01vZGUoKSk7XG4gICAgICB9XG4gICAgICB0aGlzLmNoZWNrTW9kZSgpO1xuICAgIH1cbiAgICBjaGVja01vZGUoKSB7XG4gICAgICBpZiAoIXRoaXMubXFsIHx8ICF0aGlzLiRtZW51IHx8ICF0aGlzLiRtZW51QnV0dG9uKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLm1xbC5tYXRjaGVzKSB7XG4gICAgICAgIHRoaXMuJG1lbnUucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgdGhpcy4kbWVudUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuJG1lbnVCdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdoaWRkZW4nKTtcbiAgICAgICAgdGhpcy4kbWVudUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtZXhwYW5kZWQnLCB0aGlzLm1lbnVJc09wZW4udG9TdHJpbmcoKSk7XG4gICAgICAgIGlmICh0aGlzLm1lbnVJc09wZW4pIHtcbiAgICAgICAgICB0aGlzLiRtZW51LnJlbW92ZUF0dHJpYnV0ZSgnaGlkZGVuJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy4kbWVudS5zZXRBdHRyaWJ1dGUoJ2hpZGRlbicsICcnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBoYW5kbGVNZW51QnV0dG9uQ2xpY2soKSB7XG4gICAgICB0aGlzLm1lbnVJc09wZW4gPSAhdGhpcy5tZW51SXNPcGVuO1xuICAgICAgdGhpcy5jaGVja01vZGUoKTtcbiAgICB9XG4gIH1cbiAgU2VydmljZU5hdmlnYXRpb24ubW9kdWxlTmFtZSA9ICdnb3Z1ay1zZXJ2aWNlLW5hdmlnYXRpb24nO1xuXG4gIC8qKlxuICAgKiBTa2lwIGxpbmsgY29tcG9uZW50XG4gICAqXG4gICAqIEBwcmVzZXJ2ZVxuICAgKiBAYXVnbWVudHMgR09WVUtGcm9udGVuZENvbXBvbmVudDxIVE1MQW5jaG9yRWxlbWVudD5cbiAgICovXG4gIGNsYXNzIFNraXBMaW5rIGV4dGVuZHMgR09WVUtGcm9udGVuZENvbXBvbmVudCB7XG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtFbGVtZW50IHwgbnVsbH0gJHJvb3QgLSBIVE1MIGVsZW1lbnQgdG8gdXNlIGZvciBza2lwIGxpbmtcbiAgICAgKiBAdGhyb3dzIHtFbGVtZW50RXJyb3J9IHdoZW4gJHJvb3QgaXMgbm90IHNldCBvciB0aGUgd3JvbmcgdHlwZVxuICAgICAqIEB0aHJvd3Mge0VsZW1lbnRFcnJvcn0gd2hlbiAkcm9vdC5oYXNoIGRvZXMgbm90IGNvbnRhaW4gYSBoYXNoXG4gICAgICogQHRocm93cyB7RWxlbWVudEVycm9yfSB3aGVuIHRoZSBsaW5rZWQgZWxlbWVudCBpcyBtaXNzaW5nIG9yIHRoZSB3cm9uZyB0eXBlXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoJHJvb3QpIHtcbiAgICAgIHZhciBfdGhpcyQkcm9vdCRnZXRBdHRyaWI7XG4gICAgICBzdXBlcigkcm9vdCk7XG4gICAgICBjb25zdCBoYXNoID0gdGhpcy4kcm9vdC5oYXNoO1xuICAgICAgY29uc3QgaHJlZiA9IChfdGhpcyQkcm9vdCRnZXRBdHRyaWIgPSB0aGlzLiRyb290LmdldEF0dHJpYnV0ZSgnaHJlZicpKSAhPSBudWxsID8gX3RoaXMkJHJvb3QkZ2V0QXR0cmliIDogJyc7XG4gICAgICBsZXQgdXJsO1xuICAgICAgdHJ5IHtcbiAgICAgICAgdXJsID0gbmV3IHdpbmRvdy5VUkwodGhpcy4kcm9vdC5ocmVmKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3IoYFNraXAgbGluazogVGFyZ2V0IGxpbmsgKFxcYGhyZWY9XCIke2hyZWZ9XCJcXGApIGlzIGludmFsaWRgKTtcbiAgICAgIH1cbiAgICAgIGlmICh1cmwub3JpZ2luICE9PSB3aW5kb3cubG9jYXRpb24ub3JpZ2luIHx8IHVybC5wYXRobmFtZSAhPT0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxpbmtlZEVsZW1lbnRJZCA9IGdldEZyYWdtZW50RnJvbVVybChoYXNoKTtcbiAgICAgIGlmICghbGlua2VkRWxlbWVudElkKSB7XG4gICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3IoYFNraXAgbGluazogVGFyZ2V0IGxpbmsgKFxcYGhyZWY9XCIke2hyZWZ9XCJcXGApIGhhcyBubyBoYXNoIGZyYWdtZW50YCk7XG4gICAgICB9XG4gICAgICBjb25zdCAkbGlua2VkRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGxpbmtlZEVsZW1lbnRJZCk7XG4gICAgICBpZiAoISRsaW5rZWRFbGVtZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBFbGVtZW50RXJyb3Ioe1xuICAgICAgICAgIGNvbXBvbmVudDogU2tpcExpbmssXG4gICAgICAgICAgZWxlbWVudDogJGxpbmtlZEVsZW1lbnQsXG4gICAgICAgICAgaWRlbnRpZmllcjogYFRhcmdldCBjb250ZW50IChcXGBpZD1cIiR7bGlua2VkRWxlbWVudElkfVwiXFxgKWBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLiRyb290LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2V0Rm9jdXMoJGxpbmtlZEVsZW1lbnQsIHtcbiAgICAgICAgb25CZWZvcmVGb2N1cygpIHtcbiAgICAgICAgICAkbGlua2VkRWxlbWVudC5jbGFzc0xpc3QuYWRkKCdnb3Z1ay1za2lwLWxpbmstZm9jdXNlZC1lbGVtZW50Jyk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uQmx1cigpIHtcbiAgICAgICAgICAkbGlua2VkRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdnb3Z1ay1za2lwLWxpbmstZm9jdXNlZC1lbGVtZW50Jyk7XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICB9XG4gIH1cbiAgU2tpcExpbmsuZWxlbWVudFR5cGUgPSBIVE1MQW5jaG9yRWxlbWVudDtcbiAgU2tpcExpbmsubW9kdWxlTmFtZSA9ICdnb3Z1ay1za2lwLWxpbmsnO1xuXG4gIC8qKlxuICAgKiBUYWJzIGNvbXBvbmVudFxuICAgKlxuICAgKiBAcHJlc2VydmVcbiAgICovXG4gIGNsYXNzIFRhYnMgZXh0ZW5kcyBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge0VsZW1lbnQgfCBudWxsfSAkcm9vdCAtIEhUTUwgZWxlbWVudCB0byB1c2UgZm9yIHRhYnNcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3Rvcigkcm9vdCkge1xuICAgICAgc3VwZXIoJHJvb3QpO1xuICAgICAgdGhpcy4kdGFicyA9IHZvaWQgMDtcbiAgICAgIHRoaXMuJHRhYkxpc3QgPSB2b2lkIDA7XG4gICAgICB0aGlzLiR0YWJMaXN0SXRlbXMgPSB2b2lkIDA7XG4gICAgICB0aGlzLmpzSGlkZGVuQ2xhc3MgPSAnZ292dWstdGFic19fcGFuZWwtLWhpZGRlbic7XG4gICAgICB0aGlzLmNoYW5naW5nSGFzaCA9IGZhbHNlO1xuICAgICAgdGhpcy5ib3VuZFRhYkNsaWNrID0gdm9pZCAwO1xuICAgICAgdGhpcy5ib3VuZFRhYktleWRvd24gPSB2b2lkIDA7XG4gICAgICB0aGlzLmJvdW5kT25IYXNoQ2hhbmdlID0gdm9pZCAwO1xuICAgICAgdGhpcy5tcWwgPSBudWxsO1xuICAgICAgY29uc3QgJHRhYnMgPSB0aGlzLiRyb290LnF1ZXJ5U2VsZWN0b3JBbGwoJ2EuZ292dWstdGFic19fdGFiJyk7XG4gICAgICBpZiAoISR0YWJzLmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IFRhYnMsXG4gICAgICAgICAgaWRlbnRpZmllcjogJ0xpbmtzIChgPGEgY2xhc3M9XCJnb3Z1ay10YWJzX190YWJcIj5gKSdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLiR0YWJzID0gJHRhYnM7XG4gICAgICB0aGlzLmJvdW5kVGFiQ2xpY2sgPSB0aGlzLm9uVGFiQ2xpY2suYmluZCh0aGlzKTtcbiAgICAgIHRoaXMuYm91bmRUYWJLZXlkb3duID0gdGhpcy5vblRhYktleWRvd24uYmluZCh0aGlzKTtcbiAgICAgIHRoaXMuYm91bmRPbkhhc2hDaGFuZ2UgPSB0aGlzLm9uSGFzaENoYW5nZS5iaW5kKHRoaXMpO1xuICAgICAgY29uc3QgJHRhYkxpc3QgPSB0aGlzLiRyb290LnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay10YWJzX19saXN0Jyk7XG4gICAgICBjb25zdCAkdGFiTGlzdEl0ZW1zID0gdGhpcy4kcm9vdC5xdWVyeVNlbGVjdG9yQWxsKCdsaS5nb3Z1ay10YWJzX19saXN0LWl0ZW0nKTtcbiAgICAgIGlmICghJHRhYkxpc3QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBUYWJzLFxuICAgICAgICAgIGlkZW50aWZpZXI6ICdMaXN0IChgPHVsIGNsYXNzPVwiZ292dWstdGFic19fbGlzdFwiPmApJ1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmICghJHRhYkxpc3RJdGVtcy5sZW5ndGgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVsZW1lbnRFcnJvcih7XG4gICAgICAgICAgY29tcG9uZW50OiBUYWJzLFxuICAgICAgICAgIGlkZW50aWZpZXI6ICdMaXN0IGl0ZW1zIChgPGxpIGNsYXNzPVwiZ292dWstdGFic19fbGlzdC1pdGVtXCI+YCknXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgdGhpcy4kdGFiTGlzdCA9ICR0YWJMaXN0O1xuICAgICAgdGhpcy4kdGFiTGlzdEl0ZW1zID0gJHRhYkxpc3RJdGVtcztcbiAgICAgIHRoaXMuc2V0dXBSZXNwb25zaXZlQ2hlY2tzKCk7XG4gICAgfVxuICAgIHNldHVwUmVzcG9uc2l2ZUNoZWNrcygpIHtcbiAgICAgIGNvbnN0IGJyZWFrcG9pbnQgPSBnZXRCcmVha3BvaW50KCd0YWJsZXQnKTtcbiAgICAgIGlmICghYnJlYWtwb2ludC52YWx1ZSkge1xuICAgICAgICB0aHJvdyBuZXcgRWxlbWVudEVycm9yKHtcbiAgICAgICAgICBjb21wb25lbnQ6IFRhYnMsXG4gICAgICAgICAgaWRlbnRpZmllcjogYENTUyBjdXN0b20gcHJvcGVydHkgKFxcYCR7YnJlYWtwb2ludC5wcm9wZXJ0eX1cXGApIG9uIHBzZXVkby1jbGFzcyBcXGA6cm9vdFxcYGBcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0aGlzLm1xbCA9IHdpbmRvdy5tYXRjaE1lZGlhKGAobWluLXdpZHRoOiAke2JyZWFrcG9pbnQudmFsdWV9KWApO1xuICAgICAgaWYgKCdhZGRFdmVudExpc3RlbmVyJyBpbiB0aGlzLm1xbCkge1xuICAgICAgICB0aGlzLm1xbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB0aGlzLmNoZWNrTW9kZSgpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMubXFsLmFkZExpc3RlbmVyKCgpID0+IHRoaXMuY2hlY2tNb2RlKCkpO1xuICAgICAgfVxuICAgICAgdGhpcy5jaGVja01vZGUoKTtcbiAgICB9XG4gICAgY2hlY2tNb2RlKCkge1xuICAgICAgdmFyIF90aGlzJG1xbDtcbiAgICAgIGlmICgoX3RoaXMkbXFsID0gdGhpcy5tcWwpICE9IG51bGwgJiYgX3RoaXMkbXFsLm1hdGNoZXMpIHtcbiAgICAgICAgdGhpcy5zZXR1cCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy50ZWFyZG93bigpO1xuICAgICAgfVxuICAgIH1cbiAgICBzZXR1cCgpIHtcbiAgICAgIHZhciBfdGhpcyRnZXRUYWI7XG4gICAgICB0aGlzLiR0YWJMaXN0LnNldEF0dHJpYnV0ZSgncm9sZScsICd0YWJsaXN0Jyk7XG4gICAgICB0aGlzLiR0YWJMaXN0SXRlbXMuZm9yRWFjaCgkaXRlbSA9PiB7XG4gICAgICAgICRpdGVtLnNldEF0dHJpYnV0ZSgncm9sZScsICdwcmVzZW50YXRpb24nKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy4kdGFicy5mb3JFYWNoKCR0YWIgPT4ge1xuICAgICAgICB0aGlzLnNldEF0dHJpYnV0ZXMoJHRhYik7XG4gICAgICAgICR0YWIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmJvdW5kVGFiQ2xpY2ssIHRydWUpO1xuICAgICAgICAkdGFiLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLmJvdW5kVGFiS2V5ZG93biwgdHJ1ZSk7XG4gICAgICAgIHRoaXMuaGlkZVRhYigkdGFiKTtcbiAgICAgIH0pO1xuICAgICAgY29uc3QgJGFjdGl2ZVRhYiA9IChfdGhpcyRnZXRUYWIgPSB0aGlzLmdldFRhYih3aW5kb3cubG9jYXRpb24uaGFzaCkpICE9IG51bGwgPyBfdGhpcyRnZXRUYWIgOiB0aGlzLiR0YWJzWzBdO1xuICAgICAgdGhpcy5zaG93VGFiKCRhY3RpdmVUYWIpO1xuICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLmJvdW5kT25IYXNoQ2hhbmdlLCB0cnVlKTtcbiAgICB9XG4gICAgdGVhcmRvd24oKSB7XG4gICAgICB0aGlzLiR0YWJMaXN0LnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xuICAgICAgdGhpcy4kdGFiTGlzdEl0ZW1zLmZvckVhY2goJGl0ZW0gPT4ge1xuICAgICAgICAkaXRlbS5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy4kdGFicy5mb3JFYWNoKCR0YWIgPT4ge1xuICAgICAgICAkdGFiLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5ib3VuZFRhYkNsaWNrLCB0cnVlKTtcbiAgICAgICAgJHRhYi5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5ib3VuZFRhYktleWRvd24sIHRydWUpO1xuICAgICAgICB0aGlzLnVuc2V0QXR0cmlidXRlcygkdGFiKTtcbiAgICAgIH0pO1xuICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2hhc2hjaGFuZ2UnLCB0aGlzLmJvdW5kT25IYXNoQ2hhbmdlLCB0cnVlKTtcbiAgICB9XG4gICAgb25IYXNoQ2hhbmdlKCkge1xuICAgICAgY29uc3QgaGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoO1xuICAgICAgY29uc3QgJHRhYldpdGhIYXNoID0gdGhpcy5nZXRUYWIoaGFzaCk7XG4gICAgICBpZiAoISR0YWJXaXRoSGFzaCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5jaGFuZ2luZ0hhc2gpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2luZ0hhc2ggPSBmYWxzZTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgJHByZXZpb3VzVGFiID0gdGhpcy5nZXRDdXJyZW50VGFiKCk7XG4gICAgICBpZiAoISRwcmV2aW91c1RhYikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmhpZGVUYWIoJHByZXZpb3VzVGFiKTtcbiAgICAgIHRoaXMuc2hvd1RhYigkdGFiV2l0aEhhc2gpO1xuICAgICAgJHRhYldpdGhIYXNoLmZvY3VzKCk7XG4gICAgfVxuICAgIGhpZGVUYWIoJHRhYikge1xuICAgICAgdGhpcy51bmhpZ2hsaWdodFRhYigkdGFiKTtcbiAgICAgIHRoaXMuaGlkZVBhbmVsKCR0YWIpO1xuICAgIH1cbiAgICBzaG93VGFiKCR0YWIpIHtcbiAgICAgIHRoaXMuaGlnaGxpZ2h0VGFiKCR0YWIpO1xuICAgICAgdGhpcy5zaG93UGFuZWwoJHRhYik7XG4gICAgfVxuICAgIGdldFRhYihoYXNoKSB7XG4gICAgICByZXR1cm4gdGhpcy4kcm9vdC5xdWVyeVNlbGVjdG9yKGBhLmdvdnVrLXRhYnNfX3RhYltocmVmPVwiJHtoYXNofVwiXWApO1xuICAgIH1cbiAgICBzZXRBdHRyaWJ1dGVzKCR0YWIpIHtcbiAgICAgIGNvbnN0IHBhbmVsSWQgPSBnZXRGcmFnbWVudEZyb21VcmwoJHRhYi5ocmVmKTtcbiAgICAgIGlmICghcGFuZWxJZCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAkdGFiLnNldEF0dHJpYnV0ZSgnaWQnLCBgdGFiXyR7cGFuZWxJZH1gKTtcbiAgICAgICR0YWIuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3RhYicpO1xuICAgICAgJHRhYi5zZXRBdHRyaWJ1dGUoJ2FyaWEtY29udHJvbHMnLCBwYW5lbElkKTtcbiAgICAgICR0YWIuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gICAgICAkdGFiLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnLTEnKTtcbiAgICAgIGNvbnN0ICRwYW5lbCA9IHRoaXMuZ2V0UGFuZWwoJHRhYik7XG4gICAgICBpZiAoISRwYW5lbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAkcGFuZWwuc2V0QXR0cmlidXRlKCdyb2xlJywgJ3RhYnBhbmVsJyk7XG4gICAgICAkcGFuZWwuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsbGVkYnknLCAkdGFiLmlkKTtcbiAgICAgICRwYW5lbC5jbGFzc0xpc3QuYWRkKHRoaXMuanNIaWRkZW5DbGFzcyk7XG4gICAgfVxuICAgIHVuc2V0QXR0cmlidXRlcygkdGFiKSB7XG4gICAgICAkdGFiLnJlbW92ZUF0dHJpYnV0ZSgnaWQnKTtcbiAgICAgICR0YWIucmVtb3ZlQXR0cmlidXRlKCdyb2xlJyk7XG4gICAgICAkdGFiLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1jb250cm9scycpO1xuICAgICAgJHRhYi5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtc2VsZWN0ZWQnKTtcbiAgICAgICR0YWIucmVtb3ZlQXR0cmlidXRlKCd0YWJpbmRleCcpO1xuICAgICAgY29uc3QgJHBhbmVsID0gdGhpcy5nZXRQYW5lbCgkdGFiKTtcbiAgICAgIGlmICghJHBhbmVsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgICRwYW5lbC5yZW1vdmVBdHRyaWJ1dGUoJ3JvbGUnKTtcbiAgICAgICRwYW5lbC5yZW1vdmVBdHRyaWJ1dGUoJ2FyaWEtbGFiZWxsZWRieScpO1xuICAgICAgJHBhbmVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5qc0hpZGRlbkNsYXNzKTtcbiAgICB9XG4gICAgb25UYWJDbGljayhldmVudCkge1xuICAgICAgY29uc3QgJGN1cnJlbnRUYWIgPSB0aGlzLmdldEN1cnJlbnRUYWIoKTtcbiAgICAgIGNvbnN0ICRuZXh0VGFiID0gZXZlbnQuY3VycmVudFRhcmdldDtcbiAgICAgIGlmICghJGN1cnJlbnRUYWIgfHwgISgkbmV4dFRhYiBpbnN0YW5jZW9mIEhUTUxBbmNob3JFbGVtZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5oaWRlVGFiKCRjdXJyZW50VGFiKTtcbiAgICAgIHRoaXMuc2hvd1RhYigkbmV4dFRhYik7XG4gICAgICB0aGlzLmNyZWF0ZUhpc3RvcnlFbnRyeSgkbmV4dFRhYik7XG4gICAgfVxuICAgIGNyZWF0ZUhpc3RvcnlFbnRyeSgkdGFiKSB7XG4gICAgICBjb25zdCAkcGFuZWwgPSB0aGlzLmdldFBhbmVsKCR0YWIpO1xuICAgICAgaWYgKCEkcGFuZWwpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgcGFuZWxJZCA9ICRwYW5lbC5pZDtcbiAgICAgICRwYW5lbC5pZCA9ICcnO1xuICAgICAgdGhpcy5jaGFuZ2luZ0hhc2ggPSB0cnVlO1xuICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBwYW5lbElkO1xuICAgICAgJHBhbmVsLmlkID0gcGFuZWxJZDtcbiAgICB9XG4gICAgb25UYWJLZXlkb3duKGV2ZW50KSB7XG4gICAgICBzd2l0Y2ggKGV2ZW50LmtleSkge1xuICAgICAgICBjYXNlICdBcnJvd0xlZnQnOlxuICAgICAgICBjYXNlICdMZWZ0JzpcbiAgICAgICAgICB0aGlzLmFjdGl2YXRlUHJldmlvdXNUYWIoKTtcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdBcnJvd1JpZ2h0JzpcbiAgICAgICAgY2FzZSAnUmlnaHQnOlxuICAgICAgICAgIHRoaXMuYWN0aXZhdGVOZXh0VGFiKCk7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gICAgYWN0aXZhdGVOZXh0VGFiKCkge1xuICAgICAgY29uc3QgJGN1cnJlbnRUYWIgPSB0aGlzLmdldEN1cnJlbnRUYWIoKTtcbiAgICAgIGlmICghKCRjdXJyZW50VGFiICE9IG51bGwgJiYgJGN1cnJlbnRUYWIucGFyZW50RWxlbWVudCkpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgJG5leHRUYWJMaXN0SXRlbSA9ICRjdXJyZW50VGFiLnBhcmVudEVsZW1lbnQubmV4dEVsZW1lbnRTaWJsaW5nO1xuICAgICAgaWYgKCEkbmV4dFRhYkxpc3RJdGVtKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0ICRuZXh0VGFiID0gJG5leHRUYWJMaXN0SXRlbS5xdWVyeVNlbGVjdG9yKCdhLmdvdnVrLXRhYnNfX3RhYicpO1xuICAgICAgaWYgKCEkbmV4dFRhYikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLmhpZGVUYWIoJGN1cnJlbnRUYWIpO1xuICAgICAgdGhpcy5zaG93VGFiKCRuZXh0VGFiKTtcbiAgICAgICRuZXh0VGFiLmZvY3VzKCk7XG4gICAgICB0aGlzLmNyZWF0ZUhpc3RvcnlFbnRyeSgkbmV4dFRhYik7XG4gICAgfVxuICAgIGFjdGl2YXRlUHJldmlvdXNUYWIoKSB7XG4gICAgICBjb25zdCAkY3VycmVudFRhYiA9IHRoaXMuZ2V0Q3VycmVudFRhYigpO1xuICAgICAgaWYgKCEoJGN1cnJlbnRUYWIgIT0gbnVsbCAmJiAkY3VycmVudFRhYi5wYXJlbnRFbGVtZW50KSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCAkcHJldmlvdXNUYWJMaXN0SXRlbSA9ICRjdXJyZW50VGFiLnBhcmVudEVsZW1lbnQucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICAgIGlmICghJHByZXZpb3VzVGFiTGlzdEl0ZW0pIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgY29uc3QgJHByZXZpb3VzVGFiID0gJHByZXZpb3VzVGFiTGlzdEl0ZW0ucXVlcnlTZWxlY3RvcignYS5nb3Z1ay10YWJzX190YWInKTtcbiAgICAgIGlmICghJHByZXZpb3VzVGFiKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIHRoaXMuaGlkZVRhYigkY3VycmVudFRhYik7XG4gICAgICB0aGlzLnNob3dUYWIoJHByZXZpb3VzVGFiKTtcbiAgICAgICRwcmV2aW91c1RhYi5mb2N1cygpO1xuICAgICAgdGhpcy5jcmVhdGVIaXN0b3J5RW50cnkoJHByZXZpb3VzVGFiKTtcbiAgICB9XG4gICAgZ2V0UGFuZWwoJHRhYikge1xuICAgICAgY29uc3QgcGFuZWxJZCA9IGdldEZyYWdtZW50RnJvbVVybCgkdGFiLmhyZWYpO1xuICAgICAgaWYgKCFwYW5lbElkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXMuJHJvb3QucXVlcnlTZWxlY3RvcihgIyR7cGFuZWxJZH1gKTtcbiAgICB9XG4gICAgc2hvd1BhbmVsKCR0YWIpIHtcbiAgICAgIGNvbnN0ICRwYW5lbCA9IHRoaXMuZ2V0UGFuZWwoJHRhYik7XG4gICAgICBpZiAoISRwYW5lbCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAkcGFuZWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLmpzSGlkZGVuQ2xhc3MpO1xuICAgIH1cbiAgICBoaWRlUGFuZWwoJHRhYikge1xuICAgICAgY29uc3QgJHBhbmVsID0gdGhpcy5nZXRQYW5lbCgkdGFiKTtcbiAgICAgIGlmICghJHBhbmVsKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgICRwYW5lbC5jbGFzc0xpc3QuYWRkKHRoaXMuanNIaWRkZW5DbGFzcyk7XG4gICAgfVxuICAgIHVuaGlnaGxpZ2h0VGFiKCR0YWIpIHtcbiAgICAgIGlmICghJHRhYi5wYXJlbnRFbGVtZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgICR0YWIuc2V0QXR0cmlidXRlKCdhcmlhLXNlbGVjdGVkJywgJ2ZhbHNlJyk7XG4gICAgICAkdGFiLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSgnZ292dWstdGFic19fbGlzdC1pdGVtLS1zZWxlY3RlZCcpO1xuICAgICAgJHRhYi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJy0xJyk7XG4gICAgfVxuICAgIGhpZ2hsaWdodFRhYigkdGFiKSB7XG4gICAgICBpZiAoISR0YWIucGFyZW50RWxlbWVudCkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAkdGFiLnNldEF0dHJpYnV0ZSgnYXJpYS1zZWxlY3RlZCcsICd0cnVlJyk7XG4gICAgICAkdGFiLnBhcmVudEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgnZ292dWstdGFic19fbGlzdC1pdGVtLS1zZWxlY3RlZCcpO1xuICAgICAgJHRhYi5zZXRBdHRyaWJ1dGUoJ3RhYmluZGV4JywgJzAnKTtcbiAgICB9XG4gICAgZ2V0Q3VycmVudFRhYigpIHtcbiAgICAgIHJldHVybiB0aGlzLiRyb290LnF1ZXJ5U2VsZWN0b3IoJy5nb3Z1ay10YWJzX19saXN0LWl0ZW0tLXNlbGVjdGVkIGEuZ292dWstdGFic19fdGFiJyk7XG4gICAgfVxuICB9XG4gIFRhYnMubW9kdWxlTmFtZSA9ICdnb3Z1ay10YWJzJztcblxuICAvKipcbiAgICogSW5pdGlhbGlzZSBhbGwgY29tcG9uZW50c1xuICAgKlxuICAgKiBVc2UgdGhlIGBkYXRhLW1vZHVsZWAgYXR0cmlidXRlcyB0byBmaW5kLCBpbnN0YW50aWF0ZSBhbmQgaW5pdCBhbGwgb2YgdGhlXG4gICAqIGNvbXBvbmVudHMgcHJvdmlkZWQgYXMgcGFydCBvZiBHT1YuVUsgRnJvbnRlbmQuXG4gICAqXG4gICAqIEBwYXJhbSB7Q29uZmlnICYgeyBzY29wZT86IEVsZW1lbnQsIG9uRXJyb3I/OiBPbkVycm9yQ2FsbGJhY2s8Q29tcGF0aWJsZUNsYXNzPiB9fSBbY29uZmlnXSAtIENvbmZpZyBmb3IgYWxsIGNvbXBvbmVudHMgKHdpdGggb3B0aW9uYWwgc2NvcGUpXG4gICAqL1xuICBmdW5jdGlvbiBpbml0QWxsKGNvbmZpZykge1xuICAgIHZhciBfY29uZmlnJHNjb3BlO1xuICAgIGNvbmZpZyA9IHR5cGVvZiBjb25maWcgIT09ICd1bmRlZmluZWQnID8gY29uZmlnIDoge307XG4gICAgaWYgKCFpc1N1cHBvcnRlZCgpKSB7XG4gICAgICBpZiAoY29uZmlnLm9uRXJyb3IpIHtcbiAgICAgICAgY29uZmlnLm9uRXJyb3IobmV3IFN1cHBvcnRFcnJvcigpLCB7XG4gICAgICAgICAgY29uZmlnXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2cobmV3IFN1cHBvcnRFcnJvcigpKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY29tcG9uZW50cyA9IFtbQWNjb3JkaW9uLCBjb25maWcuYWNjb3JkaW9uXSwgW0J1dHRvbiwgY29uZmlnLmJ1dHRvbl0sIFtDaGFyYWN0ZXJDb3VudCwgY29uZmlnLmNoYXJhY3RlckNvdW50XSwgW0NoZWNrYm94ZXNdLCBbRXJyb3JTdW1tYXJ5LCBjb25maWcuZXJyb3JTdW1tYXJ5XSwgW0V4aXRUaGlzUGFnZSwgY29uZmlnLmV4aXRUaGlzUGFnZV0sIFtIZWFkZXJdLCBbTm90aWZpY2F0aW9uQmFubmVyLCBjb25maWcubm90aWZpY2F0aW9uQmFubmVyXSwgW1Bhc3N3b3JkSW5wdXQsIGNvbmZpZy5wYXNzd29yZElucHV0XSwgW1JhZGlvc10sIFtTZXJ2aWNlTmF2aWdhdGlvbl0sIFtTa2lwTGlua10sIFtUYWJzXV07XG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIHNjb3BlOiAoX2NvbmZpZyRzY29wZSA9IGNvbmZpZy5zY29wZSkgIT0gbnVsbCA/IF9jb25maWckc2NvcGUgOiBkb2N1bWVudCxcbiAgICAgIG9uRXJyb3I6IGNvbmZpZy5vbkVycm9yXG4gICAgfTtcbiAgICBjb21wb25lbnRzLmZvckVhY2goKFtDb21wb25lbnQsIGNvbmZpZ10pID0+IHtcbiAgICAgIGNyZWF0ZUFsbChDb21wb25lbnQsIGNvbmZpZywgb3B0aW9ucyk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlIGFsbCBpbnN0YW5jZXMgb2YgYSBzcGVjaWZpYyBjb21wb25lbnQgb24gdGhlIHBhZ2VcbiAgICpcbiAgICogVXNlcyB0aGUgYGRhdGEtbW9kdWxlYCBhdHRyaWJ1dGUgdG8gZmluZCBhbGwgZWxlbWVudHMgbWF0Y2hpbmcgdGhlIHNwZWNpZmllZFxuICAgKiBjb21wb25lbnQgb24gdGhlIHBhZ2UsIGNyZWF0aW5nIGluc3RhbmNlcyBvZiB0aGUgY29tcG9uZW50IG9iamVjdCBmb3IgZWFjaFxuICAgKiBvZiB0aGVtLlxuICAgKlxuICAgKiBBbnkgY29tcG9uZW50IGVycm9ycyB3aWxsIGJlIGNhdWdodCBhbmQgbG9nZ2VkIHRvIHRoZSBjb25zb2xlLlxuICAgKlxuICAgKiBAdGVtcGxhdGUge0NvbXBhdGlibGVDbGFzc30gVFxuICAgKiBAcGFyYW0ge1R9IENvbXBvbmVudCAtIGNsYXNzIG9mIHRoZSBjb21wb25lbnQgdG8gY3JlYXRlXG4gICAqIEBwYXJhbSB7VFtcImRlZmF1bHRzXCJdfSBbY29uZmlnXSAtIENvbmZpZyBzdXBwbGllZCB0byBjb21wb25lbnRcbiAgICogQHBhcmFtIHtPbkVycm9yQ2FsbGJhY2s8VD4gfCBFbGVtZW50IHwgRG9jdW1lbnQgfCBDcmVhdGVBbGxPcHRpb25zPFQ+IH0gW2NyZWF0ZUFsbE9wdGlvbnNdIC0gb3B0aW9ucyBmb3IgY3JlYXRlQWxsIGluY2x1ZGluZyBzY29wZSBvZiB0aGUgZG9jdW1lbnQgdG8gc2VhcmNoIHdpdGhpbiBhbmQgY2FsbGJhY2sgZnVuY3Rpb24gaWYgZXJyb3IgdGhyb3cgYnkgY29tcG9uZW50IG9uIGluaXRcbiAgICogQHJldHVybnMge0FycmF5PEluc3RhbmNlVHlwZTxUPj59IC0gYXJyYXkgb2YgaW5zdGFudGlhdGVkIGNvbXBvbmVudHNcbiAgICovXG4gIGZ1bmN0aW9uIGNyZWF0ZUFsbChDb21wb25lbnQsIGNvbmZpZywgY3JlYXRlQWxsT3B0aW9ucykge1xuICAgIGxldCAkc2NvcGUgPSBkb2N1bWVudDtcbiAgICBsZXQgb25FcnJvcjtcbiAgICBpZiAodHlwZW9mIGNyZWF0ZUFsbE9wdGlvbnMgPT09ICdvYmplY3QnKSB7XG4gICAgICB2YXIgX2NyZWF0ZUFsbE9wdGlvbnMkc2NvO1xuICAgICAgY3JlYXRlQWxsT3B0aW9ucyA9IGNyZWF0ZUFsbE9wdGlvbnM7XG4gICAgICAkc2NvcGUgPSAoX2NyZWF0ZUFsbE9wdGlvbnMkc2NvID0gY3JlYXRlQWxsT3B0aW9ucy5zY29wZSkgIT0gbnVsbCA/IF9jcmVhdGVBbGxPcHRpb25zJHNjbyA6ICRzY29wZTtcbiAgICAgIG9uRXJyb3IgPSBjcmVhdGVBbGxPcHRpb25zLm9uRXJyb3I7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgY3JlYXRlQWxsT3B0aW9ucyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgb25FcnJvciA9IGNyZWF0ZUFsbE9wdGlvbnM7XG4gICAgfVxuICAgIGlmIChjcmVhdGVBbGxPcHRpb25zIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcbiAgICAgICRzY29wZSA9IGNyZWF0ZUFsbE9wdGlvbnM7XG4gICAgfVxuICAgIGNvbnN0ICRlbGVtZW50cyA9ICRzY29wZS5xdWVyeVNlbGVjdG9yQWxsKGBbZGF0YS1tb2R1bGU9XCIke0NvbXBvbmVudC5tb2R1bGVOYW1lfVwiXWApO1xuICAgIGlmICghaXNTdXBwb3J0ZWQoKSkge1xuICAgICAgaWYgKG9uRXJyb3IpIHtcbiAgICAgICAgb25FcnJvcihuZXcgU3VwcG9ydEVycm9yKCksIHtcbiAgICAgICAgICBjb21wb25lbnQ6IENvbXBvbmVudCxcbiAgICAgICAgICBjb25maWdcbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zb2xlLmxvZyhuZXcgU3VwcG9ydEVycm9yKCkpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICByZXR1cm4gQXJyYXkuZnJvbSgkZWxlbWVudHMpLm1hcCgkZWxlbWVudCA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGNvbmZpZyAhPT0gJ3VuZGVmaW5lZCcgPyBuZXcgQ29tcG9uZW50KCRlbGVtZW50LCBjb25maWcpIDogbmV3IENvbXBvbmVudCgkZWxlbWVudCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBpZiAob25FcnJvcikge1xuICAgICAgICAgIG9uRXJyb3IoZXJyb3IsIHtcbiAgICAgICAgICAgIGVsZW1lbnQ6ICRlbGVtZW50LFxuICAgICAgICAgICAgY29tcG9uZW50OiBDb21wb25lbnQsXG4gICAgICAgICAgICBjb25maWdcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfSkuZmlsdGVyKEJvb2xlYW4pO1xuICB9XG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7e25ldyAoLi4uYXJnczogYW55W10pOiBhbnksIGRlZmF1bHRzPzogb2JqZWN0LCBtb2R1bGVOYW1lOiBzdHJpbmd9fSBDb21wYXRpYmxlQ2xhc3NcbiAgICovXG4gIC8qKlxuICAgKiBDb25maWcgZm9yIGFsbCBjb21wb25lbnRzIHZpYSBgaW5pdEFsbCgpYFxuICAgKlxuICAgKiBAdHlwZWRlZiB7b2JqZWN0fSBDb25maWdcbiAgICogQHByb3BlcnR5IHtBY2NvcmRpb25Db25maWd9IFthY2NvcmRpb25dIC0gQWNjb3JkaW9uIGNvbmZpZ1xuICAgKiBAcHJvcGVydHkge0J1dHRvbkNvbmZpZ30gW2J1dHRvbl0gLSBCdXR0b24gY29uZmlnXG4gICAqIEBwcm9wZXJ0eSB7Q2hhcmFjdGVyQ291bnRDb25maWd9IFtjaGFyYWN0ZXJDb3VudF0gLSBDaGFyYWN0ZXIgQ291bnQgY29uZmlnXG4gICAqIEBwcm9wZXJ0eSB7RXJyb3JTdW1tYXJ5Q29uZmlnfSBbZXJyb3JTdW1tYXJ5XSAtIEVycm9yIFN1bW1hcnkgY29uZmlnXG4gICAqIEBwcm9wZXJ0eSB7RXhpdFRoaXNQYWdlQ29uZmlnfSBbZXhpdFRoaXNQYWdlXSAtIEV4aXQgVGhpcyBQYWdlIGNvbmZpZ1xuICAgKiBAcHJvcGVydHkge05vdGlmaWNhdGlvbkJhbm5lckNvbmZpZ30gW25vdGlmaWNhdGlvbkJhbm5lcl0gLSBOb3RpZmljYXRpb24gQmFubmVyIGNvbmZpZ1xuICAgKiBAcHJvcGVydHkge1Bhc3N3b3JkSW5wdXRDb25maWd9IFtwYXNzd29yZElucHV0XSAtIFBhc3N3b3JkIGlucHV0IGNvbmZpZ1xuICAgKi9cbiAgLyoqXG4gICAqIENvbmZpZyBmb3IgaW5kaXZpZHVhbCBjb21wb25lbnRzXG4gICAqXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4vY29tcG9uZW50cy9hY2NvcmRpb24vYWNjb3JkaW9uLm1qcycpLkFjY29yZGlvbkNvbmZpZ30gQWNjb3JkaW9uQ29uZmlnXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4vY29tcG9uZW50cy9hY2NvcmRpb24vYWNjb3JkaW9uLm1qcycpLkFjY29yZGlvblRyYW5zbGF0aW9uc30gQWNjb3JkaW9uVHJhbnNsYXRpb25zXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4vY29tcG9uZW50cy9idXR0b24vYnV0dG9uLm1qcycpLkJ1dHRvbkNvbmZpZ30gQnV0dG9uQ29uZmlnXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4vY29tcG9uZW50cy9jaGFyYWN0ZXItY291bnQvY2hhcmFjdGVyLWNvdW50Lm1qcycpLkNoYXJhY3RlckNvdW50Q29uZmlnfSBDaGFyYWN0ZXJDb3VudENvbmZpZ1xuICAgKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2NvbXBvbmVudHMvY2hhcmFjdGVyLWNvdW50L2NoYXJhY3Rlci1jb3VudC5tanMnKS5DaGFyYWN0ZXJDb3VudFRyYW5zbGF0aW9uc30gQ2hhcmFjdGVyQ291bnRUcmFuc2xhdGlvbnNcbiAgICogQHR5cGVkZWYge2ltcG9ydCgnLi9jb21wb25lbnRzL2Vycm9yLXN1bW1hcnkvZXJyb3Itc3VtbWFyeS5tanMnKS5FcnJvclN1bW1hcnlDb25maWd9IEVycm9yU3VtbWFyeUNvbmZpZ1xuICAgKiBAdHlwZWRlZiB7aW1wb3J0KCcuL2NvbXBvbmVudHMvZXhpdC10aGlzLXBhZ2UvZXhpdC10aGlzLXBhZ2UubWpzJykuRXhpdFRoaXNQYWdlQ29uZmlnfSBFeGl0VGhpc1BhZ2VDb25maWdcbiAgICogQHR5cGVkZWYge2ltcG9ydCgnLi9jb21wb25lbnRzL2V4aXQtdGhpcy1wYWdlL2V4aXQtdGhpcy1wYWdlLm1qcycpLkV4aXRUaGlzUGFnZVRyYW5zbGF0aW9uc30gRXhpdFRoaXNQYWdlVHJhbnNsYXRpb25zXG4gICAqIEB0eXBlZGVmIHtpbXBvcnQoJy4vY29tcG9uZW50cy9ub3RpZmljYXRpb24tYmFubmVyL25vdGlmaWNhdGlvbi1iYW5uZXIubWpzJykuTm90aWZpY2F0aW9uQmFubmVyQ29uZmlnfSBOb3RpZmljYXRpb25CYW5uZXJDb25maWdcbiAgICogQHR5cGVkZWYge2ltcG9ydCgnLi9jb21wb25lbnRzL3Bhc3N3b3JkLWlucHV0L3Bhc3N3b3JkLWlucHV0Lm1qcycpLlBhc3N3b3JkSW5wdXRDb25maWd9IFBhc3N3b3JkSW5wdXRDb25maWdcbiAgICovXG4gIC8qKlxuICAgKiBDb21wb25lbnQgY29uZmlnIGtleXMsIGUuZy4gYGFjY29yZGlvbmAgYW5kIGBjaGFyYWN0ZXJDb3VudGBcbiAgICpcbiAgICogQHR5cGVkZWYge2tleW9mIENvbmZpZ30gQ29uZmlnS2V5XG4gICAqL1xuICAvKipcbiAgICogQHRlbXBsYXRlIHtDb21wYXRpYmxlQ2xhc3N9IFRcbiAgICogQHR5cGVkZWYge29iamVjdH0gRXJyb3JDb250ZXh0XG4gICAqIEBwcm9wZXJ0eSB7RWxlbWVudH0gW2VsZW1lbnRdIC0gRWxlbWVudCB1c2VkIGZvciBjb21wb25lbnQgbW9kdWxlIGluaXRpYWxpc2F0aW9uXG4gICAqIEBwcm9wZXJ0eSB7VH0gW2NvbXBvbmVudF0gLSBDbGFzcyBvZiBjb21wb25lbnRcbiAgICogQHByb3BlcnR5IHtUW1wiZGVmYXVsdHNcIl19IGNvbmZpZyAtIENvbmZpZyBzdXBwbGllZCB0byBjb21wb25lbnRcbiAgICovXG4gIC8qKlxuICAgKiBAdGVtcGxhdGUge0NvbXBhdGlibGVDbGFzc30gVFxuICAgKiBAY2FsbGJhY2sgT25FcnJvckNhbGxiYWNrXG4gICAqIEBwYXJhbSB7dW5rbm93bn0gZXJyb3IgLSBUaHJvd24gZXJyb3JcbiAgICogQHBhcmFtIHtFcnJvckNvbnRleHQ8VD59IGNvbnRleHQgLSBPYmplY3QgY29udGFpbmluZyB0aGUgZWxlbWVudCwgY29tcG9uZW50IGNsYXNzIGFuZCBjb25maWd1cmF0aW9uXG4gICAqL1xuICAvKipcbiAgICogQHRlbXBsYXRlIHtDb21wYXRpYmxlQ2xhc3N9IFRcbiAgICogQHR5cGVkZWYge29iamVjdH0gQ3JlYXRlQWxsT3B0aW9uc1xuICAgKiBAcHJvcGVydHkge0VsZW1lbnQgfCBEb2N1bWVudH0gW3Njb3BlXSAtIHNjb3BlIG9mIHRoZSBkb2N1bWVudCB0byBzZWFyY2ggd2l0aGluXG4gICAqIEBwcm9wZXJ0eSB7T25FcnJvckNhbGxiYWNrPFQ+fSBbb25FcnJvcl0gLSBjYWxsYmFjayBmdW5jdGlvbiBpZiBlcnJvciB0aHJvdyBieSBjb21wb25lbnQgb24gaW5pdFxuICAgKi9cblxuICBleHBvcnRzLkFjY29yZGlvbiA9IEFjY29yZGlvbjtcbiAgZXhwb3J0cy5CdXR0b24gPSBCdXR0b247XG4gIGV4cG9ydHMuQ2hhcmFjdGVyQ291bnQgPSBDaGFyYWN0ZXJDb3VudDtcbiAgZXhwb3J0cy5DaGVja2JveGVzID0gQ2hlY2tib3hlcztcbiAgZXhwb3J0cy5Db21wb25lbnQgPSBHT1ZVS0Zyb250ZW5kQ29tcG9uZW50O1xuICBleHBvcnRzLkVycm9yU3VtbWFyeSA9IEVycm9yU3VtbWFyeTtcbiAgZXhwb3J0cy5FeGl0VGhpc1BhZ2UgPSBFeGl0VGhpc1BhZ2U7XG4gIGV4cG9ydHMuSGVhZGVyID0gSGVhZGVyO1xuICBleHBvcnRzLk5vdGlmaWNhdGlvbkJhbm5lciA9IE5vdGlmaWNhdGlvbkJhbm5lcjtcbiAgZXhwb3J0cy5QYXNzd29yZElucHV0ID0gUGFzc3dvcmRJbnB1dDtcbiAgZXhwb3J0cy5SYWRpb3MgPSBSYWRpb3M7XG4gIGV4cG9ydHMuU2VydmljZU5hdmlnYXRpb24gPSBTZXJ2aWNlTmF2aWdhdGlvbjtcbiAgZXhwb3J0cy5Ta2lwTGluayA9IFNraXBMaW5rO1xuICBleHBvcnRzLlRhYnMgPSBUYWJzO1xuICBleHBvcnRzLmNyZWF0ZUFsbCA9IGNyZWF0ZUFsbDtcbiAgZXhwb3J0cy5pbml0QWxsID0gaW5pdEFsbDtcbiAgZXhwb3J0cy5pc1N1cHBvcnRlZCA9IGlzU3VwcG9ydGVkO1xuICBleHBvcnRzLnZlcnNpb24gPSB2ZXJzaW9uO1xuXG59KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hbGwuYnVuZGxlLmpzLm1hcFxuIl19
